
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>How costly is rejection sampling? · Arcane Algorithm Archive</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.1">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../probability_distributions/distributions.html" />
    
    
    <link rel="prev" href="box_muller.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/introduction.html">
            
                <a href="../introduction/introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how_to_contribute/how_to_contribute.html">
            
                <a href="../how_to_contribute/how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../code_reviews/code_reviewers.html">
            
                <a href="../code_reviews/code_reviewers.html">
            
                    
                    Code Reviewers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../plotting/plotting.html">
            
                <a href="../plotting/plotting.html">
            
                    
                    Plotting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../domain_coloring/domain_coloring.html">
            
                <a href="../domain_coloring/domain_coloring.html">
            
                    
                    Domain Coloring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../IFS/IFS.html">
            
                <a href="../IFS/IFS.html">
            
                    
                    Iterated Function Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../barnsley/barnsley.html">
            
                <a href="../barnsley/barnsley.html">
            
                    
                    The Barnsley Fern
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../data_structures/data_structures.html">
            
                <a href="../data_structures/data_structures.html">
            
                    
                    Data Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../stacks_and_queues/stacks_and_queues.html">
            
                <a href="../stacks_and_queues/stacks_and_queues.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../mathematical_background/mathematical_background.html">
            
                <a href="../mathematical_background/mathematical_background.html">
            
                    
                    Mathematical Background
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../notation/notation.html">
            
                <a href="../notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../affine_transformations/affine_transformations.html">
            
                <a href="../affine_transformations/affine_transformations.html">
            
                    
                    Affine Transformations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../bitlogic/bitlogic.html">
            
                <a href="../bitlogic/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../taylor_series_expansion/taylor_series_expansion.html">
            
                <a href="../taylor_series_expansion/taylor_series_expansion.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../convolutions/convolutions.html">
            
                <a href="../convolutions/convolutions.html">
            
                    
                    Convolutions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.5.1" data-path="../convolutions/1d/1d.html">
            
                <a href="../convolutions/1d/1d.html">
            
                    
                    Convolutions in 1D
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.2" data-path="../convolutions/multiplication/multiplication.html">
            
                <a href="../convolutions/multiplication/multiplication.html">
            
                    
                    Multiplication as a Convolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.3" data-path="../convolutions/2d/2d.html">
            
                <a href="../convolutions/2d/2d.html">
            
                    
                    Convolutions of Images (2D)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.4" data-path="../convolutions/convolutional_theorem/convolutional_theorem.html">
            
                <a href="../convolutions/convolutional_theorem/convolutional_theorem.html">
            
                    
                    Convolutional Theorem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="box_muller.html">
            
                <a href="box_muller.html">
            
                    
                    Box Muller Transform
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.6.6.1" data-path="box_muller_rejection.html">
            
                <a href="box_muller_rejection.html">
            
                    
                    How costly is rejection sampling?
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../probability_distributions/distributions.html">
            
                <a href="../probability_distributions/distributions.html">
            
                    
                    Probability Distributions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../tree_traversal/tree_traversal.html">
            
                <a href="../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../euclidean_algorithm/euclidean_algorithm.html">
            
                <a href="../euclidean_algorithm/euclidean_algorithm.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../monte_carlo_integration/monte_carlo_integration.html">
            
                <a href="../monte_carlo_integration/monte_carlo_integration.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../metropolis/metropolis.html">
            
                <a href="../metropolis/metropolis.html">
            
                    
                    Metropolis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../matrix_methods/matrix_methods.html">
            
                <a href="../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../gaussian_elimination/gaussian_elimination.html">
            
                <a href="../gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../thomas_algorithm/thomas_algorithm.html">
            
                <a href="../thomas_algorithm/thomas_algorithm.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../computational_geometry/computational_geometry.html">
            
                <a href="../computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../gift_wrapping/gift_wrapping.html">
            
                <a href="../gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="../jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="../graham_scan/graham_scan.html">
            
                <a href="../graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../cooley_tukey/cooley_tukey.html">
            
                <a href="../cooley_tukey/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../decision_problems/decision_problems.html">
            
                <a href="../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../stable_marriage_problem/stable_marriage_problem.html">
            
                <a href="../stable_marriage_problem/stable_marriage_problem.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../physics_solvers/physics_solvers.html">
            
                <a href="../physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../verlet_integration/verlet_integration.html">
            
                <a href="../verlet_integration/verlet_integration.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../quantum_systems/quantum_systems.html">
            
                <a href="../quantum_systems/quantum_systems.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.2.1" data-path="../split-operator_method/split-operator_method.html">
            
                <a href="../split-operator_method/split-operator_method.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../data_compression/data_compression.html">
            
                <a href="../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../huffman_encoding/huffman_encoding.html">
            
                <a href="../huffman_encoding/huffman_encoding.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../computer_graphics/computer_graphics.html">
            
                <a href="../computer_graphics/computer_graphics.html">
            
                    
                    Computer Graphics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../flood_fill/flood_fill.html">
            
                <a href="../flood_fill/flood_fill.html">
            
                    
                    Flood Fill
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../quantum_information/quantum_information.html">
            
                <a href="../quantum_information/quantum_information.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../cryptography/cryptography.html">
            
                <a href="../cryptography/cryptography.html">
            
                    
                    Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../computus/computus.html">
            
                <a href="../computus/computus.html">
            
                    
                    Computus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../approximate_counting/approximate_counting.html">
            
                <a href="../approximate_counting/approximate_counting.html">
            
                    
                    Approximate Counting Algorithm
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >How costly is rejection sampling?</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="just-how-costly-is-rejection-sampling-anyway">Just how costly is rejection sampling anyway?</h1>
<p>Let&apos;s imagine we want to have a final Gaussian distribution with <script type="math/tex; ">n</script> particles in it.
With the Cartesian Box—Muller method, this is easy: start the initial distribution(s) with <script type="math/tex; ">n</script> particles and then do the transform.
Things <em>can</em> be just as easy with the Polar Box—Muller method as well, so long as we start with a uniformly distributed <em>circle</em> instead of a uniformly distributed <em>square</em>.
That is to say, so long as we do the rejection sampling before-hand, the Polar Box—Muller method will always be more efficient.
To be fair, there are methods to generate a uniform distribution of points within a circle without rejection sampling, but let&apos;s assume that we require rejection sampling for this example</p>
<p>This means that someone somehow needs to do the rejection sampling for the Polar method, which is sometimes a painful process.
This also means that the Box—Muller method can be used to teach some of the fundamentals of General-Purpose GPU computing.
Note that because of the specificity of this problem, all the code in this subsection will be in Julia and using the package KernelAbstractions.jl, which allows us to execute the same kernels on either CPU or GPU hardware depending on how we configure things.</p>
<p>Let&apos;s first consider the case where we do the rejection sampling as a part of the polar Box—Muller kernel instead of as a pre-processing step.
In this case, we can imagine 2 separate ways of writing our kernel:</p>
<ol>
<li>With replacement: In this case, we <em>absolutely require</em> the final number of points in our Gaussian distribution to be <script type="math/tex; ">n</script>, so if we find a point outside of the unit circle while running the kernel, we will &quot;re-roll&quot; again for a new point that <em>is</em> within the circle.</li>
<li>Without replacement: This means that we will start with a uniform distribution of <script type="math/tex; ">n</script> points, but end with a Gaussian of <script type="math/tex; ">m < n</script> points. In this case, if we find a point outside of the unit circle while running the kernel, we just ignore it by setting the output values to NaNs (or something similar).</li>
</ol>
<p>OK, so first with replacement:</p>
<pre class="language-"><code class="lang-julia">@kernel <span class="token keyword">function</span> polar_muller_replacement<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">)</span>
    tid <span class="token operator">=</span> @index<span class="token punctuation">(</span>Global<span class="token punctuation">,</span> Linear<span class="token punctuation">)</span>
    @inbounds r_0 <span class="token operator">=</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span>

    <span class="token keyword">while</span> r_0 <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">||</span> r_0 <span class="token operator">==</span> <span class="token number">0</span>
        p1 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span>
        p2 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span>
        r_0 <span class="token operator">=</span> p1<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> p2<span class="token operator">^</span><span class="token number">2</span>
    <span class="token keyword">end</span>

    @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span>
                                  sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>r_0<span class="token punctuation">)</span> <span class="token operator">/</span> r_0<span class="token punctuation">)</span> <span class="token operator">+</span> mu
    @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span>
                                  sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>r_0<span class="token punctuation">)</span> <span class="token operator">/</span> r_0<span class="token punctuation">)</span> <span class="token operator">+</span> mu
<span class="token keyword">end</span>
</code></pre>
<p>This is an awful idea for a number of reasons.
Here are a few:</p>
<ol>
<li>If we find a point outside of the unit circle, we have to continually look for new points until we <em>do</em> find one inside of the circle. Because we are running this program in parallel, where each thread transforms one point at a time, some threads might take literally forever to find a new point (if we are really unlucky).</li>
<li>To generate new points, we need to re-generate a uniform distribution, but what if our uniform distribution is not random? What if it&apos;s a grid (or something similar) instead? In this case, we really shouldn&apos;t look for a new point on the inside of the circle as all those points have already been accounted for.</li>
<li>The <code>rand()</code> function is kinda tricky on some parallel platforms (like GPUs) and might not work out of the box. In fact, the implementation shown above can only be run on the CPU.</li>
</ol>
<p>OK, fine.
I don&apos;t think anyone expected a kernel with a <code>while</code> loop inside of it to be fast.
So what about a method without replacement?
Surely there is no problem if we just ignore the <code>while</code> loop altogether!
Well, the problem with this approach is a bit less straightforward, but first, code:</p>
<pre class="language-"><code class="lang-julia">@kernel <span class="token keyword">function</span> polar_muller_noreplacement<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">)</span>
    tid <span class="token operator">=</span> @index<span class="token punctuation">(</span>Global<span class="token punctuation">,</span> Linear<span class="token punctuation">)</span>
    @inbounds r_0 <span class="token operator">=</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span>

    <span class="token comment"># this method is only valid for points within the unit circle</span>
    <span class="token keyword">if</span> r_0 <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> r_0 <span class="token operator">&gt;</span> <span class="token number">1</span>
        @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NaN</span>
        @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NaN</span>
    <span class="token keyword">else</span>
        @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span>
                                      sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>r_0<span class="token punctuation">)</span> <span class="token operator">/</span> r_0<span class="token punctuation">)</span> <span class="token operator">+</span> mu
        @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span>
                                      sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>r_0<span class="token punctuation">)</span> <span class="token operator">/</span> r_0<span class="token punctuation">)</span> <span class="token operator">+</span> mu
    <span class="token keyword">end</span>

<span class="token keyword">end</span>
</code></pre>
<p>To start discussing why a polar kernel without replacement is <em>also</em> a bad idea, let&apos;s go back to the <a href="../monte_carlo/monte_carlo.md">Monte Carlo chapter</a>, where we calculated the value of <script type="math/tex; ">\pi</script> by embedding it into a circle.
There, we found that the probability of a randomly chosen point falling within the unit circle to be <script type="math/tex; ">\frac{\pi r^2}{(2r)^2} = \frac{pi}{4} \sim 78.54\%</script>, shown in the visual below:</p>
<p>
    <img class="center" src="../monte_carlo_integration/res/monte_carlo.gif" style="width:60%">
</p>

<p>This means that a uniform distribution of points within a circle will reject <script type="math/tex; ">\sim 21.46\%</script> of points on the square.
This also means that if we have a specific <script type="math/tex; ">n</script> value we want for the final distribution, we will need <script type="math/tex; ">\frac{1}{0.7853} \sim 1.273 \times</script> more input values on average!</p>
<p>No problem!
In this hypothetical case, we don&apos;t need <em>exactly</em> <script type="math/tex; ">n</script> points, so we can just start the initial distributions with <script type="math/tex; ">1.273 \times n</script> points, right?</p>
<p>Right.
That will work well on parallel CPU hardware, but on the GPU this will still have an issue.</p>
<p>On the GPU, computation is all done in parallel, but there is a minimum unit of parallelism called a <em>warp</em>.
The warp is the smallest number of threads that can execute something in parallel and is usually about 32.
This means that if an operation is queued, all 32 threads will do it at the same time.
If 16 threads need to execute something and the other 16 threads need to execute something else, this will lead to <em>warp divergence</em> where 2 actions need to be performed instead of 1:</p>
<p>
    <img class="center" src="res/warp_divergence.png" style="width:100%">
</p>

<p>In this image, every odd thread needs to perform the pink action, while the even threads need to perform the blue action.
This means that 2 separate parallel tasks will be performed, one for the even threads, another for the odd threads.
This means that if <script type="math/tex; ">\ell</script> separate operations are queued, it could take <script type="math/tex; ">\ell\times</script> as long for all the threads to do their work!
This is why <code>if</code> statements in a kernel can be dangerous!
If used improperly, they can cause certain threads in a warp to do different things!</p>
<p>So let&apos;s imagine that the above image is part of a larger array of values, such that there are a bunch of warps with the same divergence issue.
In this case, we could sort the array before-hand so that all even elements come before all odd elements.
This would mean that the warps will almost certainly not diverge because the elements queued will all be of the same type and require the same operations.
Unfortunately, this comes at the cost of a sorting operation which is prohibitively expensive.</p>
<p>If we look at the above kernel, we are essentially asking <script type="math/tex; ">21.47\%</script> of our threads to do something different than everyone else, and because we are usually inputting a uniform random distribution, this means that <em>most</em> warps will have to queue up 2 parallel actions instead of 1.</p>
<p>Essentially, we need to pick our poison:</p>
<ul>
<li>Slow <script type="math/tex; ">\sin</script> and <script type="math/tex; ">\cos</script> operations with the Cartesian method</li>
<li>Warp divergence with the Polar method</li>
</ul>
<p>The only way to know which is better is to perform benchmarks, which we will show in a bit, but there is one final scenario we should consider: what about doing the rejection sampling as a pre-processing step?
This would mean that we pre-initialize the polar kernel with a uniform distribution of points in the unit circle.
This means no warp divergence, so we can get the best of both worlds, right?</p>
<p>Well, not exactly.
The polar Box—Muller method will definitely be faster, but again: someone somewhere needed to do rejection sampling and if we include that step into the process, things become complicated again.
The truth is that this pre-processing step is difficult to get right, so it might require a chapter in it&apos;s own right.</p>
<p>In many cases, it&apos;s worth spending a little time before-hand to make sure subsequent operations are fast, but in this case, we only have a single operation, not a set of operations.
The Box—Muller method will usually only be used once at the start of the simulation, which means that the pre-processing step of rejection sampling might end up being overkill.</p>
<p>No matter the case, benchmarks will show the true nature of what we are dealing with here:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>CPU</th>
<th>GPU</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cartesian</td>
<td><script type="math/tex; ">385.819 \pm 1.9</script>ms</td>
<td><script type="math/tex; ">19.347 \pm 0.618</script>ms</td>
</tr>
<tr>
<td>Polar without replacement</td>
<td><script type="math/tex; ">273.308 \pm 2.81</script>ms</td>
<td><script type="math/tex; ">26.712 \pm 0.592</script>ms</td>
</tr>
<tr>
<td>Polar with replacement</td>
<td><script type="math/tex; ">433.644 \pm 2.64</script>ms</td>
<td>NA</td>
</tr>
</tbody>
</table>
<p>These were run with an Nvidia GTX 970 GPU and a Ryzen 3700X 16 core CPU.
For those interested, the code can be found below.
For these benchmarks, we used Julia&apos;s inbuilt benchmarking suite from <code>BenchmarkTools</code>, making sure to sync the GPU kernels with <code>CUDA.@sync</code>.
We also ran with <script type="math/tex; ">4096^2</script> input points.</p>
<p>Here, we see an interesting divergence in the results.
On the CPU, the polar method is <em>always</em> faster, but on the GPU, both methods are comparable.
I believe this is the most important lesson to be learned from the Box—Muller method: sometimes, no matter how hard you try to optimize your code, different hardware can provide radically different results!
It&apos;s incredibly important to benchmark code to make sure it is actually is as performant as you think it is!</p>
<h2 id="full-script">Full Script</h2>
<pre class="language-"><code class="lang-julia"><span class="token keyword">using</span> KernelAbstractions
<span class="token keyword">using</span> CUDA

<span class="token keyword">if</span> has_cuda_gpu<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">using</span> CUDAKernels
<span class="token keyword">end</span>

<span class="token keyword">function</span> create_grid<span class="token punctuation">(</span>n<span class="token punctuation">,</span> endpoints<span class="token punctuation">;</span> AT <span class="token operator">=</span> Array<span class="token punctuation">)</span>

    grid_extents <span class="token operator">=</span> endpoints<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> endpoints<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

    <span class="token comment"># number of points along any given axis</span>
    <span class="token comment"># For 2D, we take the sqrt(n) and then round up</span>
    axis_num <span class="token operator">=</span> ceil<span class="token punctuation">(</span>Int<span class="token punctuation">,</span> sqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># we are now rounding n up to the nearest square if it was not already one</span>
    <span class="token keyword">if</span> sqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">!=</span> axis_num
       n <span class="token operator">=</span> axis_num<span class="token operator">^</span><span class="token number">2</span>
    <span class="token keyword">end</span> 

    <span class="token comment"># Distance between each point</span>
    dx <span class="token operator">=</span> grid_extents <span class="token operator">/</span> <span class="token punctuation">(</span>axis_num<span class="token punctuation">)</span>

    <span class="token comment"># This is warning in the case that we do not have a square number</span>
    <span class="token keyword">if</span> sqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">!=</span> axis_num
        <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;Cannot evenly divide &quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token string">&quot; into 2 dimensions!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span> 

    <span class="token comment"># Initializing the array, particles along the column, dimensions along rows</span>
    a <span class="token operator">=</span> AT<span class="token punctuation">(</span>zeros<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># This works by firxt generating an N dimensional tuple with the number</span>
    <span class="token comment"># of particles to be places along each dimension ((10,10) for 2D and n=100)</span>
    <span class="token comment"># Then we generate the list of all CartesianIndices and cast that onto a</span>
    <span class="token comment"># grid by multiplying by dx and subtracting grid_extents/2</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>axis_num
        <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>axis_num
            a<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> axis_num <span class="token operator">+</span> j<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">*</span> dx <span class="token operator">+</span> endpoints<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            a<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> axis_num <span class="token operator">+</span> j<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> j <span class="token operator">*</span> dx <span class="token operator">+</span> endpoints<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> a
<span class="token keyword">end</span>

<span class="token keyword">function</span> create_rand_dist<span class="token punctuation">(</span>n<span class="token punctuation">,</span> endpoints<span class="token punctuation">;</span> AT <span class="token operator">=</span> Array<span class="token punctuation">)</span>
    grid_extents <span class="token operator">=</span> endpoints<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> endpoints<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>AT<span class="token punctuation">(</span>rand<span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> grid_extents <span class="token punctuation">.</span><span class="token operator">+</span> endpoints<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token keyword">end</span>

<span class="token comment"># This function reads in a pair of input points and performs the Cartesian</span>
<span class="token comment"># Box--Muller transform</span>
@kernel <span class="token keyword">function</span> polar_muller_noreplacement<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">)</span>
    tid <span class="token operator">=</span> @index<span class="token punctuation">(</span>Global<span class="token punctuation">,</span> Linear<span class="token punctuation">)</span>
    @inbounds r_0 <span class="token operator">=</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span>

    <span class="token comment"># this method is only valid for points within the unit circle</span>
    <span class="token keyword">if</span> r_0 <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> r_0 <span class="token operator">&gt;</span> <span class="token number">1</span>
        @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NaN</span>
        @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NaN</span>
    <span class="token keyword">else</span>
        @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span>
                                      sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>r_0<span class="token punctuation">)</span> <span class="token operator">/</span> r_0<span class="token punctuation">)</span> <span class="token operator">+</span> mu
        @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span>
                                      sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>r_0<span class="token punctuation">)</span> <span class="token operator">/</span> r_0<span class="token punctuation">)</span> <span class="token operator">+</span> mu
    <span class="token keyword">end</span>

<span class="token keyword">end</span>

@kernel <span class="token keyword">function</span> polar_muller_replacement<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">)</span>
    tid <span class="token operator">=</span> @index<span class="token punctuation">(</span>Global<span class="token punctuation">,</span> Linear<span class="token punctuation">)</span>
    @inbounds r_0 <span class="token operator">=</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">2</span>

    <span class="token keyword">while</span> r_0 <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">||</span> r_0 <span class="token operator">==</span> <span class="token number">0</span>
        p1 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span>
        p2 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span>
        r_0 <span class="token operator">=</span> p1<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> p2<span class="token operator">^</span><span class="token number">2</span>
    <span class="token keyword">end</span>

    @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span>
                                  sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>r_0<span class="token punctuation">)</span> <span class="token operator">/</span> r_0<span class="token punctuation">)</span> <span class="token operator">+</span> mu
    @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span>
                                  sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>r_0<span class="token punctuation">)</span> <span class="token operator">/</span> r_0<span class="token punctuation">)</span> <span class="token operator">+</span> mu
<span class="token keyword">end</span>


<span class="token keyword">function</span> polar_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">;</span>
                           numthreads <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">,</span> numcores <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
                           f <span class="token operator">=</span> polar_muller_noreplacement<span class="token operator">!</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> isa<span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> Array<span class="token punctuation">)</span>
        kernel<span class="token operator">!</span> <span class="token operator">=</span> f<span class="token punctuation">(</span>CPU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> numcores<span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        kernel<span class="token operator">!</span> <span class="token operator">=</span> f<span class="token punctuation">(</span>CUDADevice<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> numthreads<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    kernel<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">,</span> ndrange<span class="token operator">=</span>size<span class="token punctuation">(</span>input_pts<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>


@kernel <span class="token keyword">function</span> cartesian_kernel<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">)</span>
    tid <span class="token operator">=</span> @index<span class="token punctuation">(</span>Global<span class="token punctuation">,</span> Linear<span class="token punctuation">)</span>

    @inbounds r <span class="token operator">=</span> sqrt<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    @inbounds theta <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token constant">pi</span> <span class="token operator">*</span> input_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>

    @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> r <span class="token operator">*</span> cos<span class="token punctuation">(</span>theta<span class="token punctuation">)</span> <span class="token operator">+</span> mu
    @inbounds output_pts<span class="token punctuation">[</span>tid<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigma <span class="token operator">*</span> r <span class="token operator">*</span> sin<span class="token punctuation">(</span>theta<span class="token punctuation">)</span> <span class="token operator">+</span> mu
<span class="token keyword">end</span>

<span class="token keyword">function</span> cartesian_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">;</span>
                               numthreads <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">,</span> numcores <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> isa<span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> Array<span class="token punctuation">)</span>
        kernel<span class="token operator">!</span> <span class="token operator">=</span> cartesian_kernel<span class="token operator">!</span><span class="token punctuation">(</span>CPU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> numcores<span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        kernel<span class="token operator">!</span> <span class="token operator">=</span> cartesian_kernel<span class="token operator">!</span><span class="token punctuation">(</span>CUDADevice<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> numthreads<span class="token punctuation">)</span>
    <span class="token keyword">end</span>

    kernel<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> sigma<span class="token punctuation">,</span> mu<span class="token punctuation">,</span> ndrange<span class="token operator">=</span>size<span class="token punctuation">(</span>input_pts<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span>

    input_pts <span class="token operator">=</span> create_rand_dist<span class="token punctuation">(</span><span class="token number">4096</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    output_pts <span class="token operator">=</span> create_rand_dist<span class="token punctuation">(</span><span class="token number">4096</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    wait<span class="token punctuation">(</span>cartesian_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    @time wait<span class="token punctuation">(</span>cartesian_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    wait<span class="token punctuation">(</span>polar_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    @time wait<span class="token punctuation">(</span>polar_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> has_cuda_gpu<span class="token punctuation">(</span><span class="token punctuation">)</span>
        input_pts <span class="token operator">=</span> create_rand_dist<span class="token punctuation">(</span><span class="token number">4096</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> AT <span class="token operator">=</span> CuArray<span class="token punctuation">)</span>
        output_pts <span class="token operator">=</span> create_rand_dist<span class="token punctuation">(</span><span class="token number">4096</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> AT <span class="token operator">=</span> CuArray<span class="token punctuation">)</span>

        wait<span class="token punctuation">(</span>cartesian_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        CUDA<span class="token punctuation">.</span>@time wait<span class="token punctuation">(</span>cartesian_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        wait<span class="token punctuation">(</span>polar_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        CUDA<span class="token punctuation">.</span>@time wait<span class="token punctuation">(</span>polar_box_muller<span class="token operator">!</span><span class="token punctuation">(</span>input_pts<span class="token punctuation">,</span> output_pts<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>

<span class="token keyword">end</span>

main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

<h2 id="license">License</h2>
<h5 id="code-examples">Code Examples</h5>
<p>The code examples are licensed under the MIT license (found in <a href="https://github.com/algorithm-archivists/algorithm-archive/blob/main/LICENSE.md" target="_blank">LICENSE.md</a>).</p>
<h5 id="text">Text</h5>
<p>The text of this chapter was written by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><p><img class="center" src="../cc/CC-BY-SA_icon.svg"></p></a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="box_muller.html" class="navigation navigation-prev " aria-label="Previous page: Box Muller Transform">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../probability_distributions/distributions.html" class="navigation navigation-next " aria-label="Next page: Probability Distributions">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"How costly is rejection sampling?","level":"1.6.6.1","depth":3,"next":{"title":"Probability Distributions","level":"1.6.7","depth":2,"path":"contents/probability_distributions/distributions.md","ref":"contents/probability_distributions/distributions.md","articles":[]},"previous":{"title":"Box Muller Transform","level":"1.6.6","depth":2,"path":"contents/box_muller/box_muller.md","ref":"contents/box_muller/box_muller.md","articles":[{"title":"How costly is rejection sampling?","level":"1.6.6.1","depth":3,"path":"contents/box_muller/box_muller_rejection.md","ref":"contents/box_muller/box_muller_rejection.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["mathjax@https://github.com/algorithm-archivists/plugin-mathjax","bibtex-cite","wordcount","api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git","include-codeblock","bulk-redirect","prism","-highlight"],"root":"./","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"bash","name":"Bash"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"c8","name":"chip-8"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"},{"lang":"ti83b","name":"TI-83 Basic"},{"lang":"lua","name":"Lua"},{"lang":"crystal","name":"Crystal"},{"lang":"php","name":"PHP"},{"lang":"lisp","name":"Common Lisp"},{"lang":"nim","name":"Nim"},{"lang":"asm-x64","name":"X86-64 Assembly"},{"lang":"f90","name":"Fortran90"},{"lang":"factor","name":"Factor"},{"lang":"ws","name":"Whitespace"},{"lang":"scala","name":"Scala"},{"lang":"emojic","name":"Emojicode"},{"lang":"lolcode","name":"LOLCODE"},{"lang":"piet","name":"Piet"},{"lang":"ss","name":"Scheme"},{"lang":"ps1","name":"PowerShell"},{"lang":"v","name":"Vlang"},{"lang":"coffee","name":"CoffeeScript"},{"lang":"kotlin","name":"Kotlin"},{"lang":"ts","name":"TypeScript"},{"lang":"vim","name":"VimL"},{"lang":"coco","name":"Coconut"},{"lang":"dart","name":"Dart"}]},"prism":{"lang":{"asm-x64":"nasm"},"ignore":["emojicode","text"],"css":["prismjs/themes/prism-tomorrow.css"]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"bibtex-cite":{},"mathjax":{"forceSVG":false,"version":"2.6.1"},"include-codeblock":{"check":false,"edit":false,"lang":"","fixlang":true,"template":"default","theme":"chrome","unindent":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"honkit":">= 3.0.0","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"title":"Arcane Algorithm Archive","bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}},{"citationKey":"GNUPLOT","entryType":"MISC","entryTags":{"TITLE":"Gnuplot 5.0: An Interactive Plotting Program, Official Gnuplot Documentation","AUTHOR":"Williams, T and Kelley, C","YEAR":"2015"}},{"citationKey":"BEDE725","entryType":"BOOK","entryTags":{"TITLE":"Bede, the Reckoning of Time","AUTHOR":"Venerabilis, Beda and others","VOLUME":"29","YEAR":"1999","PUBLISHER":"Liverpool University Press"}},{"citationKey":"DICTCOMPUTUS","entryType":"MISC","entryTags":{"TITLE":"Dictionary.com definition of computus","URL":"https://www.merriam-webster.com/dictionary/computus","YEAR":"2020"}},{"citationKey":"COMPUTUS1876","entryType":"ARTICLE","entryTags":{"TITLE":"To find Easter: a new York correspondent sends us the following","AUTHOR":"unknown","JOURNAL":"Nature","YEAR":"1876"}},{"citationKey":"BIEN2004","entryType":"ARTICLE","entryTags":{"TITLE":"Gauss and beyond: The making of Easter algorithms","AUTHOR":"Bien, Reinhold","JOURNAL":"Archive for history of exact sciences","VOLUME":"58","NUMBER":"5","PAGES":"439--452","YEAR":"2004","PUBLISHER":"Springer"}},{"citationKey":"SERVOIS","entryType":"INPROCEEDINGS","entryTags":{"TITLE":"84 Calendrier","AUTHOR":"Servois, M","BOOKTITLE":"Annales de Mathématiques pures et appliquées","VOLUME":"4","NUMBER":"1813-1814","PAGES":"84--90"}},{"citationKey":"STANDISH2004","entryType":"ARTICLE","entryTags":{"TITLE":"The astronomical unit now","AUTHOR":"Standish, EM","JOURNAL":"Proceedings of the International Astronomical Union","VOLUME":"2004","NUMBER":"IAUC196","PAGES":"163--179","YEAR":"2004","PUBLISHER":"Cambridge University Press"}},{"citationKey":"LUNAR_MONTH_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Lunar Month","URL":"https://en.wikipedia.org/wiki/Lunar_month","YEAR":"2020"}},{"citationKey":"SELF-SIMILAR","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Self-similarity","URL":"https://en.wikipedia.org/wiki/Self-similarity","YEAR":"2019"}},{"citationKey":"HAUSDORFF","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hausdorff dimension","URL":"https://en.wikipedia.org/wiki/Hausdorff_dimension","YEAR":"2019"}},{"citationKey":"3B1BFRACTAL","entryType":"MISC","entryTags":{"AUTHOR":"Sanderson, G","TITLE":"3blue1brown: Fractals are typically not self-similar","URL":"https://www.youtube.com/watch?v=gB9n2gHsHN4","YEAR":"2017"}},{"citationKey":"MANDELBROT1983FRACTAL","entryType":"BOOK","entryTags":{"TITLE":"The fractal geometry of nature","AUTHOR":"Mandelbrot, Benoit B","VOLUME":"173","YEAR":"1983","PUBLISHER":"WH freeman New York"}},{"citationKey":"MANDELBROT1967LONG","entryType":"ARTICLE","entryTags":{"TITLE":"How long is the coast of Britain? Statistical self-similarity and fractional dimension","AUTHOR":"Mandelbrot, Benoit","JOURNAL":"science","VOLUME":"156","NUMBER":"3775","PAGES":"636--638","YEAR":"1967","PUBLISHER":"American Association for the Advancement of Science"}},{"citationKey":"JAMPOUR2010NEW","entryType":"ARTICLE","entryTags":{"TITLE":"A new fast technique for fingerprint identification with fractal and chaos game theory","AUTHOR":"Jampour, Mahdi and Yaghoobi, Mahdi and Ashourzadeh, Maryam and Soleimani, Adel","JOURNAL":"Fractals","VOLUME":"18","NUMBER":"03","PAGES":"293--300","YEAR":"2010","PUBLISHER":"World Scientific"}},{"citationKey":"FRACTAL-COMPRESSION","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Fractal Compression","URL":"https://en.wikipedia.org/wiki/Fractal_compression","YEAR":"2019"}},{"citationKey":"SAUPE1994REVIEW","entryType":"ARTICLE","entryTags":{"TITLE":"A review of the fractal image compression literature","AUTHOR":"Saupe, Dietmar and Hamzaoui, Raouf","JOURNAL":"ACM SIGGRAPH Computer Graphics","VOLUME":"28","NUMBER":"4","PAGES":"268--276","YEAR":"1994","PUBLISHER":"ACM"}},{"citationKey":"GNEITING2012ESTIMATORS","entryType":"ARTICLE","entryTags":{"TITLE":"Estimators of fractal dimension: Assessing the roughness of time series and spatial data","AUTHOR":"Gneiting, Tilmann and Ševčíková, Hana and Percival, Donald B","JOURNAL":"Statistical Science","PAGES":"247--277","YEAR":"2012","PUBLISHER":"JSTOR"}},{"citationKey":"HUTCHINSON1981FRACTALS","entryType":"ARTICLE","entryTags":{"TITLE":"Fractals and self similarity","AUTHOR":"Hutchinson, John E","JOURNAL":"Indiana University Mathematics Journal","VOLUME":"30","NUMBER":"5","PAGES":"713--747","YEAR":"1981","PUBLISHER":"JSTOR"}},{"citationKey":"HUTCHINSON-OPERATOR","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hutchinson Operator","URL":"https://en.wikipedia.org/wiki/Hutchinson_operator","YEAR":"2019"}},{"citationKey":"CHAOS-GAME","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Chaos Game","URL":"https://en.wikipedia.org/wiki/Chaos_game","YEAR":"2019"}},{"citationKey":"CHAOS-GAME-WOLF","entryType":"MISC","entryTags":{"TITLE":"Wolfram: Chaos Game","URL":"http://mathworld.wolfram.com/ChaosGame.html","YEAR":"2019"}},{"citationKey":"BARNSLEY2014FRACTALS","entryType":"BOOK","entryTags":{"TITLE":"Fractals everywhere","AUTHOR":"Barnsley, Michael F","YEAR":"2014","PUBLISHER":"Academic press"}},{"citationKey":"HSV","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: HSL and HSV","URL":"https://en.wikipedia.org/wiki/HSL_and_HSV","YEAR":"2020"}},{"citationKey":"SCHLOSS2019","entryType":"ARTICLE","entryTags":{"TITLE":"Massively parallel split-step Fourier techniques for simulating quantum systems on graphics processing units","AUTHOR":"Schloss, James","YEAR":"2019"}},{"citationKey":"PETHICK2008","entryType":"BOOK","entryTags":{"TITLE":"Bose--Einstein condensation in dilute gases","AUTHOR":"Pethick, Christopher J and Smith, Henrik","YEAR":"2008","PUBLISHER":"Cambridge university press"}},{"citationKey":"WEGERT2012","entryType":"BOOK","entryTags":{"TITLE":"Visual complex functions: an introduction with phase portraits","AUTHOR":"Wegert, Elias","YEAR":"2012","PUBLISHER":"Springer Science \\& Business Media"}},{"citationKey":"POELKEDOMAIN","entryType":"ARTICLE","entryTags":{"TITLE":"Domain Coloring of Complex Functions","AUTHOR":"Poelke, Konstantin and Polthier, Konrad"}},{"citationKey":"LUNDMARK2004","entryType":"ARTICLE","entryTags":{"TITLE":"Visualizing complex analytic functions using domain coloring","AUTHOR":"Lundmark, Hans","JOURNAL":"Recuperado el","VOLUME":"24","YEAR":"2004"}},{"citationKey":"GIMP_BUCKET","entryType":"MISC","entryTags":{"TITLE":"Bucket Fill in Gimp","URL":"https://docs.gimp.org/2.10/en/gimp-tool-bucket-fill.html","YEAR":"2020"}},{"citationKey":"TORBERT2016","entryType":"BOOK","entryTags":{"TITLE":"Applied computer science","AUTHOR":"Torbert, Shane","YEAR":"2016","PAGES":"158","PUBLISHER":"Springer"}},{"citationKey":"CANNY1986COMPUTATIONAL","entryType":"ARTICLE","entryTags":{"TITLE":"A computational approach to edge detection","AUTHOR":"Canny, John","JOURNAL":"IEEE Transactions on pattern analysis and machine intelligence","NUMBER":"6","PAGES":"679--698","YEAR":"1986","PUBLISHER":"Ieee"}},{"citationKey":"MORRIS1978COUNTING","entryType":"ARTICLE","entryTags":{"TITLE":"Counting large numbers of events in small registers","AUTHOR":"Morris, R","JOURNAL":"Communications of the ACM","VOLUME":"21","NUMBER":"10","PAGES":"840--842","YEAR":"1978","PUBLISHER":"ACM New York, NY, USA"}},{"citationKey":"FLAJOLET1985APPROXIMATE","entryType":"ARTICLE","entryTags":{"TITLE":"Approximate counting: a detailed analysis","AUTHOR":"Flajolet, P","JOURNAL":"BIT Numerical Mathematics","VOLUME":"25","NUMBER":"1","PAGES":"113--134","YEAR":"1985","PUBLISHER":"Springer"}},{"citationKey":"ARPIT_COUNTING","entryType":"MISC","entryTags":{"TITLE":"Morris's Algorithm for Approximate Counting","AUTHOR":"Bhayani, A","URL":"https://arpitbhayani.me/blogs/morris-counter","YEAR":"2020"}},{"citationKey":"GREGGUNDERSON_COUNTING","entryType":"MISC","entryTags":{"TITLE":"Approximate Counting with Morris's Algorithm","AUTHOR":"Gundersen, G","URL":"http://gregorygundersen.com/blog/2019/11/11/morris-algorithm/","YEAR":"2019"}},{"citationKey":"3B1B_FINGER_COUNT","entryType":"MISC","entryTags":{"TITLE":"How to count to 1000 on two hands","AUTHOR":"Sanderson, G","URL":"https://youtu.be/1SMmc9gQmHQ","YEAR":"2015"}},{"citationKey":"METROPOLIS1953EQUATION","entryType":"ARTICLE","entryTags":{"PAGES":"1087-1092","EPRINT":"https://doi.org/10.1063/1.1699114\n    \n","NUMBER":"6","AUTHOR":"Metropolis,Nicholas  and Rosenbluth,Arianna W.  and Rosenbluth,Marshall N.  and Teller,Augusta H.  and Teller,Edward ","URL":"https://doi.org/10.1063/1.1699114\n    \n","JOURNAL":"The Journal of Chemical Physics","TITLE":"Equation of State Calculations by Fast Computing Machines","VOLUME":"21","YEAR":"1953","DOI":"10.1063/1.1699114"}},{"citationKey":"ROSENTHAL2011OPTIMAL","entryType":"ARTICLE","entryTags":{"TITLE":"Optimal proposal distributions and adaptive MCMC","AUTHOR":"Rosenthal, Jeffrey S and others","JOURNAL":"Handbook of Markov Chain Monte Carlo","VOLUME":"4","NUMBER":"10.1201","YEAR":"2011","PUBLISHER":"Chapman & Hall/CRC Boca Raton, FL"}},{"citationKey":"GARETH2001OPTIMAL","entryType":"ARTICLE","entryTags":{"PAGES":"351 -- 367","NUMBER":"4","AUTHOR":"Gareth O. Roberts and Jeffrey S. Rosenthal","URL":"https://doi.org/10.1214/ss/1015346320","JOURNAL":"Statistical Science","TITLE":"Optimal scaling for various Metropolis-Hastings algorithms","VOLUME":"16","PUBLISHER":"Institute of Mathematical Statistics","YEAR":"2001","DOI":"10.1214/ss/1015346320"}},{"citationKey":"POTENTIAL_ENERGY_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Potential Energy","URL":"https://en.wikipedia.org/wiki/Potential_energy","YEAR":"2021"}},{"citationKey":"LUDWIG_BOLTZMANN_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Ludwig Boltzmann","URL":"https://en.wikipedia.org/wiki/Ludwig_Boltzmann","YEAR":"2021"}},{"citationKey":"BOLTZMANN_DISTRIBUTION_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Boltzmann distribution","URL":"https://en.wikipedia.org/wiki/Boltzmann_distribution","YEAR":"2021"}},{"citationKey":"HASTINGS1970MONTE","entryType":"ARTICLE","entryTags":{"MONTH":"04","ABSTRACT":"{A generalization of the sampling method introduced by Metropolis et al. (1953) is presented along with an exposition of the relevant theory, techniques of application and methods and difficulties of assessing the error in Monte Carlo estimates. Examples of the methods, including the generation of random orthogonal matrices and potential applications of the methods to numerical problems arising in statistics, are discussed.}","PAGES":"97-109","ISSN":"0006-3444","EPRINT":"https://academic.oup.com/biomet/article-pdf/57/1/97/23940249/57-1-97.pdf","NUMBER":"1","AUTHOR":"Hastings, W. K.","URL":"https://doi.org/10.1093/biomet/57.1.97","JOURNAL":"Biometrika","TITLE":"Monte Carlo sampling methods using Markov chains and their applications","VOLUME":"57","YEAR":"1970","DOI":"10.1093/biomet/57.1.97"}},{"citationKey":"MALA_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Metropolis-adjusted Langevin Algorithm","URL":"https://en.wikipedia.org/wiki/Metropolis-adjusted_Langevin_algorithm","YEAR":"2021"}},{"citationKey":"HMC_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hamiltonian Monte Carlo","URL":"https://en.wikipedia.org/wiki/Hamiltonian_Monte_Carlo","YEAR":"2021"}},{"citationKey":"RMSD_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Root Mean Square Deviation","URL":"https://en.wikipedia.org/wiki/Root-mean-square_deviation","YEAR":"2021"}},{"citationKey":"CEASAR_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Ceasar Cipher","URL":"https://en.wikipedia.org/wiki/Caesar_cipher","YEAR":"2022"}},{"citationKey":"POST-QUANTUM_CRYPTO_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Post-quantum Cryptography","URL":"https://en.wikipedia.org/wiki/Post-quantum_cryptography","YEAR":"2022"}},{"citationKey":"KERCKHOFFS_PRINCIPLE_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Kerckhoffs's principle","URL":"https://en.wikipedia.org/wiki/Kerckhoffs%27s_principle","YEAR":"2022"}},{"citationKey":"ROT13_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: ROT13","URL":"https://en.wikipedia.org/wiki/ROT13","YEAR":"2022"}},{"citationKey":"CC_PERMUTATION","entryType":"MISC","entryTags":{"TITLE":"Crypto Corner: Permutation Cipher","URL":"https://crypto.interactive-maths.com/permutation-cipher.html","YEAR":"2022"}},{"citationKey":"XOR_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: XOR cipher","URL":"https://en.wikipedia.org/wiki/XOR_cipher","YEAR":"2022"}},{"citationKey":"DES_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Data Encryption Standard","URL":"https://en.wikipedia.org/wiki/Data_Encryption_Standard","YEAR":"2022"}},{"citationKey":"AES_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Advanced Encryption Standard","URL":"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard","YEAR":"2022"}},{"citationKey":"BLOWFISH_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Blowfish (cipher)","URL":"https://en.wikipedia.org/wiki/Blowfish_(cipher)","YEAR":"2022"}},{"citationKey":"RSA_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: RSA (cryptosystem)","URL":"https://en.wikipedia.org/wiki/RSA_(cryptosystem)","YEAR":"2022"}},{"citationKey":"ECC_CRYPTO_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Elliptic-curve cryptography","URL":"https://en.wikipedia.org/wiki/Elliptic-curve_cryptography","YEAR":"2022"}},{"citationKey":"BOX1958","entryType":"ARTICLE","entryTags":{"TITLE":"A note on the generation of random normal deviates","AUTHOR":"Box, George EP","JOURNAL":"Ann. Math. Statist.","VOLUME":"29","PAGES":"610--611","YEAR":"1958"}},{"citationKey":"MARSAGLIA_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Marsaglia Transform","URL":"https://en.wikipedia.org/wiki/Marsaglia_polar_method","YEAR":"2022"}},{"citationKey":"BOX_MULLER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Box-Muller Transform","URL":"https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform","YEAR":"2022"}}],"gitbook":"*"},"file":{"path":"contents/box_muller/box_muller_rejection.md","mtime":"2022-05-06T18:26:58.854Z","type":"markdown"},"gitbook":{"version":"3.7.1","time":"2022-05-06T18:27:33.114Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

