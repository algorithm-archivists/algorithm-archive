
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Metropolis · Arcane Algorithm Archive</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.1">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../matrix_methods/matrix_methods.html" />
    
    
    <link rel="prev" href="../monte_carlo_integration/monte_carlo_integration.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/introduction.html">
            
                <a href="../introduction/introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how_to_contribute/how_to_contribute.html">
            
                <a href="../how_to_contribute/how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../code_reviews/code_reviewers.html">
            
                <a href="../code_reviews/code_reviewers.html">
            
                    
                    Code Reviewers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../plotting/plotting.html">
            
                <a href="../plotting/plotting.html">
            
                    
                    Plotting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../domain_coloring/domain_coloring.html">
            
                <a href="../domain_coloring/domain_coloring.html">
            
                    
                    Domain Coloring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../IFS/IFS.html">
            
                <a href="../IFS/IFS.html">
            
                    
                    Iterated Function Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../barnsley/barnsley.html">
            
                <a href="../barnsley/barnsley.html">
            
                    
                    The Barnsley Fern
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../data_structures/data_structures.html">
            
                <a href="../data_structures/data_structures.html">
            
                    
                    Data Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../stacks_and_queues/stacks_and_queues.html">
            
                <a href="../stacks_and_queues/stacks_and_queues.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../mathematical_background/mathematical_background.html">
            
                <a href="../mathematical_background/mathematical_background.html">
            
                    
                    Mathematical Background
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../notation/notation.html">
            
                <a href="../notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../affine_transformations/affine_transformations.html">
            
                <a href="../affine_transformations/affine_transformations.html">
            
                    
                    Affine Transformations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../bitlogic/bitlogic.html">
            
                <a href="../bitlogic/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../taylor_series_expansion/taylor_series_expansion.html">
            
                <a href="../taylor_series_expansion/taylor_series_expansion.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../convolutions/convolutions.html">
            
                <a href="../convolutions/convolutions.html">
            
                    
                    Convolutions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.5.1" data-path="../convolutions/1d/1d.html">
            
                <a href="../convolutions/1d/1d.html">
            
                    
                    Convolutions in 1D
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.2" data-path="../convolutions/multiplication/multiplication.html">
            
                <a href="../convolutions/multiplication/multiplication.html">
            
                    
                    Multiplication as a Convolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.3" data-path="../convolutions/2d/2d.html">
            
                <a href="../convolutions/2d/2d.html">
            
                    
                    Convolutions of Images (2D)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.4" data-path="../convolutions/convolutional_theorem/convolutional_theorem.html">
            
                <a href="../convolutions/convolutional_theorem/convolutional_theorem.html">
            
                    
                    Convolutional Theorem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../probability_distributions/distributions.html">
            
                <a href="../probability_distributions/distributions.html">
            
                    
                    Probability Distributions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../tree_traversal/tree_traversal.html">
            
                <a href="../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../euclidean_algorithm/euclidean_algorithm.html">
            
                <a href="../euclidean_algorithm/euclidean_algorithm.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../monte_carlo_integration/monte_carlo_integration.html">
            
                <a href="../monte_carlo_integration/monte_carlo_integration.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.9.1" data-path="metropolis.html">
            
                <a href="metropolis.html">
            
                    
                    Metropolis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../matrix_methods/matrix_methods.html">
            
                <a href="../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../gaussian_elimination/gaussian_elimination.html">
            
                <a href="../gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../thomas_algorithm/thomas_algorithm.html">
            
                <a href="../thomas_algorithm/thomas_algorithm.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../computational_geometry/computational_geometry.html">
            
                <a href="../computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../gift_wrapping/gift_wrapping.html">
            
                <a href="../gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="../jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="../graham_scan/graham_scan.html">
            
                <a href="../graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../cooley_tukey/cooley_tukey.html">
            
                <a href="../cooley_tukey/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../decision_problems/decision_problems.html">
            
                <a href="../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../stable_marriage_problem/stable_marriage_problem.html">
            
                <a href="../stable_marriage_problem/stable_marriage_problem.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../physics_solvers/physics_solvers.html">
            
                <a href="../physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../verlet_integration/verlet_integration.html">
            
                <a href="../verlet_integration/verlet_integration.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../quantum_systems/quantum_systems.html">
            
                <a href="../quantum_systems/quantum_systems.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.2.1" data-path="../split-operator_method/split-operator_method.html">
            
                <a href="../split-operator_method/split-operator_method.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../data_compression/data_compression.html">
            
                <a href="../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../huffman_encoding/huffman_encoding.html">
            
                <a href="../huffman_encoding/huffman_encoding.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../computer_graphics/computer_graphics.html">
            
                <a href="../computer_graphics/computer_graphics.html">
            
                    
                    Computer Graphics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../flood_fill/flood_fill.html">
            
                <a href="../flood_fill/flood_fill.html">
            
                    
                    Flood Fill
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../quantum_information/quantum_information.html">
            
                <a href="../quantum_information/quantum_information.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../cryptography/cryptography.html">
            
                <a href="../cryptography/cryptography.html">
            
                    
                    Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../computus/computus.html">
            
                <a href="../computus/computus.html">
            
                    
                    Computus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../approximate_counting/approximate_counting.html">
            
                <a href="../approximate_counting/approximate_counting.html">
            
                    
                    Approximate Counting Algorithm
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Metropolis</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="the-metropolis-algorithm">The Metropolis Algorithm</h1>
<p>The <a href="../monte_carlo_integration/monte_carlo_integration.html">Monte Carlo Integration</a> method uses random numbers to approximate the area of pretty much any shape we choose. 
The Metropolis algorithm <a href="#cite-1">[1]</a> is a slightly more advanced Monte Carlo method which uses random numbers to approximate a <a href="../probability_distributions/distributions.html">probability distribution</a>:</p>
<p><script type="math/tex; mode=display">
P(\mathbf{x}) = \frac{f(\mathbf{x})}{\displaystyle\int_D f(\mathbf{x})d\mathbf{x}},
</script></p>
<p>where <script type="math/tex; ">D</script> is the domain of <script type="math/tex; ">P(\mathbf{x})</script>, i.e., all possible values of the <script type="math/tex; ">\mathbf{x}</script> for which <script type="math/tex; ">P(\mathbf{x})</script> is defined.
<script type="math/tex; ">f(\mathbf{x})</script> is a function that is proportional to <script type="math/tex; ">P(x)</script>, such as a statistical frequency distribution which counts the number of occurrences of each <script type="math/tex; ">\mathbf{x}</script>.
The integral in the denominator is the <strong>normalization factor</strong> which ensures that the sum of all probabilities is unity, i.e.,
<script type="math/tex; mode=display">
\int_D P(\mathbf{x}) d\mathbf{x} = 1.
</script>
A one-dimensional example is the <strong>normal distribution</strong>, or <strong>Gaussian distribution</strong>, given by</p>
<p><script type="math/tex; mode=display">
P(x) = \frac{e^{-x^2}}{\displaystyle\int_{-\infty}^{\infty} e^{-x^2} dx} = \frac{1}{\sqrt{\pi}} e^{-x^2}.
</script></p>
<p>In practice, it&apos;s often easy for us to know <script type="math/tex; ">f(x)</script>, but the integral in the denominator can be quite difficult to calculate, even numerically. 
This is especially true when the coordinates (<script type="math/tex; ">\mathbf{x}</script>) are multidimensional, and <script type="math/tex; ">f(\mathbf{x})</script> is an expensive calculation, as we shall see in the examples below.</p>
<h2 id="an--example-application">An  example application</h2>
<p>One example of a complicated probability function arises when considering a physical system of <script type="math/tex; ">N</script> particles. 
These could be atoms, molecules, or even star systems! 
For such systems, we can usually describe the <strong>potential energy</strong> <a href="#cite-2">[2]</a> of the system as a function of the coordinates of all particles, <script type="math/tex; ">\mathbf{x}</script>,</p>
<p><script type="math/tex; mode=display">
E(\mathbf{x}) = E(x_1, y_1, z_1, x_2, y_2, z_2, ... ,x_N, y_N, z_N),
</script></p>
<p>where <script type="math/tex; ">x_i, y_i, z_i</script> are the spatial coordinates of particle <script type="math/tex; ">i</script>. 
So altogether there are <script type="math/tex; ">3N</script> coordinates – making <script type="math/tex; ">E(\mathbf{x})</script> a <script type="math/tex; ">3N</script> dimensional function, which can be a computationally intensive calculation on it&apos;s own. But it doesn&apos;t end there!</p>
<p>The physicist Ludwig Boltzmann <a href="#cite-3">[3]</a> discovered that when such a system is in equilibrium at some temperature <script type="math/tex; ">T</script>, you can describe the probability density of the system for any set of coordinates <script type="math/tex; ">\mathbf{x}</script> using, <a href="#cite-4">[4]</a> </p>
<p><script type="math/tex; mode=display">
P(\mathbf{x}) = \frac{\displaystyle \exp\left[{\displaystyle\frac{-E(\mathbf{x})}{T} } \right]} {Q},
</script></p>
<p>where the numerator is called the <strong>Boltzmann factor</strong>, and <script type="math/tex; ">Q</script> is the <a href="../probability_distributions/distributions.html">normalization constant</a>,</p>
<p><script type="math/tex; mode=display">
Q = \int_D \exp\left[{\displaystyle\frac{-E(\mathbf{x})}{T} } \right] d\mathbf{x}.
</script></p>
<p>We can see now that the probability density function is a difficult calculation, particularly because of <script type="math/tex; ">Q</script>. 
Almost always, no analytical solution exists to the integral in <script type="math/tex; ">Q</script>, and the numerical integration is unfeasible. </p>
<p>To see that <script type="math/tex; ">Q</script> is unfeasible to calculate, imagine there are just <script type="math/tex; ">10</script> particles which all exist in a <script type="math/tex; ">1</script>D world, restricted to a line segment.</p>
<p>
    <img class="center" src="res/1D_particles.png" style="width:100%" alt="&lt;FIG&gt; 1D particles">
</p>

<p>Let&apos;s assume that the particles <em>interact</em>, meaning that the position of one particle affects that of another. 
This could be the case, for example, if all the particles were charged, and so they would be repelling or attracting each other. 
This means that the energy <script type="math/tex; ">E(\mathbf{x}) = E(x_1,...,x_{10})</script> of the system is a <script type="math/tex; ">10</script>D function, and it would not be possible to simplify it any further due to the interactions. 
Thus, the Boltzmann factor, <script type="math/tex; ">\exp\left[-E(\mathbf{x})/T\right]</script>, is also a <script type="math/tex; ">10</script>D function. To calculate <script type="math/tex; ">Q</script>, we would have to integrate the Boltzmann factor <script type="math/tex; ">10</script> times, one for each coordinate,</p>
<p><script type="math/tex; mode=display">
Q = \int_{x_1} \dots \int_{x_{10}} \exp\left[\frac{-E(x_1,\dots x_{10})}{T}\right]\ dx_1\dots dx_{10}.
</script></p>
<p>In most cases, there is no known analytical expression for the above integral, so it has to be done numerically.
To do so, imagine that we divide the <script type="math/tex; ">1</script>D line segment into only <script type="math/tex; ">50</script> different intervals, allowing each particle to take on <script type="math/tex; ">50</script> different positions. 
This is equivalent to dividing the length of a football field into intervals of about <script type="math/tex; ">2</script> meters – not a resolution you&apos;d wanna watch a game in! 
Even with such poor resolution, the number of different combinations of positions is <script type="math/tex; ">10^{50}</script> – a colossal number indeed. 
To see how large this number is, imagine that a single computation of <script type="math/tex; ">E(\mathbf{x})</script> took only <script type="math/tex; ">1</script> nanosecond on a single processor, which is much faster than most energy calculations for physical systems in practice.
 With that speed, it would require <script type="math/tex; ">10^{41}</script> seconds on a single processor to calculate <script type="math/tex; ">Q</script> – which means that <em>even</em> with all the processors in the world running in parallel (there could be billions or trillions of them), calculating <script type="math/tex; ">Q</script> would still take longer than the age of the universe – by many orders of magnitude!</p>
<p>What&apos;s really powerful about the Metropolis approach is that you don&apos;t need to know the probability function itself.
Instead, you just need a function which is <em>proportional</em> to it. 
What this means for the Boltzmann distribution is that you only need to know the term,</p>
<p><script type="math/tex; mode=display">
f(\mathbf{x}) = \exp\left[{\displaystyle\frac{-E(\mathbf{x})}{T} } \right].
</script></p>
<p>The Metropolis algorithm can bypass the calculation of <script type="math/tex; ">Q</script> altogether and use <script type="math/tex; ">f(x)</script> to generate a distribution of <script type="math/tex; ">x</script> which follows the probability density <script type="math/tex; ">P(x)</script>. 
In other words, it can sample values of <script type="math/tex; ">x</script> in such away that the probability of sampling <script type="math/tex; ">x</script> will follow the actual distribution <script type="math/tex; ">P(x)</script>. 
Thus, if Metropolis was used to sample from <script type="math/tex; ">x</script>, the number of occurrences of <script type="math/tex; ">x</script> would be proportional to <script type="math/tex; ">P(x)</script>.
Numerical normalization can then be done by using the total number of samples instead of performing an integration. 
This fact dramatically reduces the number of calculations needed to approximate the probability distribution.</p>
<p>Finally, the Metropolis algorithm can be modified or implemented in other methods, and forms the basis of many advanced sampling algorithms. 
The most popular is probably the Metropolis-Hastings algorithm <a href="#cite-5">[5]</a> which is fundamentally the same. 
Some other algorithms that use this method are Metropolis-adjusted Langevin algorithm <a href="#cite-6">[6]</a>, and Hamiltonian Monte Carlo <a href="#cite-7">[7]</a>, to name a few. 
They are often used for physical systems that follow a Boltzmann distribution.</p>
<h2 id="a-random-walk-in-one-dimension">A Random Walk in One Dimension</h2>
<p>In the rest of this chapter, we will look at <script type="math/tex; ">1</script>D examples to understand the Metropolis algorithm. 
Although the algorithm is not particularly efficient in just one dimension, it is much easier to understand in one dimension than in multiple dimensions. 
The Metropolis algorithm is very similar to a random walk, so let&apos;s first see how we can get a distribution from a random walk.</p>
<div style="text-align:center">
<video style="width:80%" controls loop>
  <source src="res/animated_random_walk.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>
</div>

<p>The dot in the figure above is a &quot;walker&quot;, whose initial position is <script type="math/tex; ">x=0</script>. 
The step size, <script type="math/tex; ">g</script>, is a random number in the interval <script type="math/tex; ">(-1, 1)</script>. 
To get the next position of the walker, we simply generate <script type="math/tex; ">g</script> and add it to the current position. 
To get a distribution of <script type="math/tex; ">x</script> from this walk, we can divide the domain into discrete locations or &quot;bins&quot; and count how often the walker visits each bin. 
Each time it visits a bin, the frequency for that bin goes up by one. 
Over many iterations, we get a frequency distribution of <script type="math/tex; ">x</script>. </p>
<h2 id="a-random-walk-with-an-acceptance-criterion">A Random Walk With an Acceptance Criterion</h2>
<p>The Metropolis algorithm works in a similar way to the random walk, but differs crucially in one way – after choosing a random step for the walker, a decision is made about whether to <strong>accept</strong>  or <strong>reject</strong> the step based on the function <script type="math/tex; ">f(x)</script>. 
To understand how this works, let&apos;s call <script type="math/tex; ">x_t</script> the position before the step, and <script type="math/tex; ">x'</script> the position after it. 
We then define the probability of <strong>accepting the step</strong> to be</p>
<p><script type="math/tex; mode=display">
A = \min \left(\frac{f(x')}{f(x_t)}, 1\right).
</script></p>
<p>The <script type="math/tex; ">\min</script> function above implies that <script type="math/tex; ">A=1</script> if <script type="math/tex; ">f(x') \gt f(x_t)</script>, which means that the move will <strong>always</strong> be accepted if it is toward a higher probability position. 
Otherwise, it will be accepted with a probability of <script type="math/tex; ">f(x') / f(x_t)</script>. 
If we create a histogram of this walk for some arbitrary target function <script type="math/tex; ">P(x)</script>, we can see from the figure below that the frequency starts to look very much like it after many iterations! </p>
<div style="text-align:center">
<video style="width:80%" controls loop>
  <source src="res/animated_metropolis.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>
</div>

<p>Although convergence occurs eventually, not all parts of the distribution achieve convergence quickly. 
Note from the animation above, that the walker very quickly replicates the distribution of the two peaks on the left, but takes quite a while to even reach the third peak to the right. 
This is because there is a long low probability region between the third peak and second peak that acts as a &quot;barrier.&quot; 
This may not necessarily be a bad thing – sometimes one might want to estimate how long something takes to transition from one state to another, and often these peaks represent such &apos;states&apos;. 
So averaging over many metropolis runs may give some estimate of these transition times. 
If global sampling is the goal, the process of exploration could be sped up by choosing larger step sizes for the walker, for example by choosing step size <script type="math/tex; ">g</script> from an interval like <script type="math/tex; ">(-3,3)</script> instead of <script type="math/tex; ">(-1,1)</script>. </p>
<h2 id="the-algorithm-for-a-one-dimensional-example">The Algorithm for a One Dimensional Example</h2>
<p>Now let&apos;s dive into the actual algorithm with some example code!</p>
<h3 id="the-initial-setup">The Initial Setup</h3>
<p>Let our target distribution be
<script type="math/tex; mode=display">
P(x) = \frac{f(x)}{\int_{-10}^{10} f(x)},
</script></p>
<p>where <script type="math/tex; ">f(x)</script> is the same function we have shown above and is given by
<script type="math/tex; mode=display">
f(x) = 10e^{-4(x+4)^2} + 3e^{-0.2(x+1)^2} + e^{-2(x-5)^2}.
</script></p>
<p>The code for defining this function is given below.</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> normalize<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;
    Function proportional to target distribution, a sum of Gaussians.
    For testing, set normalize to True, to get target distribution exactly.
    &apos;&apos;&apos;</span>
    <span class="token comment"># Gaussian heights, width parameters, and mean positions respectively:</span>
    a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">4.</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    xs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">5.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> normalize<span class="token punctuation">:</span>
        norm <span class="token operator">=</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        a <span class="token operator">/=</span> norm

    <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">*</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> xs<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>

<p>Since this is an easy function to integrate, and hence get our target distribution <script type="math/tex; ">P(x)</script> directly,  we can use it to verify the Metropolis algorithm. 
The plot of <script type="math/tex; ">P(x)</script> in the figure below shows three different peaks of varying width and height, with some overlap as well.</p>
<p>
    <img class="center" src="res/plot_of_P.png" alt="&lt;FIG&gt; Plot of P(x)" style="width:80%">
</p>

<p>Next, we define our walker&apos;s symmetric step generating function. 
As in the random walk example, we will use a random real number between <script type="math/tex; ">-1</script> and <script type="math/tex; ">+1</script> as the step size. </p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;Random step vector.&apos;&apos;&apos;</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>

<p>However, <script type="math/tex; ">g</script> can be any function symmetric about <script type="math/tex; ">0</script> for the above algorithm to work. 
For example, it can be a number chosen randomly from a discrete list, such as <script type="math/tex; ">[ -3, -1, -1, +1, +1, +3]</script>. 
It can also be a number chosen from a symmetric continuous distribution, like the Gaussian, <script type="math/tex; ">e^{-x^2}</script>. 
In higher dimensions, the function should be spherically symmetric, such as a multidimensional Gaussian function, <script type="math/tex; ">e^{-(x^2 +y^2 + ...)}</script>. 
Whatever function you choose, there are at least a couple of things to note:</p>
<ol>
<li>If the function <script type="math/tex; ">g</script> is discrete, you will only sample discrete values. 
For example, if <script type="math/tex; ">g</script> returns only <script type="math/tex; ">-1</script> or <script type="math/tex; ">+1</script>, and nothing in between, you will sample only integer steps away from the initial <script type="math/tex; ">x_0</script>. </li>
<li>The average step size really matters! 
A small step-size means the walker will carefully sample nearby regions more, but will walk more slowly, so might not be good at exploring far and wide. 
On the other hand, a walker with a large step size may not sample nearby regions accurately – and actually has a higher chance of being rejected if the walker is already in a high probability region, since the acceptance ratio is more drastic for large steps. 
The effect of step-size on the walker&apos;s efficiency is far from obvious! </li>
</ol>
<p>The question of how to choose an optimal <script type="math/tex; ">g</script> is a research area on its own, and depends largely on what the goal of the sampling is.
Some techniques even use an &quot;adaptive&quot; method where <script type="math/tex; ">g</script> is &quot;trained&quot; on-the-fly using a learning algorithm! 
Some of these methods and others are discussed in Ref. <a href="#cite-8">[8]</a> and Ref. <a href="#cite-9">[9]</a>. 
In a lot of cases, people just use trial and error, as the algorithm is not too difficult to implement.</p>
<p>After choosing <script type="math/tex; ">g</script>, we are almost ready to iterate. 
We just need to choose the domain of <script type="math/tex; ">x</script>, and an initial point for <script type="math/tex; "> x_0 </script> (<script type="math/tex; ">x_t</script> at <script type="math/tex; ">t = 0</script>) chosen randomly from the domain of <script type="math/tex; ">x</script>.</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python">xmin<span class="token punctuation">,</span> xmax <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span>
x0 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>xmin<span class="token punctuation">,</span> xmax<span class="token punctuation">)</span>
</code></pre>
</div></div></div>

<h3 id="how-to-iterate">How to Iterate</h3>
<ol>
<li>Generate new proposed position <script type="math/tex; ">x' = x_t + g</script>.</li>
<li>Calculate the acceptance probability, 
<script type="math/tex; mode=display">
A = \min\left(1, \frac{f(x')}{f(x_t)}\right).
</script></li>
<li>Accept proposal, <script type="math/tex; ">x'</script> with probability <script type="math/tex; ">A</script>. If your programming language doesn&apos;t have a built-in method for this,<ul>
<li>Generate a random number <script type="math/tex; ">u</script> between <script type="math/tex; ">0</script> and <script type="math/tex; ">1</script>.</li>
<li>If <script type="math/tex; "> u \leq A </script>, then <strong>accept</strong> move, and set new position, <script type="math/tex; ">x_{t+1} = x' </script>.</li>
<li>Otherwise, <strong>reject</strong> move, and set new position to current position, <script type="math/tex; ">x_{t+1} = x_t </script>.</li>
</ul>
</li>
<li>Increment <script type="math/tex; ">t \rightarrow t + 1</script> and repeat from step 1.</li>
</ol>
<p>The code for steps 1 to 3 is:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">metropolis_iterate</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span> num_steps<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;Iterate metropolis algorithm for num_steps using iniital position x_0&apos;&apos;&apos;</span>

    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_steps<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            x <span class="token operator">=</span> x0
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            x <span class="token operator">=</span> metropolis_step<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">yield</span> x
</code></pre>
</div></div></div>

<p>The following plot shows the result of running the algorithm for different numbers of iterations (<script type="math/tex; ">N</script>), with the same initial position. 
The histograms are normalized so that they integrate to <script type="math/tex; ">1</script>. 
We can see the convergence toward <script type="math/tex; ">P(x)</script> as we increase <script type="math/tex; ">N</script>.</p>
<p>
    <img class="center" src="res/multiple_histograms.png" alt="&lt;FIG&gt; multiple histograms" style="width:80%">
</p>


<h2 id="example-code">Example Code</h2>
<p>The following code puts everything together, and runs the Metropolis algorithm for a number of  steps given by <code>num_steps</code>. 
All the positions visited by the algorithm are then written to a file, which can be later read and fed into a histogram or other density calculating scheme. 
The code also incorporates a few tests of the algorithm using the <code>test_metropolis_iterate</code> method. 
This test will create a normalized density histogram from the generated data, and compare it to <script type="math/tex; ">P(x)</script> using the Root Mean Square Deviations metric <a href="#cite-10">[10]</a>.</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> normalize<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;
    Function proportional to target distribution, a sum of Gaussians.
    For testing, set normalize to True, to get target distribution exactly.
    &apos;&apos;&apos;</span>
    <span class="token comment"># Gaussian heights, width parameters, and mean positions respectively:</span>
    a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">4.</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    xs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">5.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> normalize<span class="token punctuation">:</span>
        norm <span class="token operator">=</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>a <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        a <span class="token operator">/=</span> norm

    <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">*</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> xs<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;Random step vector.&apos;&apos;&apos;</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">metropolis_step</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> f<span class="token operator">=</span>f<span class="token punctuation">,</span> g<span class="token operator">=</span>g<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;Perform one full iteration and return new position.&apos;&apos;&apos;</span>

    x_proposed <span class="token operator">=</span> x <span class="token operator">+</span> g<span class="token punctuation">(</span><span class="token punctuation">)</span>
    a <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>f<span class="token punctuation">(</span>x_proposed<span class="token punctuation">)</span> <span class="token operator">/</span> f<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    x_new <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">[</span>x_proposed<span class="token punctuation">,</span> x<span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">-</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> x_new

<span class="token keyword">def</span> <span class="token function">metropolis_iterate</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span> num_steps<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;Iterate metropolis algorithm for num_steps using iniital position x_0&apos;&apos;&apos;</span>

    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_steps<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            x <span class="token operator">=</span> x0
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            x <span class="token operator">=</span> metropolis_step<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">yield</span> x


<span class="token keyword">def</span> <span class="token function">test_metropolis_iterate</span><span class="token punctuation">(</span>num_steps<span class="token punctuation">,</span> xmin<span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> x0<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;
    Calculate error in normalized density histogram of data  
    generated by metropolis_iterate() by using 
    normalized-root-mean-square-deviation metric. 
    &apos;&apos;&apos;</span>

    bin_width <span class="token operator">=</span> <span class="token number">0.25</span>
    bins <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>xmin<span class="token punctuation">,</span> xmax <span class="token operator">+</span> bin_width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> bin_width<span class="token punctuation">)</span>
    centers <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>xmin <span class="token operator">+</span> bin_width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> bin_width<span class="token punctuation">)</span>

    true_values <span class="token operator">=</span> f<span class="token punctuation">(</span>centers<span class="token punctuation">,</span> normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    mean_value <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>true_values <span class="token operator">-</span> <span class="token builtin">min</span><span class="token punctuation">(</span>true_values<span class="token punctuation">)</span><span class="token punctuation">)</span>

    x_dat <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>metropolis_iterate<span class="token punctuation">(</span>x0<span class="token punctuation">,</span> num_steps<span class="token punctuation">)</span><span class="token punctuation">)</span>
    heights<span class="token punctuation">,</span> _ <span class="token operator">=</span> np<span class="token punctuation">.</span>histogram<span class="token punctuation">(</span>x_dat<span class="token punctuation">,</span> bins<span class="token operator">=</span>bins<span class="token punctuation">,</span> density<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    nmsd <span class="token operator">=</span> np<span class="token punctuation">.</span>average<span class="token punctuation">(</span><span class="token punctuation">(</span>heights <span class="token operator">-</span> true_values<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">/</span> mean_value<span class="token punctuation">)</span>
    nrmsd <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>nmsd<span class="token punctuation">)</span>

    <span class="token keyword">return</span> nrmsd



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    xmin<span class="token punctuation">,</span> xmax <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span>
    x0 <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>xmin<span class="token punctuation">,</span> xmax<span class="token punctuation">)</span>

    num_steps <span class="token operator">=</span> <span class="token number">50_000</span>

    x_dat <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>metropolis_iterate<span class="token punctuation">(</span>x0<span class="token punctuation">,</span> <span class="token number">50_000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># Write data to file</span>
    output_string <span class="token operator">=</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> x_dat<span class="token punctuation">)</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;output.dat&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out<span class="token punctuation">:</span>
        out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>output_string<span class="token punctuation">)</span>
        out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>


    <span class="token comment"># Testing</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Testing with x0 = </span><span class="token interpolation"><span class="token punctuation">{</span>x0<span class="token punctuation">:</span><span class="token format-spec">5.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&apos;num_steps&apos;</span><span class="token punctuation">:</span><span class="token format-spec">&gt;10s</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&apos;NRMSD&apos;</span><span class="token punctuation">:</span><span class="token format-spec">10s</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> num_steps <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">5_000</span><span class="token punctuation">,</span> <span class="token number">50_000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        nrmsd <span class="token operator">=</span> test_metropolis_iterate<span class="token punctuation">(</span>num_steps<span class="token punctuation">,</span> xmin<span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> x0<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>num_steps<span class="token punctuation">:</span><span class="token format-spec">10d</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>nrmsd<span class="token punctuation">:</span><span class="token format-spec">5.1%</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>



<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

<h3 id="bibliography">Bibliography</h3>
<p><div class="references"><div class="citation"><div class="citation-number" id="cite-1">1.</div><div class="citation-text">Metropolis,Nicholas   <i>et al.</i>, <a href="https://doi.org/10.1063/1.1699114
    
" target="_blank">Equation of State Calculations by Fast Computing Machines</a>, 1953.</div></div><div class="citation"><div class="citation-number" id="cite-2">2.</div><div class="citation-text"><a href="https://en.wikipedia.org/wiki/Potential_energy" target="_blank">Wikipedia: Potential Energy</a>, 2021.</div></div><div class="citation"><div class="citation-number" id="cite-3">3.</div><div class="citation-text"><a href="https://en.wikipedia.org/wiki/Ludwig_Boltzmann" target="_blank">Wikipedia: Ludwig Boltzmann</a>, 2021.</div></div><div class="citation"><div class="citation-number" id="cite-4">4.</div><div class="citation-text"><a href="https://en.wikipedia.org/wiki/Boltzmann_distribution" target="_blank">Wikipedia: Boltzmann distribution</a>, 2021.</div></div><div class="citation"><div class="citation-number" id="cite-5">5.</div><div class="citation-text">Hastings, W. K., <a href="https://doi.org/10.1093/biomet/57.1.97" target="_blank">Monte Carlo sampling methods using Markov chains and their applications</a>, 1970.</div></div><div class="citation"><div class="citation-number" id="cite-6">6.</div><div class="citation-text"><a href="https://en.wikipedia.org/wiki/Metropolis-adjusted_Langevin_algorithm" target="_blank">Wikipedia: Metropolis-adjusted Langevin Algorithm</a>, 2021.</div></div><div class="citation"><div class="citation-number" id="cite-7">7.</div><div class="citation-text"><a href="https://en.wikipedia.org/wiki/Hamiltonian_Monte_Carlo" target="_blank">Wikipedia: Hamiltonian Monte Carlo</a>, 2021.</div></div><div class="citation"><div class="citation-number" id="cite-8">8.</div><div class="citation-text">Rosenthal, Jeffrey S and others, Optimal proposal distributions and adaptive MCMC, <i>Chapman &amp; Hall/CRC Boca Raton, FL</i>, 2011.</div></div><div class="citation"><div class="citation-number" id="cite-9">9.</div><div class="citation-text">Gareth O. Roberts and Jeffrey S. Rosenthal, <a href="https://doi.org/10.1214/ss/1015346320" target="_blank">Optimal scaling for various Metropolis-Hastings algorithms</a>, <i>Institute of Mathematical Statistics</i>, 2001.</div></div><div class="citation"><div class="citation-number" id="cite-10">10.</div><div class="citation-text"><a href="https://en.wikipedia.org/wiki/Root-mean-square_deviation" target="_blank">Wikipedia: Root Mean Square Deviation</a>, 2021.</div></div></div></p>
<h2 id="license">License</h2>
<h5 id="code-examples">Code Examples</h5>
<p>The code examples are licensed under the MIT license (found in <a href="https://github.com/algorithm-archivists/algorithm-archive/blob/master/LICENSE.md" target="_blank">LICENSE.md</a>).</p>
<h5 id="imagesgraphics">Images/Graphics</h5>
<ul>
<li><p>The animation &quot;<a href="res/animated_random_walk.gif">Animated Random Walk</a>&quot; was created by <a href="https://github.com/shudipto-amin" target="_blank">K. Shudipto Amin</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
</li>
<li><p>The animation &quot;<a href="res/animated_metropolis.gif">Animated Metropolis</a>&quot; was created by <a href="https://github.com/shudipto-amin" target="_blank">K. Shudipto Amin</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
</li>
<li><p>The image &quot;<a href="res/plot_of_P.png">Plot of P(x)</a>&quot; was created by <a href="https://github.com/shudipto-amin" target="_blank">K. Shudipto Amin</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
</li>
<li><p>The image &quot;<a href="res/multiple_histograms.png">Multiple Histograms</a>&quot; was created by <a href="https://github.com/shudipto-amin" target="_blank">K. Shudipto Amin</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
</li>
</ul>
<h5 id="text">Text</h5>
<p>The text of this chapter was written by <a href="https://github.com/shudipto-amin" target="_blank">K. Shudipto Amin</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><p><img class="center" src="../cc/CC-BY-SA_icon.svg"></p></a></p>
<h5 id="pull-requests">Pull Requests</h5>
<p>After initial licensing (<a href="https://github.com/algorithm-archivists/algorithm-archive/pull/560" target="_blank">#560</a>), the following pull requests have modified the text or graphics of this chapter:</p>
<ul>
<li>none</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../monte_carlo_integration/monte_carlo_integration.html" class="navigation navigation-prev " aria-label="Previous page: Monte Carlo">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../matrix_methods/matrix_methods.html" class="navigation navigation-next " aria-label="Next page: Matrix Methods">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Metropolis","level":"1.9.1","depth":2,"next":{"title":"Matrix Methods","level":"1.10","depth":1,"path":"contents/matrix_methods/matrix_methods.md","ref":"contents/matrix_methods/matrix_methods.md","articles":[{"title":"Gaussian Elimination","level":"1.10.1","depth":2,"path":"contents/gaussian_elimination/gaussian_elimination.md","ref":"contents/gaussian_elimination/gaussian_elimination.md","articles":[]},{"title":"Thomas Algorithm","level":"1.10.2","depth":2,"path":"contents/thomas_algorithm/thomas_algorithm.md","ref":"contents/thomas_algorithm/thomas_algorithm.md","articles":[]}]},"previous":{"title":"Monte Carlo","level":"1.9","depth":1,"path":"contents/monte_carlo_integration/monte_carlo_integration.md","ref":"contents/monte_carlo_integration/monte_carlo_integration.md","articles":[{"title":"Metropolis","level":"1.9.1","depth":2,"path":"contents/metropolis/metropolis.md","ref":"contents/metropolis/metropolis.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["mathjax@https://github.com/algorithm-archivists/plugin-mathjax","bibtex-cite","wordcount","api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git","include-codeblock","bulk-redirect","prism","-highlight"],"root":"./","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"bash","name":"Bash"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"c8","name":"chip-8"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"},{"lang":"ti83b","name":"TI-83 Basic"},{"lang":"lua","name":"Lua"},{"lang":"crystal","name":"Crystal"},{"lang":"php","name":"PHP"},{"lang":"lisp","name":"Common Lisp"},{"lang":"nim","name":"Nim"},{"lang":"asm-x64","name":"X86-64 Assembly"},{"lang":"f90","name":"Fortran90"},{"lang":"factor","name":"Factor"},{"lang":"ws","name":"Whitespace"},{"lang":"scala","name":"Scala"},{"lang":"emojic","name":"Emojicode"},{"lang":"lolcode","name":"LOLCODE"},{"lang":"piet","name":"Piet"},{"lang":"ss","name":"Scheme"},{"lang":"ps1","name":"PowerShell"},{"lang":"v","name":"Vlang"},{"lang":"coffee","name":"CoffeeScript"},{"lang":"kotlin","name":"Kotlin"},{"lang":"ts","name":"TypeScript"},{"lang":"vim","name":"VimL"},{"lang":"coco","name":"Coconut"},{"lang":"dart","name":"Dart"}]},"prism":{"lang":{"asm-x64":"nasm"},"ignore":["emojicode","text"],"css":["prismjs/themes/prism-tomorrow.css"]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"bibtex-cite":{},"mathjax":{"forceSVG":false,"version":"2.6.1"},"include-codeblock":{"check":false,"edit":false,"lang":"","fixlang":true,"template":"default","theme":"chrome","unindent":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"honkit":">= 3.0.0","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"title":"Arcane Algorithm Archive","bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}},{"citationKey":"GNUPLOT","entryType":"MISC","entryTags":{"TITLE":"Gnuplot 5.0: An Interactive Plotting Program, Official Gnuplot Documentation","AUTHOR":"Williams, T and Kelley, C","YEAR":"2015"}},{"citationKey":"BEDE725","entryType":"BOOK","entryTags":{"TITLE":"Bede, the Reckoning of Time","AUTHOR":"Venerabilis, Beda and others","VOLUME":"29","YEAR":"1999","PUBLISHER":"Liverpool University Press"}},{"citationKey":"DICTCOMPUTUS","entryType":"MISC","entryTags":{"TITLE":"Dictionary.com definition of computus","URL":"https://www.merriam-webster.com/dictionary/computus","YEAR":"2020"}},{"citationKey":"COMPUTUS1876","entryType":"ARTICLE","entryTags":{"TITLE":"To find Easter: a new York correspondent sends us the following","AUTHOR":"unknown","JOURNAL":"Nature","YEAR":"1876"}},{"citationKey":"BIEN2004","entryType":"ARTICLE","entryTags":{"TITLE":"Gauss and beyond: The making of Easter algorithms","AUTHOR":"Bien, Reinhold","JOURNAL":"Archive for history of exact sciences","VOLUME":"58","NUMBER":"5","PAGES":"439--452","YEAR":"2004","PUBLISHER":"Springer"}},{"citationKey":"SERVOIS","entryType":"INPROCEEDINGS","entryTags":{"TITLE":"84 Calendrier","AUTHOR":"Servois, M","BOOKTITLE":"Annales de Mathématiques pures et appliquées","VOLUME":"4","NUMBER":"1813-1814","PAGES":"84--90"}},{"citationKey":"STANDISH2004","entryType":"ARTICLE","entryTags":{"TITLE":"The astronomical unit now","AUTHOR":"Standish, EM","JOURNAL":"Proceedings of the International Astronomical Union","VOLUME":"2004","NUMBER":"IAUC196","PAGES":"163--179","YEAR":"2004","PUBLISHER":"Cambridge University Press"}},{"citationKey":"LUNAR_MONTH_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Lunar Month","URL":"https://en.wikipedia.org/wiki/Lunar_month","YEAR":"2020"}},{"citationKey":"SELF-SIMILAR","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Self-similarity","URL":"https://en.wikipedia.org/wiki/Self-similarity","YEAR":"2019"}},{"citationKey":"HAUSDORFF","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hausdorff dimension","URL":"https://en.wikipedia.org/wiki/Hausdorff_dimension","YEAR":"2019"}},{"citationKey":"3B1BFRACTAL","entryType":"MISC","entryTags":{"AUTHOR":"Sanderson, G","TITLE":"3blue1brown: Fractals are typically not self-similar","URL":"https://www.youtube.com/watch?v=gB9n2gHsHN4","YEAR":"2017"}},{"citationKey":"MANDELBROT1983FRACTAL","entryType":"BOOK","entryTags":{"TITLE":"The fractal geometry of nature","AUTHOR":"Mandelbrot, Benoit B","VOLUME":"173","YEAR":"1983","PUBLISHER":"WH freeman New York"}},{"citationKey":"MANDELBROT1967LONG","entryType":"ARTICLE","entryTags":{"TITLE":"How long is the coast of Britain? Statistical self-similarity and fractional dimension","AUTHOR":"Mandelbrot, Benoit","JOURNAL":"science","VOLUME":"156","NUMBER":"3775","PAGES":"636--638","YEAR":"1967","PUBLISHER":"American Association for the Advancement of Science"}},{"citationKey":"JAMPOUR2010NEW","entryType":"ARTICLE","entryTags":{"TITLE":"A new fast technique for fingerprint identification with fractal and chaos game theory","AUTHOR":"Jampour, Mahdi and Yaghoobi, Mahdi and Ashourzadeh, Maryam and Soleimani, Adel","JOURNAL":"Fractals","VOLUME":"18","NUMBER":"03","PAGES":"293--300","YEAR":"2010","PUBLISHER":"World Scientific"}},{"citationKey":"FRACTAL-COMPRESSION","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Fractal Compression","URL":"https://en.wikipedia.org/wiki/Fractal_compression","YEAR":"2019"}},{"citationKey":"SAUPE1994REVIEW","entryType":"ARTICLE","entryTags":{"TITLE":"A review of the fractal image compression literature","AUTHOR":"Saupe, Dietmar and Hamzaoui, Raouf","JOURNAL":"ACM SIGGRAPH Computer Graphics","VOLUME":"28","NUMBER":"4","PAGES":"268--276","YEAR":"1994","PUBLISHER":"ACM"}},{"citationKey":"GNEITING2012ESTIMATORS","entryType":"ARTICLE","entryTags":{"TITLE":"Estimators of fractal dimension: Assessing the roughness of time series and spatial data","AUTHOR":"Gneiting, Tilmann and Ševčíková, Hana and Percival, Donald B","JOURNAL":"Statistical Science","PAGES":"247--277","YEAR":"2012","PUBLISHER":"JSTOR"}},{"citationKey":"HUTCHINSON1981FRACTALS","entryType":"ARTICLE","entryTags":{"TITLE":"Fractals and self similarity","AUTHOR":"Hutchinson, John E","JOURNAL":"Indiana University Mathematics Journal","VOLUME":"30","NUMBER":"5","PAGES":"713--747","YEAR":"1981","PUBLISHER":"JSTOR"}},{"citationKey":"HUTCHINSON-OPERATOR","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hutchinson Operator","URL":"https://en.wikipedia.org/wiki/Hutchinson_operator","YEAR":"2019"}},{"citationKey":"CHAOS-GAME","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Chaos Game","URL":"https://en.wikipedia.org/wiki/Chaos_game","YEAR":"2019"}},{"citationKey":"CHAOS-GAME-WOLF","entryType":"MISC","entryTags":{"TITLE":"Wolfram: Chaos Game","URL":"http://mathworld.wolfram.com/ChaosGame.html","YEAR":"2019"}},{"citationKey":"BARNSLEY2014FRACTALS","entryType":"BOOK","entryTags":{"TITLE":"Fractals everywhere","AUTHOR":"Barnsley, Michael F","YEAR":"2014","PUBLISHER":"Academic press"}},{"citationKey":"HSV","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: HSL and HSV","URL":"https://en.wikipedia.org/wiki/HSL_and_HSV","YEAR":"2020"}},{"citationKey":"SCHLOSS2019","entryType":"ARTICLE","entryTags":{"TITLE":"Massively parallel split-step Fourier techniques for simulating quantum systems on graphics processing units","AUTHOR":"Schloss, James","YEAR":"2019"}},{"citationKey":"PETHICK2008","entryType":"BOOK","entryTags":{"TITLE":"Bose--Einstein condensation in dilute gases","AUTHOR":"Pethick, Christopher J and Smith, Henrik","YEAR":"2008","PUBLISHER":"Cambridge university press"}},{"citationKey":"WEGERT2012","entryType":"BOOK","entryTags":{"TITLE":"Visual complex functions: an introduction with phase portraits","AUTHOR":"Wegert, Elias","YEAR":"2012","PUBLISHER":"Springer Science \\& Business Media"}},{"citationKey":"POELKEDOMAIN","entryType":"ARTICLE","entryTags":{"TITLE":"Domain Coloring of Complex Functions","AUTHOR":"Poelke, Konstantin and Polthier, Konrad"}},{"citationKey":"LUNDMARK2004","entryType":"ARTICLE","entryTags":{"TITLE":"Visualizing complex analytic functions using domain coloring","AUTHOR":"Lundmark, Hans","JOURNAL":"Recuperado el","VOLUME":"24","YEAR":"2004"}},{"citationKey":"GIMP_BUCKET","entryType":"MISC","entryTags":{"TITLE":"Bucket Fill in Gimp","URL":"https://docs.gimp.org/2.10/en/gimp-tool-bucket-fill.html","YEAR":"2020"}},{"citationKey":"TORBERT2016","entryType":"BOOK","entryTags":{"TITLE":"Applied computer science","AUTHOR":"Torbert, Shane","YEAR":"2016","PAGES":"158","PUBLISHER":"Springer"}},{"citationKey":"CANNY1986COMPUTATIONAL","entryType":"ARTICLE","entryTags":{"TITLE":"A computational approach to edge detection","AUTHOR":"Canny, John","JOURNAL":"IEEE Transactions on pattern analysis and machine intelligence","NUMBER":"6","PAGES":"679--698","YEAR":"1986","PUBLISHER":"Ieee"}},{"citationKey":"MORRIS1978COUNTING","entryType":"ARTICLE","entryTags":{"TITLE":"Counting large numbers of events in small registers","AUTHOR":"Morris, R","JOURNAL":"Communications of the ACM","VOLUME":"21","NUMBER":"10","PAGES":"840--842","YEAR":"1978","PUBLISHER":"ACM New York, NY, USA"}},{"citationKey":"FLAJOLET1985APPROXIMATE","entryType":"ARTICLE","entryTags":{"TITLE":"Approximate counting: a detailed analysis","AUTHOR":"Flajolet, P","JOURNAL":"BIT Numerical Mathematics","VOLUME":"25","NUMBER":"1","PAGES":"113--134","YEAR":"1985","PUBLISHER":"Springer"}},{"citationKey":"ARPIT_COUNTING","entryType":"MISC","entryTags":{"TITLE":"Morris's Algorithm for Approximate Counting","AUTHOR":"Bhayani, A","URL":"https://arpitbhayani.me/blogs/morris-counter","YEAR":"2020"}},{"citationKey":"GREGGUNDERSON_COUNTING","entryType":"MISC","entryTags":{"TITLE":"Approximate Counting with Morris's Algorithm","AUTHOR":"Gundersen, G","URL":"http://gregorygundersen.com/blog/2019/11/11/morris-algorithm/","YEAR":"2019"}},{"citationKey":"3B1B_FINGER_COUNT","entryType":"MISC","entryTags":{"TITLE":"How to count to 1000 on two hands","AUTHOR":"Sanderson, G","URL":"https://youtu.be/1SMmc9gQmHQ","YEAR":"2015"}},{"citationKey":"METROPOLIS1953EQUATION","entryType":"ARTICLE","entryTags":{"PAGES":"1087-1092","EPRINT":"https://doi.org/10.1063/1.1699114\n    \n","NUMBER":"6","AUTHOR":"Metropolis,Nicholas  and Rosenbluth,Arianna W.  and Rosenbluth,Marshall N.  and Teller,Augusta H.  and Teller,Edward ","URL":"https://doi.org/10.1063/1.1699114\n    \n","JOURNAL":"The Journal of Chemical Physics","TITLE":"Equation of State Calculations by Fast Computing Machines","VOLUME":"21","YEAR":"1953","DOI":"10.1063/1.1699114"}},{"citationKey":"ROSENTHAL2011OPTIMAL","entryType":"ARTICLE","entryTags":{"TITLE":"Optimal proposal distributions and adaptive MCMC","AUTHOR":"Rosenthal, Jeffrey S and others","JOURNAL":"Handbook of Markov Chain Monte Carlo","VOLUME":"4","NUMBER":"10.1201","YEAR":"2011","PUBLISHER":"Chapman & Hall/CRC Boca Raton, FL"}},{"citationKey":"GARETH2001OPTIMAL","entryType":"ARTICLE","entryTags":{"PAGES":"351 -- 367","NUMBER":"4","AUTHOR":"Gareth O. Roberts and Jeffrey S. Rosenthal","URL":"https://doi.org/10.1214/ss/1015346320","JOURNAL":"Statistical Science","TITLE":"Optimal scaling for various Metropolis-Hastings algorithms","VOLUME":"16","PUBLISHER":"Institute of Mathematical Statistics","YEAR":"2001","DOI":"10.1214/ss/1015346320"}},{"citationKey":"POTENTIAL_ENERGY_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Potential Energy","URL":"https://en.wikipedia.org/wiki/Potential_energy","YEAR":"2021"}},{"citationKey":"LUDWIG_BOLTZMANN_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Ludwig Boltzmann","URL":"https://en.wikipedia.org/wiki/Ludwig_Boltzmann","YEAR":"2021"}},{"citationKey":"BOLTZMANN_DISTRIBUTION_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Boltzmann distribution","URL":"https://en.wikipedia.org/wiki/Boltzmann_distribution","YEAR":"2021"}},{"citationKey":"HASTINGS1970MONTE","entryType":"ARTICLE","entryTags":{"MONTH":"04","ABSTRACT":"{A generalization of the sampling method introduced by Metropolis et al. (1953) is presented along with an exposition of the relevant theory, techniques of application and methods and difficulties of assessing the error in Monte Carlo estimates. Examples of the methods, including the generation of random orthogonal matrices and potential applications of the methods to numerical problems arising in statistics, are discussed.}","PAGES":"97-109","ISSN":"0006-3444","EPRINT":"https://academic.oup.com/biomet/article-pdf/57/1/97/23940249/57-1-97.pdf","NUMBER":"1","AUTHOR":"Hastings, W. K.","URL":"https://doi.org/10.1093/biomet/57.1.97","JOURNAL":"Biometrika","TITLE":"Monte Carlo sampling methods using Markov chains and their applications","VOLUME":"57","YEAR":"1970","DOI":"10.1093/biomet/57.1.97"}},{"citationKey":"MALA_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Metropolis-adjusted Langevin Algorithm","URL":"https://en.wikipedia.org/wiki/Metropolis-adjusted_Langevin_algorithm","YEAR":"2021"}},{"citationKey":"HMC_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hamiltonian Monte Carlo","URL":"https://en.wikipedia.org/wiki/Hamiltonian_Monte_Carlo","YEAR":"2021"}},{"citationKey":"RMSD_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Root Mean Square Deviation","URL":"https://en.wikipedia.org/wiki/Root-mean-square_deviation","YEAR":"2021"}},{"citationKey":"CEASAR_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Ceasar Cipher","URL":"https://en.wikipedia.org/wiki/Caesar_cipher","YEAR":"2022"}},{"citationKey":"POST-QUANTUM_CRYPTO_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Post-quantum Cryptography","URL":"https://en.wikipedia.org/wiki/Post-quantum_cryptography","YEAR":"2022"}},{"citationKey":"KERCKHOFFS_PRINCIPLE_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Kerckhoffs's principle","URL":"https://en.wikipedia.org/wiki/Kerckhoffs%27s_principle","YEAR":"2022"}},{"citationKey":"ROT13_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: ROT13","URL":"https://en.wikipedia.org/wiki/ROT13","YEAR":"2022"}},{"citationKey":"CC_PERMUTATION","entryType":"MISC","entryTags":{"TITLE":"Crypto Corner: Permutation Cipher","URL":"https://crypto.interactive-maths.com/permutation-cipher.html","YEAR":"2022"}},{"citationKey":"XOR_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: XOR cipher","URL":"https://en.wikipedia.org/wiki/XOR_cipher","YEAR":"2022"}},{"citationKey":"DES_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Data Encryption Standard","URL":"https://en.wikipedia.org/wiki/Data_Encryption_Standard","YEAR":"2022"}},{"citationKey":"AES_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Advanced Encryption Standard","URL":"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard","YEAR":"2022"}},{"citationKey":"BLOWFISH_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Blowfish (cipher)","URL":"https://en.wikipedia.org/wiki/Blowfish_(cipher)","YEAR":"2022"}},{"citationKey":"RSA_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: RSA (cryptosystem)","URL":"https://en.wikipedia.org/wiki/RSA_(cryptosystem)","YEAR":"2022"}},{"citationKey":"ECC_CRYPTO_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Elliptic-curve cryptography","URL":"https://en.wikipedia.org/wiki/Elliptic-curve_cryptography","YEAR":"2022"}}],"gitbook":"*"},"file":{"path":"contents/metropolis/metropolis.md","mtime":"2022-02-06T11:12:32.043Z","type":"markdown"},"gitbook":{"version":"3.7.1","time":"2022-02-06T11:13:01.519Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/node_modules/mathjax/MathJax.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

