
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Verlet Integration Â· Arcane Algorithm Archive</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.6.23">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../quantum_systems/quantum_systems.html" />
    
    
    <link rel="prev" href="../physics_solvers/physics_solvers.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/introduction.html">
            
                <a href="../introduction/introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how_to_contribute/how_to_contribute.html">
            
                <a href="../how_to_contribute/how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../code_reviews/code_reviewers.html">
            
                <a href="../code_reviews/code_reviewers.html">
            
                    
                    Code Reviewers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../plotting/plotting.html">
            
                <a href="../plotting/plotting.html">
            
                    
                    Plotting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../domain_coloring/domain_coloring.html">
            
                <a href="../domain_coloring/domain_coloring.html">
            
                    
                    Domain Coloring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../IFS/IFS.html">
            
                <a href="../IFS/IFS.html">
            
                    
                    Iterated Function Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../barnsley/barnsley.html">
            
                <a href="../barnsley/barnsley.html">
            
                    
                    The Barnsley Fern
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../data_structures/data_structures.html">
            
                <a href="../data_structures/data_structures.html">
            
                    
                    Data Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../stacks_and_queues/stacks_and_queues.html">
            
                <a href="../stacks_and_queues/stacks_and_queues.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../mathematical_background/mathematical_background.html">
            
                <a href="../mathematical_background/mathematical_background.html">
            
                    
                    Mathematical Background
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../notation/notation.html">
            
                <a href="../notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../affine_transformations/affine_transformations.html">
            
                <a href="../affine_transformations/affine_transformations.html">
            
                    
                    Affine Transformations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../bitlogic/bitlogic.html">
            
                <a href="../bitlogic/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../taylor_series_expansion/taylor_series_expansion.html">
            
                <a href="../taylor_series_expansion/taylor_series_expansion.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../convolutions/convolutions.html">
            
                <a href="../convolutions/convolutions.html">
            
                    
                    Convolutions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.5.1" data-path="../convolutions/1d/1d.html">
            
                <a href="../convolutions/1d/1d.html">
            
                    
                    Convolutions in 1D
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.2" data-path="../convolutions/multiplication/multiplication.html">
            
                <a href="../convolutions/multiplication/multiplication.html">
            
                    
                    Multiplication as a Convolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.3" data-path="../convolutions/2d/2d.html">
            
                <a href="../convolutions/2d/2d.html">
            
                    
                    Convolutions of Images (2D)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.4" data-path="../convolutions/convolutional_theorem/convolutional_theorem.html">
            
                <a href="../convolutions/convolutional_theorem/convolutional_theorem.html">
            
                    
                    Convolutional Theorem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../tree_traversal/tree_traversal.html">
            
                <a href="../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../euclidean_algorithm/euclidean_algorithm.html">
            
                <a href="../euclidean_algorithm/euclidean_algorithm.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../monte_carlo_integration/monte_carlo_integration.html">
            
                <a href="../monte_carlo_integration/monte_carlo_integration.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../matrix_methods/matrix_methods.html">
            
                <a href="../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../gaussian_elimination/gaussian_elimination.html">
            
                <a href="../gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../thomas_algorithm/thomas_algorithm.html">
            
                <a href="../thomas_algorithm/thomas_algorithm.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../computational_geometry/computational_geometry.html">
            
                <a href="../computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../gift_wrapping/gift_wrapping.html">
            
                <a href="../gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="../jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="../graham_scan/graham_scan.html">
            
                <a href="../graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../cooley_tukey/cooley_tukey.html">
            
                <a href="../cooley_tukey/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../decision_problems/decision_problems.html">
            
                <a href="../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../stable_marriage_problem/stable_marriage_problem.html">
            
                <a href="../stable_marriage_problem/stable_marriage_problem.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../physics_solvers/physics_solvers.html">
            
                <a href="../physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.14.1" data-path="verlet_integration.html">
            
                <a href="verlet_integration.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../quantum_systems/quantum_systems.html">
            
                <a href="../quantum_systems/quantum_systems.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.2.1" data-path="../split-operator_method/split-operator_method.html">
            
                <a href="../split-operator_method/split-operator_method.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../data_compression/data_compression.html">
            
                <a href="../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../huffman_encoding/huffman_encoding.html">
            
                <a href="../huffman_encoding/huffman_encoding.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../computer_graphics/computer_graphics.html">
            
                <a href="../computer_graphics/computer_graphics.html">
            
                    
                    Computer Graphics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../flood_fill/flood_fill.html">
            
                <a href="../flood_fill/flood_fill.html">
            
                    
                    Flood Fill
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../quantum_information/quantum_information.html">
            
                <a href="../quantum_information/quantum_information.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../computus/computus.html">
            
                <a href="../computus/computus.html">
            
                    
                    Computus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../approximate_counting/approximate_counting.html">
            
                <a href="../approximate_counting/approximate_counting.html">
            
                    
                    Approximate Counting Algorithm
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Verlet Integration</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="verlet-integration">Verlet Integration</h1>
<p>Verlet integration is essentially a solution to the kinematic equation for the motion of any object,</p>
<p><script type="math/tex; mode=display">
x = x_0 + v_0t + \frac{1}{2}at^2 + \frac{1}{6}bt^3 + \cdots
</script></p>
<p>where <script type="math/tex; ">x</script> is the position, <script type="math/tex; ">v</script> is the velocity, <script type="math/tex; ">a</script> is the acceleration, <script type="math/tex; ">b</script> is the often forgotten jerk term, and <script type="math/tex; ">t</script> is time. This equation is a central equation to almost every Newtonian physics solver and brings up a class of algorithms known as <em>force integrators</em>. One of the first force integrators to work with is <em>Verlet Integration</em>.</p>
<p>So, let&apos;s say we want to solve for the next timestep in <script type="math/tex; ">x</script>. To a close approximation (actually performing a Taylor Series Expansion about <script type="math/tex; ">x(t\pm \Delta t)</script>), that might look like this:</p>
<p><script type="math/tex; mode=display">
x(t+\Delta t) = x(t) + v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 + \frac{1}{6}b(t) \Delta t^3 + \mathcal{O}(\Delta t^4)
</script></p>
<p>This means that if we need to find the next <script type="math/tex; ">x</script>, we need the current <script type="math/tex; ">x</script>, <script type="math/tex; ">v</script>, <script type="math/tex; ">a</script>, etc. However, because few people calculate the jerk term, our error is typically <script type="math/tex; ">\mathcal{O}(\Delta t^3)</script>. That said, we can calculate <script type="math/tex; ">x</script> with less knowledge and higher accuracy if we play a trick! Let&apos;s say we want to calculate <script type="math/tex; ">x</script> of the <em>previous</em> timestep. Again, to a close approximation, that might look like this:</p>
<p><script type="math/tex; mode=display">
x(t-\Delta t) = x(t) - v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 - \frac{1}{6}b(t) \Delta t^3 + \mathcal{O}(\Delta t^4)
</script></p>
<p>Now, we have two equations to solve for two different timesteps in x, one of which we already have. If we add the two equations together and solve for <script type="math/tex; ">x(t+\Delta t)</script>, we find that</p>
<p><script type="math/tex; mode=display">
x(t+ \Delta t) = 2x(t) - x(t-\Delta t) + a(t)\Delta t^2 + \mathcal{O}(\Delta t^4)
</script></p>
<p>So, this means we can find our next <script type="math/tex; ">x</script> simply by knowing our current <script type="math/tex; ">x</script>, the <script type="math/tex; ">x</script> before that, and the acceleration! No velocity necessary! In addition, this drops the error to <script type="math/tex; ">\mathcal{O}(\Delta t^4)</script>, which is great!
Here is what it looks like in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">::</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token keyword">double</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">double</span> next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> next_pos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// Note that we are using a temp variable for the previous position</span>
  <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">;</span>
  prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> next_pos

    <span class="token keyword">return</span> time
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token keyword">type</span> <span class="token constant">Method</span> <span class="token operator">=</span> <span class="token constant">Model</span> <span class="token operator">-&gt;</span> <span class="token constant">Time</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span>

<span class="token hvariable">verlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">verlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x&apos;</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v&apos;</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token hvariable">a&apos;</span> <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prevPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tempPos<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    tempPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prevPos <span class="token operator">=</span> tempPos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function-definition function">verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">f64</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">let</span> temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    time
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre class="language-"><code class="lang-swift"><span class="token keyword">func</span> <span class="token function-definition function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Double</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">:</span> <span class="token class-name">Double</span>
    <span class="token keyword">var</span> prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> time
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="f90" data-name="Fortran90"><pre class="language-"><code class="lang-fortran"><span class="token keyword">SUBROUTINE</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos


    prev_pos <span class="token operator">=</span> pos
    time     <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time     <span class="token operator">=</span> time <span class="token operator">+</span> dt
            next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2d0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span>
            prev_pos <span class="token operator">=</span> pos
            pos      <span class="token operator">=</span> next_pos
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> verlet
</code></pre>
</div><div class="code-method-sample" data-lang="ruby" data-name="Ruby"><pre class="language-"><code class="lang-ruby"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prevPos <span class="token operator">:=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        nextPos <span class="token operator">:=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        prevPos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> nextPos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64"># <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
<span class="token label function">verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    verlet_return
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm1</span>                  # <span class="token register variable">xmm6</span> <span class="token operator">=</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm0</span>                  # Holds previous position
<span class="token label function">verlet_loop:</span>
  addsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm2</span>                  # Adding dt to time
  movsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm0</span>                  # Hold old value of posistion
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Calculating new position
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm4</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if position is greater then <span class="token number">0.0</span>
  ja     verlet_loop
<span class="token label function">verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm3</span>                  # Saving time value
  ret
</code></pre>
</div><div class="code-method-sample" data-lang="kotlin" data-name="Kotlin"><pre class="language-"><code class="lang-kotlin"><span class="token keyword">fun</span> <span class="token function">verlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> Double <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos  <span class="token comment">// Since function parameter are val and can&apos;t be modified</span>
    <span class="token keyword">var</span> prevPos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        <span class="token keyword">val</span> nextPos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prevPos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> nextPos
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> time
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="nim" data-name="Nim"><pre class="language-"><code class="lang-nim"><span class="token keyword">func</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> float <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    prevPos<span class="token operator">:</span> float <span class="token operator">=</span> pos
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    tempPos<span class="token operator">:</span> float

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    tempPos <span class="token operator">=</span> pos
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    prevPos <span class="token operator">=</span> tempPos

  time
</code></pre>
</div><div class="code-method-sample" data-lang="lisp" data-name="Common Lisp"><pre class="language-"><code class="lang-lisp"><span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">&quot;Integrates Newton&apos;s equation for motion while pos &gt; 0 using Verlet integration.&quot;</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    with prev-pos = pos
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> pos <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">;; The starting speed is assumed to be zero.</span>
    do <span class="token punctuation">(</span><span class="token car">psetf</span>
         pos <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> pos <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">-</span> prev-pos<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
         prev-pos pos<span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>

<p>Now, obviously this poses a problem; what if we want to calculate a term that requires velocity, like the kinetic energy, <script type="math/tex; ">\frac{1}{2}mv^2</script>? In this case, we certainly cannot get rid of the velocity! Well, we can find the velocity to <script type="math/tex; ">\mathcal{O}(\Delta t^2)</script> accuracy by using the Stormer-Verlet method, which is the same as before, but we calculate velocity like so</p>
<p><script type="math/tex; mode=display">
v(t) = \frac{x(t+\Delta t) - x(t-\Delta t)}{2\Delta t} + \mathcal{O}(\Delta t^2)
</script></p>
<p>Note that the 2 in the denominator appears because we are going over 2 timesteps. It&apos;s essentially solving <script type="math/tex; ">v=\frac{\Delta x}{\Delta t}</script>. In addition, we can calculate the velocity of the next timestep like so</p>
<p><script type="math/tex; mode=display">
v(t+\Delta t) = \frac{x(t+\Delta t) - x(t)}{\Delta t} + \mathcal{O}(\Delta t)
</script></p>
<p>However, the error for this is <script type="math/tex; ">\mathcal{O}(\Delta t)</script>, which is quite poor, but it gets the job done in a pinch.  Here&apos;s what it looks like in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">::</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        <span class="token comment"># Because acceleration is constant, velocity is straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp">timestep <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">double</span> next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> next_pos<span class="token punctuation">;</span>

    <span class="token comment">// The acceleration is constant, so the velocity is</span>
    <span class="token comment">// straightforward</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> timestep <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>vel<span class="token punctuation">,</span>
                    <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token operator">*</span>vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token operator">*</span>vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token class-name">VerletValues</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// Note that we are using a temp variable for the previous position</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token comment">// The acceleration is constant, so the velocity is straightforward</span>
         vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

   <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> next_pos
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">stormerVerlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">stormerVerlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x&apos;</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v&apos;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span> <span class="token operator">-</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">dt</span>
    <span class="token hvariable">a&apos;</span> <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prevPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tempPos<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    tempPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prevPos <span class="token operator">=</span> tempPos<span class="token punctuation">;</span>

    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function-definition function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">let</span> temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token comment">// Because acceleration is constant, velocity is</span>
        <span class="token comment">// straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre class="language-"><code class="lang-swift"><span class="token keyword">func</span> <span class="token function-definition function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token class-name">Double</span>
    <span class="token keyword">var</span> prev_pos <span class="token operator">=</span> pos
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="f90" data-name="Fortran90"><pre class="language-"><code class="lang-fortran"><span class="token keyword">SUBROUTINE</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos

    prev_pos <span class="token operator">=</span> pos 
    time     <span class="token operator">=</span> <span class="token number">0d0</span>
    vel      <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time     <span class="token operator">=</span> time <span class="token operator">+</span> dt
            next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span>
            prev_pos <span class="token operator">=</span> pos
            pos      <span class="token operator">=</span> next_pos
            vel      <span class="token operator">=</span> vel <span class="token operator">+</span> acc <span class="token operator">*</span> dt
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> stormer_verlet
</code></pre>
</div><div class="code-method-sample" data-lang="ruby" data-name="Ruby"><pre class="language-"><code class="lang-ruby"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">stormer_verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    prev_pos <span class="token operator">=</span> pos
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prevPos <span class="token operator">:=</span> pos
    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
        nextPos <span class="token operator">:=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        prevPos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> nextPos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64"># <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
# RET <span class="token register variable">xmm1</span> <span class="token operator">-</span> velocity
<span class="token label function">stormer_verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    stormer_verlet_return
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm1</span>                  # <span class="token register variable">xmm6</span> <span class="token operator">=</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm0</span>                  # Holds previous position
<span class="token label function">stormer_verlet_loop:</span>
  addsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm2</span>                  # Adding dt to time
  movsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm0</span>                  # Hold old value of posistion
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Calculating new position
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm4</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if position is greater then <span class="token number">0.0</span>
  ja     stormer_verlet_loop
<span class="token label function">stormer_verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm3</span>                  # Saving time and velocity
  mulsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  movsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  ret
</code></pre>
</div><div class="code-method-sample" data-lang="kotlin" data-name="Kotlin"><pre class="language-"><code class="lang-kotlin"><span class="token keyword">fun</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> VerletValues <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos
    <span class="token keyword">var</span> prevPos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">var</span> vel <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        <span class="token keyword">val</span> nextPos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prevPos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> nextPos
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="nim" data-name="Nim"><pre class="language-"><code class="lang-nim"><span class="token keyword">func</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    prevPos<span class="token operator">:</span> float <span class="token operator">=</span> pos
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    vel<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    tempPos<span class="token operator">:</span> float

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    tempPos <span class="token operator">=</span> pos
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    prevPos <span class="token operator">=</span> tempPos

    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> <span class="token function">dt</span>

  <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="lisp" data-name="Common Lisp"><pre class="language-"><code class="lang-lisp"><span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">stormer-verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">&quot;Integrates Newton&apos;s equation for motion while pos &gt; 0 using the Stormer-Verlet method.&quot;</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    with prev-pos = pos
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    for vel = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> vel <span class="token punctuation">(</span><span class="token car">*</span> acc dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> pos <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">;; Variables are changed simultaneously by &apos;psetf&apos;, so there&apos;s no need for a temporary variable.</span>
    do <span class="token punctuation">(</span><span class="token car">psetf</span>
         pos <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> pos <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">-</span> prev-pos<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
         prev-pos pos<span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token car">list</span> time vel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>


<p>Now, let&apos;s say we actually need the velocity to calculate out next timestep. Well, in this case, we simply cannot use the above approximation and instead need to use the <em>Velocity Verlet</em> algorithm.</p>
<h1 id="velocity-verlet">Velocity Verlet</h1>
<p>In some ways, this algorithm is even simpler than above. We can calculate everything like</p>
<p><script type="math/tex; mode=display">
\begin{align}
x(t+\Delta t) &=x(t) + v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 \\
a(t+\Delta t) &= f(x(t+\Delta t)) \\
v(t+\Delta t) &= v(t) + \frac{1}{2}(a(t) + a(t+\Delta t))\Delta t
\end{align}
</script></p>
<p>which is literally the kinematic equation above, solving for <script type="math/tex; ">x</script>, <script type="math/tex; ">v</script>, and <script type="math/tex; ">a</script> every timestep. You can also split up the equations like so</p>
<p><script type="math/tex; mode=display">
\begin{align}
v(t+\frac{1}{2}\Delta t) &= v(t) + \frac{1}{2}a(t)\Delta t \\
x(t+\Delta t) &=x(t) + v(t+\frac{1}{2}\Delta t)\Delta t \\
a(t+\Delta t) &= f(x(t+\Delta t)) \\
v(t+\Delta t) &= v(t+\frac{1}{2}\Delta t) + \frac{1}{2}a(t+\Delta t)\Delta t
\end{align}
</script></p>
<p>Here is the velocity Verlet method in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">::</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp">timestep <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> timestep <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>vel<span class="token punctuation">,</span>
                     <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">*</span>vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>vel<span class="token punctuation">)</span> <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        <span class="token operator">*</span>vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token class-name">VerletValues</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// Note that we are using a temp variable for the previous position</span>
    <span class="token keyword">double</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>
    vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">velocityVerlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">velocityVerlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">aOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">v</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x&apos;</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v&apos;</span> <span class="token operator">=</span> <span class="token hvariable">v</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">aOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">dt</span>
    <span class="token hvariable">a&apos;</span> <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function-definition function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre class="language-"><code class="lang-swift"><span class="token keyword">func</span> <span class="token function-definition function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">:</span> <span class="token class-name">Double</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="f90" data-name="Fortran90"><pre class="language-"><code class="lang-fortran"><span class="token keyword">SUBROUTINE</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel

    time     <span class="token operator">=</span> <span class="token number">0d0</span>
    vel      <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time <span class="token operator">=</span> time <span class="token operator">+</span> dt
            pos  <span class="token operator">=</span> pos <span class="token operator">+</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5d0</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span> 
            vel  <span class="token operator">=</span> vel <span class="token operator">+</span> acc <span class="token operator">*</span> dt
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> velocity_verlet
</code></pre>
</div><div class="code-method-sample" data-lang="ruby" data-name="Ruby"><pre class="language-"><code class="lang-ruby"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">velocity_verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        pos <span class="token operator">+</span><span class="token operator">=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">.5</span><span class="token operator">*</span>acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64"># <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
# RET <span class="token register variable">xmm1</span> <span class="token operator">-</span> velocity
<span class="token label function">velocity_verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds the velocity value
  pxor   <span class="token register variable">xmm4</span>, <span class="token register variable">xmm4</span>                  # Holds the time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    velocity_verlet_return
  movsd  <span class="token register variable">xmm5</span>, half                  # <span class="token register variable">xmm5</span> <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> dt <span class="token operator">*</span> dt <span class="token operator">*</span> acc
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm1</span>
<span class="token label function">velocity_verlet_loop:</span>
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm3</span>                  # Move velocity into register
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>                  # Calculate new position
  addsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  addsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm2</span>                  # Incrementing time
  movsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm4</span>                  # Updating velocity
  mulsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>
  ja     velocity_verlet_loop
<span class="token label function">velocity_verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm4</span>                  # Saving time and velocity
  movsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  ret
</code></pre>
</div><div class="code-method-sample" data-lang="kotlin" data-name="Kotlin"><pre class="language-"><code class="lang-kotlin"><span class="token keyword">fun</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> VerletValues <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">var</span> vel <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="nim" data-name="Nim"><pre class="language-"><code class="lang-nim"><span class="token keyword">func</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    vel<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> <span class="token function">dt</span>

  <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="lisp" data-name="Common Lisp"><pre class="language-"><code class="lang-lisp"><span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">velocity-verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">&quot;Integrates Newton&apos;s equation for motion while pos &gt; 0 using the velocity in calculations.&quot;</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    for vel = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> vel <span class="token punctuation">(</span><span class="token car">*</span> acc dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    for p = pos then <span class="token punctuation">(</span><span class="token car">incf</span> p <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> vel dt<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> <span class="token number">0.5</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> p <span class="token number">0</span><span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token car">list</span> time vel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>

<p>Even though this method is more widely used than the simple Verlet method mentioned above, it unforunately has an error term of <script type="math/tex; ">\mathcal{O}(\Delta t^2)</script>, which is two orders of magnitude worse. That said, if you want to have a simulaton with many objects that depend on one another --- like a gravity simulation --- the Velocity Verlet algorithm is a handy choice; however, you may have to play further tricks to allow everything to scale appropriately. These types of simulatons are sometimes called <em>n-body</em> simulations and one such trick is the Barnes-Hut algorithm, which cuts the complexity of n-body simulations from <script type="math/tex; ">\sim \mathcal{O}(n^2)</script> to <script type="math/tex; ">\sim \mathcal{O}(n\log(n))</script>.</p>
<h2 id="video-explanation">Video Explanation</h2>
<p>Here is a video describing Verlet integration:</p>
<div style="text-align:center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/g55QvpAev0I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

<h2 id="example-code">Example Code</h2>
<p>Both of these methods work simply by iterating timestep-by-timestep and can be written straightforwardly in any language. For reference, here are snippets of code that use both the classic and velocity Verlet methods to find the time it takes for a ball to hit the ground after being dropped from a given height.</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">::</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time
<span class="token keyword">end</span>

<span class="token keyword">function</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">::</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        <span class="token comment"># Because acceleration is constant, velocity is straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>

<span class="token keyword">function</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">::</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">::</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>

<span class="token keyword">function</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time <span class="token operator">=</span> verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;$(time)&quot;</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> stormer_verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;$(time)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;$(vel)&quot;</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> velocity_verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;$(time)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;$(vel)&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">end</span>

main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iomanip&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">timestep</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> time<span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">double</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">double</span> next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> next_pos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

timestep <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">double</span> next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> next_pos<span class="token punctuation">;</span>

    <span class="token comment">// The acceleration is constant, so the velocity is</span>
    <span class="token comment">// straightforward</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> timestep <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

timestep <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> timestep <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>fixed <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setprecision</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Note that depending on the simulation, you might want to have the</span>
  <span class="token comment">// Verlet loop outside.</span>

  <span class="token comment">// For example, if your acceleration chages as a function of time,</span>
  <span class="token comment">// you might need to also change the acceleration to be read into</span>
  <span class="token comment">// each of these functions.</span>

  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;[#]\nTime for Verlet integration is:\n&quot;</span> \
            <span class="token operator">&lt;&lt;</span> time <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

  timestep timestep_sv <span class="token operator">=</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:\n&quot;</span> \
            <span class="token operator">&lt;&lt;</span> timestep_sv<span class="token punctuation">.</span>time <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:\n&quot;</span> \
            <span class="token operator">&lt;&lt;</span> timestep_sv<span class="token punctuation">.</span>vel <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

  timestep timestep_vv <span class="token operator">=</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;[#]\nTime for velocity Verlet integration is:\n&quot;</span> \
            <span class="token operator">&lt;&lt;</span> timestep_vv<span class="token punctuation">.</span>time <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:\n&quot;</span> \
            <span class="token operator">&lt;&lt;</span> timestep_vv<span class="token punctuation">.</span>vel <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>vel<span class="token punctuation">,</span>
                    <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token operator">*</span>vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token operator">*</span>vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>vel<span class="token punctuation">,</span>
                     <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">*</span>vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>vel<span class="token punctuation">)</span> <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        <span class="token operator">*</span>vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>

    <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>time<span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Verlet integration is:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lf\n&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>time<span class="token punctuation">,</span> <span class="token operator">&amp;</span>vel<span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lf\n&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lf\n&quot;</span><span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>time<span class="token punctuation">,</span> <span class="token operator">&amp;</span>vel<span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for velocity Verlet integration is:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lf\n&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lf\n&quot;</span><span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Verlet</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">VerletValues</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> time<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> vel<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span><span class="token keyword">double</span> time<span class="token punctuation">,</span> <span class="token keyword">double</span> vel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>time <span class="token operator">=</span> time<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>vel <span class="token operator">=</span> vel<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token comment">// Note that we are using a temp variable for the previous position</span>
      <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">;</span>
      prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
      time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

      <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
            temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
            pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
            prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> time<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">VerletValues</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// Note that we are using a temp variable for the previous position</span>
        <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
            temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
            pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
            prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

            <span class="token comment">// The acceleration is constant, so the velocity is straightforward</span>
             vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">VerletValues</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// Note that we are using a temp variable for the previous position</span>
        <span class="token keyword">double</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>
        vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
            pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
            vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">double</span> verletTime <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>verletTime<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">VerletValues</span> stormerVerlet <span class="token operator">=</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stormerVerlet<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stormerVerlet<span class="token punctuation">.</span>vel<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">VerletValues</span> velocityVerlet <span class="token operator">=</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>velocityVerlet<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>velocityVerlet<span class="token punctuation">.</span>vel<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> next_pos

    <span class="token keyword">return</span> time

<span class="token keyword">def</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> next_pos
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel

<span class="token keyword">def</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> verlet<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{:.10f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> stormer_verlet<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{:.10f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{:.10f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>vel<span class="token punctuation">)</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> velocity_verlet<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{:.10f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{:.10f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>vel<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&apos;__main__&apos;</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token comment">-- submitted by Jie</span>
<span class="token keyword">type</span> <span class="token constant">Time</span> <span class="token operator">=</span> <span class="token constant">Double</span>

<span class="token keyword">type</span> <span class="token constant">Position</span> <span class="token operator">=</span> <span class="token constant">Double</span>

<span class="token keyword">type</span> <span class="token constant">Speed</span> <span class="token operator">=</span> <span class="token constant">Double</span>

<span class="token keyword">type</span> <span class="token constant">Acceleration</span> <span class="token operator">=</span> <span class="token constant">Double</span>

<span class="token keyword">type</span> <span class="token constant">Particle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">Position</span><span class="token punctuation">,</span> <span class="token constant">Speed</span><span class="token punctuation">,</span> <span class="token constant">Acceleration</span><span class="token punctuation">,</span> <span class="token constant">Time</span><span class="token punctuation">)</span>

<span class="token keyword">type</span> <span class="token constant">Model</span> <span class="token operator">=</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Acceleration</span>

<span class="token keyword">type</span> <span class="token constant">Method</span> <span class="token operator">=</span> <span class="token constant">Model</span> <span class="token operator">-&gt;</span> <span class="token constant">Time</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span>

<span class="token hvariable">verlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">verlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x&apos;</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v&apos;</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token hvariable">a&apos;</span> <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>

<span class="token hvariable">stormerVerlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">stormerVerlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x&apos;</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v&apos;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span> <span class="token operator">-</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">dt</span>
    <span class="token hvariable">a&apos;</span> <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>

<span class="token hvariable">velocityVerlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">velocityVerlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">aOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">v</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x&apos;</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v&apos;</span> <span class="token operator">=</span> <span class="token hvariable">v</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">aOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">dt</span>
    <span class="token hvariable">a&apos;</span> <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>

<span class="token hvariable">trajectory</span> <span class="token operator">::</span> <span class="token constant">Method</span> <span class="token operator">-&gt;</span> <span class="token constant">Model</span> <span class="token operator">-&gt;</span> <span class="token constant">Time</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">Particle</span><span class="token punctuation">]</span>
<span class="token hvariable">trajectory</span> <span class="token hvariable">method</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token hvariable">p0</span><span class="token operator">@</span><span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">v</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">traj</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">traj</span> <span class="token operator">=</span> <span class="token hvariable">p0</span> <span class="token operator">:</span> <span class="token hvariable">p1</span> <span class="token operator">:</span> <span class="token builtin">zipWith</span> <span class="token punctuation">(</span><span class="token hvariable">method</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span> <span class="token hvariable">traj</span> <span class="token punctuation">(</span><span class="token builtin">tail</span> <span class="token hvariable">traj</span><span class="token punctuation">)</span>
    <span class="token hvariable">p1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">v&apos;</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t0</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">t0</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
    <span class="token hvariable">x&apos;</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token hvariable">v</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v&apos;</span> <span class="token operator">=</span> <span class="token hvariable">v</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span>

<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token keyword">let</span> <span class="token hvariable">p0</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token hvariable">dt</span> <span class="token operator">=</span> <span class="token number">0.001</span>
      <span class="token hvariable">freefall</span> <span class="token hvariable">_</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10</span>
      <span class="token hvariable">aboveGround</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
      <span class="token hvariable">timeVelocity</span> <span class="token hvariable">m</span> <span class="token operator">=</span>
        <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">v</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token builtin">last</span> <span class="token operator">$</span> <span class="token builtin">takeWhile</span> <span class="token hvariable">aboveGround</span> <span class="token operator">$</span> <span class="token hvariable">trajectory</span> <span class="token hvariable">m</span> <span class="token hvariable">freefall</span> <span class="token hvariable">dt</span> <span class="token hvariable">p0</span>
         <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token builtin">show</span> <span class="token hvariable">t</span><span class="token punctuation">,</span> <span class="token builtin">show</span> <span class="token hvariable">v</span><span class="token punctuation">)</span>

  <span class="token builtin">putStrLn</span> <span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token builtin">fst</span> <span class="token operator">$</span> <span class="token hvariable">timeVelocity</span> <span class="token hvariable">verlet</span>
  <span class="token builtin">putStrLn</span> <span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token builtin">fst</span> <span class="token operator">$</span> <span class="token hvariable">timeVelocity</span> <span class="token hvariable">stormerVerlet</span>
  <span class="token builtin">putStrLn</span> <span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token builtin">snd</span> <span class="token operator">$</span> <span class="token hvariable">timeVelocity</span> <span class="token hvariable">stormerVerlet</span>
  <span class="token builtin">putStrLn</span> <span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token builtin">fst</span> <span class="token operator">$</span> <span class="token hvariable">timeVelocity</span> <span class="token hvariable">velocityVerlet</span>
  <span class="token builtin">putStrLn</span> <span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token builtin">snd</span> <span class="token operator">$</span> <span class="token hvariable">timeVelocity</span> <span class="token hvariable">velocityVerlet</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prevPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tempPos<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    tempPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prevPos <span class="token operator">=</span> tempPos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prevPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tempPos<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    tempPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prevPos <span class="token operator">=</span> tempPos<span class="token punctuation">;</span>

    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[#]\nTime for Verlet integration is:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> stormer <span class="token operator">=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[#]\nTime for Stormer Verlet integration is:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stormer<span class="token punctuation">.</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[#]\nVelocity for Stormer Verlet integration is:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stormer<span class="token punctuation">.</span>vel<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> velocity <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[#]\nTime for velocity Verlet integration is:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>velocity<span class="token punctuation">.</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[#]\nVelocity for velocity Verlet integration is:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>velocity<span class="token punctuation">.</span>vel<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function-definition function">verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">f64</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">let</span> temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    time
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">let</span> temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token comment">// Because acceleration is constant, velocity is</span>
        <span class="token comment">// straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> time_v <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>time_sv<span class="token punctuation">,</span> vel_sv<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>time_vv<span class="token punctuation">,</span> vel_vv<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> time_v<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> time_sv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> vel_sv<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> time_vv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> vel_vv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="swift" data-name="Swift"><pre class="language-"><code class="lang-swift"><span class="token keyword">func</span> <span class="token function-definition function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Double</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">:</span> <span class="token class-name">Double</span>
    <span class="token keyword">var</span> prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> time
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function-definition function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token class-name">Double</span>
    <span class="token keyword">var</span> prev_pos <span class="token operator">=</span> pos
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function-definition function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">:</span> <span class="token class-name">Double</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> verletTime <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">verletTime</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> stormer <span class="token operator">=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">stormer<span class="token punctuation">.</span>time</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">stormer<span class="token punctuation">.</span>vel</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> velVerlet <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">velVerlet<span class="token punctuation">.</span>time</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">velVerlet<span class="token punctuation">.</span>vel</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="f90" data-name="Fortran90"><pre class="language-"><code class="lang-fortran"><span class="token keyword">SUBROUTINE</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos


    prev_pos <span class="token operator">=</span> pos
    time     <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time     <span class="token operator">=</span> time <span class="token operator">+</span> dt
            next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2d0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span>
            prev_pos <span class="token operator">=</span> pos
            pos      <span class="token operator">=</span> next_pos
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> verlet

<span class="token keyword">SUBROUTINE</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos

    prev_pos <span class="token operator">=</span> pos 
    time     <span class="token operator">=</span> <span class="token number">0d0</span>
    vel      <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time     <span class="token operator">=</span> time <span class="token operator">+</span> dt
            next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span>
            prev_pos <span class="token operator">=</span> pos
            pos      <span class="token operator">=</span> next_pos
            vel      <span class="token operator">=</span> vel <span class="token operator">+</span> acc <span class="token operator">*</span> dt
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> stormer_verlet 

<span class="token keyword">SUBROUTINE</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel

    time     <span class="token operator">=</span> <span class="token number">0d0</span>
    vel      <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time <span class="token operator">=</span> time <span class="token operator">+</span> dt
            pos  <span class="token operator">=</span> pos <span class="token operator">+</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5d0</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span> 
            vel  <span class="token operator">=</span> vel <span class="token operator">+</span> acc <span class="token operator">*</span> dt
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> velocity_verlet 

<span class="token keyword">PROGRAM</span> verlet_integration

    <span class="token keyword">IMPLICIT NONE</span> 
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span>acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel

    <span class="token keyword">INTERFACE</span>
        <span class="token keyword">SUBROUTINE</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
        <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time
        <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos
        <span class="token keyword">END SUBROUTINE</span>
    <span class="token keyword">END INTERFACE</span> 

    <span class="token keyword">INTERFACE</span> 
        <span class="token keyword">SUBROUTINE</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
            <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel
            <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos
        <span class="token keyword">END SUBROUTINE</span> 
    <span class="token keyword">END INTERFACE</span> 

    <span class="token keyword">INTERFACE</span> 
        <span class="token keyword">SUBROUTINE</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
            <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel
            <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos 
        <span class="token keyword">END SUBROUTINE</span> 
    <span class="token keyword">END INTERFACE</span> 

    pos <span class="token operator">=</span> <span class="token number">5d0</span>
    acc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10d0</span>
    dt  <span class="token operator">=</span> <span class="token number">0.01d0</span>
    <span class="token comment">! Verlet </span>
    <span class="token keyword">CALL</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">)</span>

    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;[#]&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;Time for Verlet integration:&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> time 

    <span class="token comment">! stormer Verlet </span>
    pos <span class="token operator">=</span> <span class="token number">5d0</span>
    <span class="token keyword">CALL</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>

    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;[#]&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;Time for Stormer Verlet integration:&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> time
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;[#]&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;Velocity for Stormer Verlet integration:&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> vel



    <span class="token comment">! Velocity Verlet</span>
    pos <span class="token operator">=</span> <span class="token number">5d0</span>
    <span class="token keyword">CALL</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>

    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;[#]&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;Time for velocity Verlet integration:&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> time
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;[#]&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&apos;Velocity for velocity Verlet integration:&apos;</span>
    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> vel

<span class="token keyword">END PROGRAM</span> verlet_integration
</code></pre>
</div><div class="code-method-sample" data-lang="ruby" data-name="Ruby"><pre class="language-"><code class="lang-ruby"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time

<span class="token keyword">end</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">stormer_verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    prev_pos <span class="token operator">=</span> pos
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel

<span class="token keyword">end</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">velocity_verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        pos <span class="token operator">+</span><span class="token operator">=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel

<span class="token keyword">end</span>

puts <span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span>
p verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>

time<span class="token punctuation">,</span> vel <span class="token operator">=</span> stormer_verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
puts <span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span>
p time
puts <span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span>
p vel

time<span class="token punctuation">,</span> vel <span class="token operator">=</span> velocity_verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
puts <span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span>
p time
puts <span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span>
p vel
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prevPos <span class="token operator">:=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        nextPos <span class="token operator">:=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        prevPos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> nextPos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prevPos <span class="token operator">:=</span> pos
    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
        nextPos <span class="token operator">:=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        prevPos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> nextPos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">.5</span><span class="token operator">*</span>acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">:=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token number">.01</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">:=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token number">5.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token number">.01</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>vel<span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token number">5.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token number">.01</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64">.intel_syntax noprefix

.section .rodata
  <span class="token label function">zero:</span>          .double <span class="token number">0.0</span>
  <span class="token label function">two:</span>           .double <span class="token number">2.0</span>
  <span class="token label function">half:</span>          .double <span class="token number">0.5</span>
  <span class="token label function">verlet_fmt:</span>    .string <span class="token string">&quot;[#]\nTime for Verlet integration is:\n%lf\n&quot;</span>
  <span class="token label function">stormer_fmt:</span>   .string <span class="token string">&quot;[#]\nTime for Stormer Verlet Integration is:\n%lf\n[#]\nVelocity for Stormer Verlet Integration is:\n%lf\n&quot;</span>
  <span class="token label function">velocity_fmt:</span>  .string <span class="token string">&quot;[#]\nTime for Velocity Verlet Integration is:\n%lf\n[#]\nVelocity for Velocity Verlet Integration is:\n%lf\n&quot;</span>
  <span class="token label function">pos:</span>           .double <span class="token number">5.0</span>
  <span class="token label function">acc:</span>           .double <span class="token operator">-</span><span class="token number">10.0</span>
  <span class="token label function">dt:</span>            .double <span class="token number">0.01</span>

.section .text
  .<span class="token keyword">global main</span>
  .<span class="token keyword">extern printf</span>

# <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
<span class="token label function">verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    verlet_return
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm1</span>                  # <span class="token register variable">xmm6</span> <span class="token operator">=</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm0</span>                  # Holds previous position
<span class="token label function">verlet_loop:</span>
  addsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm2</span>                  # Adding dt to time
  movsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm0</span>                  # Hold old value of posistion
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Calculating new position
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm4</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if position is greater then <span class="token number">0.0</span>
  ja     verlet_loop
<span class="token label function">verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm3</span>                  # Saving time value
  ret

# <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
# RET <span class="token register variable">xmm1</span> <span class="token operator">-</span> velocity
<span class="token label function">stormer_verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    stormer_verlet_return
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm1</span>                  # <span class="token register variable">xmm6</span> <span class="token operator">=</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm0</span>                  # Holds previous position
<span class="token label function">stormer_verlet_loop:</span>
  addsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm2</span>                  # Adding dt to time
  movsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm0</span>                  # Hold old value of posistion
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Calculating new position
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm4</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if position is greater then <span class="token number">0.0</span>
  ja     stormer_verlet_loop
<span class="token label function">stormer_verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm3</span>                  # Saving time and velocity
  mulsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  movsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  ret

# <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
# RET <span class="token register variable">xmm1</span> <span class="token operator">-</span> velocity
<span class="token label function">velocity_verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds the velocity value
  pxor   <span class="token register variable">xmm4</span>, <span class="token register variable">xmm4</span>                  # Holds the time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    velocity_verlet_return
  movsd  <span class="token register variable">xmm5</span>, half                  # <span class="token register variable">xmm5</span> <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> dt <span class="token operator">*</span> dt <span class="token operator">*</span> acc
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm1</span>
<span class="token label function">velocity_verlet_loop:</span>
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm3</span>                  # Move velocity into register
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>                  # Calculate new position
  addsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  addsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm2</span>                  # Incrementing time
  movsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm4</span>                  # Updating velocity
  mulsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>
  ja     velocity_verlet_loop
<span class="token label function">velocity_verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm4</span>                  # Saving time and velocity
  movsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  ret

<span class="token label function">main:</span>
  push   <span class="token register variable">rbp</span>
  movsd  <span class="token register variable">xmm0</span>, pos                   # Calling verlet
  movsd  <span class="token register variable">xmm1</span>, acc
  movsd  <span class="token register variable">xmm2</span>, dt
  call   verlet
  mov    <span class="token register variable">rdi</span>, OFFSET verlet_fmt      # Print output
  mov    <span class="token register variable">rax</span>, <span class="token number">1</span>
  call   printf
  movsd  <span class="token register variable">xmm0</span>, pos                   # Calling stormer_verlet
  movsd  <span class="token register variable">xmm1</span>, acc
  movsd  <span class="token register variable">xmm2</span>, dt
  call   stormer_verlet
  mov    <span class="token register variable">rdi</span>, OFFSET stormer_fmt     # Print output
  mov    <span class="token register variable">rax</span>, <span class="token number">1</span>
  call   printf
  movsd  <span class="token register variable">xmm0</span>, pos                   # Calling velocity_verlet
  movsd  <span class="token register variable">xmm1</span>, acc
  movsd  <span class="token register variable">xmm2</span>, dt
  call   velocity_verlet
  mov    <span class="token register variable">rdi</span>, OFFSET velocity_fmt    # Print output
  mov    <span class="token register variable">rax</span>, <span class="token number">1</span>
  call   printf
  pop    <span class="token register variable">rbp</span>
  xor    <span class="token register variable">rax</span>, <span class="token register variable">rax</span>                      # Set exit code to <span class="token number">0</span>
  ret
</code></pre>
</div><div class="code-method-sample" data-lang="kotlin" data-name="Kotlin"><pre class="language-"><code class="lang-kotlin"><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span><span class="token keyword">val</span> time<span class="token operator">:</span> Double<span class="token punctuation">,</span> <span class="token keyword">val</span> vel<span class="token operator">:</span> Double<span class="token punctuation">)</span>

<span class="token keyword">fun</span> <span class="token function">verlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> Double <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos  <span class="token comment">// Since function parameter are val and can&apos;t be modified</span>
    <span class="token keyword">var</span> prevPos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        <span class="token keyword">val</span> nextPos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prevPos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> nextPos
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> time
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> VerletValues <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos
    <span class="token keyword">var</span> prevPos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">var</span> vel <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        <span class="token keyword">val</span> nextPos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prevPos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> nextPos
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> VerletValues <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">var</span> vel <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> verletTime <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;<span class="token interpolation variable">$verletTime</span>&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">val</span> stormerVerlet <span class="token operator">=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;<span class="token interpolation"><span class="token delimiter variable">${</span>stormerVerlet<span class="token punctuation">.</span>time<span class="token delimiter variable">}</span></span>&quot;</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;<span class="token interpolation"><span class="token delimiter variable">${</span>stormerVerlet<span class="token punctuation">.</span>vel<span class="token delimiter variable">}</span></span>&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">val</span> velocityVerlet <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nTime for Velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;<span class="token interpolation"><span class="token delimiter variable">${</span>velocityVerlet<span class="token punctuation">.</span>time<span class="token delimiter variable">}</span></span>&quot;</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[#]\nVelocity for Velocity Verlet integration is:&quot;</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;<span class="token interpolation"><span class="token delimiter variable">${</span>velocityVerlet<span class="token punctuation">.</span>vel<span class="token delimiter variable">}</span></span>&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="nim" data-name="Nim"><pre class="language-"><code class="lang-nim"><span class="token keyword">func</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> float <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    prevPos<span class="token operator">:</span> float <span class="token operator">=</span> pos
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    tempPos<span class="token operator">:</span> float

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    tempPos <span class="token operator">=</span> pos
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    prevPos <span class="token operator">=</span> tempPos

  time

<span class="token keyword">func</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    prevPos<span class="token operator">:</span> float <span class="token operator">=</span> pos
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    vel<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    tempPos<span class="token operator">:</span> float

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    tempPos <span class="token operator">=</span> pos
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    prevPos <span class="token operator">=</span> tempPos

    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> <span class="token function">dt</span>

  <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    vel<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> <span class="token function">dt</span>

  <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>

<span class="token keyword">when</span> isMainModule<span class="token operator">:</span>
  <span class="token keyword">let</span> timeV <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
  echo <span class="token string">&quot;[#]\nTime for Verlet integration is:&quot;</span>
  echo timeV

  <span class="token keyword">let</span> <span class="token punctuation">(</span>timeSV<span class="token punctuation">,</span> velSV<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
  echo <span class="token string">&quot;[#]\nTime for Stormer Verlet integration is:&quot;</span>
  echo timeSV
  echo <span class="token string">&quot;[#]\nVelocity for Stormer Verlet integration is:&quot;</span>
  echo velSV

  <span class="token keyword">let</span> <span class="token punctuation">(</span>timeVV<span class="token punctuation">,</span> velVV<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
  echo <span class="token string">&quot;[#]\nTime for velocity Verlet integration is:&quot;</span>
  echo timeVV
  echo <span class="token string">&quot;[#]\nVelocity for velocity Verlet integration is:&quot;</span>
  echo velVV
</code></pre>
</div><div class="code-method-sample" data-lang="lisp" data-name="Common Lisp"><pre class="language-"><code class="lang-lisp"><span class="token heading comment title">;;;; Verlet integration implementation in Common Lisp</span>

<span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">&quot;Integrates Newton&apos;s equation for motion while pos &gt; 0 using Verlet integration.&quot;</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    with prev-pos = pos
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> pos <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">;; The starting speed is assumed to be zero.</span>
    do <span class="token punctuation">(</span><span class="token car">psetf</span>
         pos <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> pos <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">-</span> prev-pos<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
         prev-pos pos<span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">stormer-verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">&quot;Integrates Newton&apos;s equation for motion while pos &gt; 0 using the Stormer-Verlet method.&quot;</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    with prev-pos = pos
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    for vel = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> vel <span class="token punctuation">(</span><span class="token car">*</span> acc dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> pos <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">;; Variables are changed simultaneously by &apos;psetf&apos;, so there&apos;s no need for a temporary variable.</span>
    do <span class="token punctuation">(</span><span class="token car">psetf</span>
         pos <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> pos <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">-</span> prev-pos<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
         prev-pos pos<span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token car">list</span> time vel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">velocity-verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">&quot;Integrates Newton&apos;s equation for motion while pos &gt; 0 using the velocity in calculations.&quot;</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    for vel = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> vel <span class="token punctuation">(</span><span class="token car">*</span> acc dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    for p = pos then <span class="token punctuation">(</span><span class="token car">incf</span> p <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> vel dt<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> <span class="token number">0.5</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> p <span class="token number">0</span><span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token car">list</span> time vel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;[#]~%Time for Verlet integration:~%&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;~d~%&quot;</span> <span class="token punctuation">(</span><span class="token car">verlet</span> <span class="token number">5</span> <span class="token number">-10</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token defvar"><span class="token keyword">defvar</span> <span class="token variable">stormer-verlet-result</span></span> <span class="token punctuation">(</span><span class="token car">stormer-verlet</span> <span class="token number">5</span> <span class="token number">-10</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;[#]~%Time for Stormer Verlet integration is:~%&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;~d~%&quot;</span> <span class="token punctuation">(</span><span class="token car">first</span> stormer-verlet-result<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;[#]~%Velocity for Stormer Verlet integration is:~%&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;~d~%&quot;</span> <span class="token punctuation">(</span><span class="token car">second</span> stormer-verlet-result<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token defvar"><span class="token keyword">defvar</span> <span class="token variable">velocity-verlet-result</span></span> <span class="token punctuation">(</span><span class="token car">velocity-verlet</span> <span class="token number">5</span> <span class="token number">-10</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;[#]~%Time for velocity Verlet integration is:~%&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;~d~%&quot;</span> <span class="token punctuation">(</span><span class="token car">first</span> velocity-verlet-result<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;[#]~%Velocity for velocity Verlet integration is:~%&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">&quot;~d~%&quot;</span> <span class="token punctuation">(</span><span class="token car">second</span> velocity-verlet-result<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>


<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

<h2 id="license">License</h2>
<h5 id="code-examples">Code Examples</h5>
<p>The code examples are licensed under the MIT license (found in <a href="https://github.com/algorithm-archivists/algorithm-archive/blob/master/LICENSE.md" target="_blank">LICENSE.md</a>).</p>
<h5 id="text">Text</h5>
<p>The text of this chapter was written by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><p><img class="center" src="../cc/CC-BY-SA_icon.svg"></p></a></p>
<h5 id="pull-requests">Pull Requests</h5>
<p>After initial licensing (<a href="https://github.com/algorithm-archivists/algorithm-archive/pull/560" target="_blank">#560</a>), the following pull requests have modified the text or graphics of this chapter:</p>
<ul>
<li>none</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../physics_solvers/physics_solvers.html" class="navigation navigation-prev " aria-label="Previous page: Physics Solvers">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../quantum_systems/quantum_systems.html" class="navigation navigation-next " aria-label="Next page: Quantum Systems">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Verlet Integration","level":"1.14.1","depth":2,"next":{"title":"Quantum Systems","level":"1.14.2","depth":2,"path":"contents/quantum_systems/quantum_systems.md","ref":"contents/quantum_systems/quantum_systems.md","articles":[{"title":"Split-Operator Method","level":"1.14.2.1","depth":3,"path":"contents/split-operator_method/split-operator_method.md","ref":"contents/split-operator_method/split-operator_method.md","articles":[]}]},"previous":{"title":"Physics Solvers","level":"1.14","depth":1,"path":"contents/physics_solvers/physics_solvers.md","ref":"contents/physics_solvers/physics_solvers.md","articles":[{"title":"Verlet Integration","level":"1.14.1","depth":2,"path":"contents/verlet_integration/verlet_integration.md","ref":"contents/verlet_integration/verlet_integration.md","articles":[]},{"title":"Quantum Systems","level":"1.14.2","depth":2,"path":"contents/quantum_systems/quantum_systems.md","ref":"contents/quantum_systems/quantum_systems.md","articles":[{"title":"Split-Operator Method","level":"1.14.2.1","depth":3,"path":"contents/split-operator_method/split-operator_method.md","ref":"contents/split-operator_method/split-operator_method.md","articles":[]}]}]},"dir":"ltr"},"config":{"plugins":["mathjax@https://github.com/algorithm-archivists/plugin-mathjax","bibtex-cite","wordcount","api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git","include-codeblock","bulk-redirect","prism","-highlight"],"root":"./","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"bash","name":"Bash"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"c8","name":"chip-8"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"},{"lang":"ti83b","name":"TI-83 Basic"},{"lang":"lua","name":"Lua"},{"lang":"crystal","name":"Crystal"},{"lang":"php","name":"PHP"},{"lang":"lisp","name":"Common Lisp"},{"lang":"nim","name":"Nim"},{"lang":"asm-x64","name":"X86-64 Assembly"},{"lang":"f90","name":"Fortran90"},{"lang":"factor","name":"Factor"},{"lang":"ws","name":"Whitespace"},{"lang":"scala","name":"Scala"},{"lang":"emojic","name":"Emojicode"},{"lang":"lolcode","name":"LOLCODE"},{"lang":"piet","name":"Piet"},{"lang":"ss","name":"Scheme"},{"lang":"ps1","name":"PowerShell"},{"lang":"v","name":"Vlang"},{"lang":"coffee","name":"CoffeeScript"},{"lang":"kotlin","name":"Kotlin"},{"lang":"ts","name":"TypeScript"},{"lang":"vim","name":"VimL"},{"lang":"coco","name":"Coconut"},{"lang":"dart","name":"Dart"}]},"prism":{"lang":{"asm-x64":"nasm"},"ignore":["emojicode","text"],"css":["prismjs/themes/prism-tomorrow.css"]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"bibtex-cite":{},"mathjax":{"forceSVG":false,"version":"2.6.1"},"include-codeblock":{"check":false,"edit":false,"lang":"","fixlang":true,"template":"default","theme":"chrome","unindent":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"honkit":">= 3.0.0","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"title":"Arcane Algorithm Archive","bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}},{"citationKey":"GNUPLOT","entryType":"MISC","entryTags":{"TITLE":"Gnuplot 5.0: An Interactive Plotting Program, Official Gnuplot Documentation","AUTHOR":"Williams, T and Kelley, C","YEAR":"2015"}},{"citationKey":"BEDE725","entryType":"BOOK","entryTags":{"TITLE":"Bede, the Reckoning of Time","AUTHOR":"Venerabilis, Beda and others","VOLUME":"29","YEAR":"1999","PUBLISHER":"Liverpool University Press"}},{"citationKey":"DICTCOMPUTUS","entryType":"MISC","entryTags":{"TITLE":"Dictionary.com definition of computus","URL":"https://www.merriam-webster.com/dictionary/computus","YEAR":"2020"}},{"citationKey":"COMPUTUS1876","entryType":"ARTICLE","entryTags":{"TITLE":"To find Easter: a new York correspondent sends us the following","AUTHOR":"unknown","JOURNAL":"Nature","YEAR":"1876"}},{"citationKey":"BIEN2004","entryType":"ARTICLE","entryTags":{"TITLE":"Gauss and beyond: The making of Easter algorithms","AUTHOR":"Bien, Reinhold","JOURNAL":"Archive for history of exact sciences","VOLUME":"58","NUMBER":"5","PAGES":"439--452","YEAR":"2004","PUBLISHER":"Springer"}},{"citationKey":"SERVOIS","entryType":"INPROCEEDINGS","entryTags":{"TITLE":"84 Calendrier","AUTHOR":"Servois, M","BOOKTITLE":"Annales de MathÃ©matiques pures et appliquÃ©es","VOLUME":"4","NUMBER":"1813-1814","PAGES":"84--90"}},{"citationKey":"STANDISH2004","entryType":"ARTICLE","entryTags":{"TITLE":"The astronomical unit now","AUTHOR":"Standish, EM","JOURNAL":"Proceedings of the International Astronomical Union","VOLUME":"2004","NUMBER":"IAUC196","PAGES":"163--179","YEAR":"2004","PUBLISHER":"Cambridge University Press"}},{"citationKey":"LUNAR_MONTH_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Lunar Month","URL":"https://en.wikipedia.org/wiki/Lunar_month","YEAR":"2020"}},{"citationKey":"SELF-SIMILAR","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Self-similarity","URL":"https://en.wikipedia.org/wiki/Self-similarity","YEAR":"2019"}},{"citationKey":"HAUSDORFF","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hausdorff dimension","URL":"https://en.wikipedia.org/wiki/Hausdorff_dimension","YEAR":"2019"}},{"citationKey":"3B1BFRACTAL","entryType":"MISC","entryTags":{"AUTHOR":"Sanderson, G","TITLE":"3blue1brown: Fractals are typically not self-similar","URL":"https://www.youtube.com/watch?v=gB9n2gHsHN4","YEAR":"2017"}},{"citationKey":"MANDELBROT1983FRACTAL","entryType":"BOOK","entryTags":{"TITLE":"The fractal geometry of nature","AUTHOR":"Mandelbrot, Benoit B","VOLUME":"173","YEAR":"1983","PUBLISHER":"WH freeman New York"}},{"citationKey":"MANDELBROT1967LONG","entryType":"ARTICLE","entryTags":{"TITLE":"How long is the coast of Britain? Statistical self-similarity and fractional dimension","AUTHOR":"Mandelbrot, Benoit","JOURNAL":"science","VOLUME":"156","NUMBER":"3775","PAGES":"636--638","YEAR":"1967","PUBLISHER":"American Association for the Advancement of Science"}},{"citationKey":"JAMPOUR2010NEW","entryType":"ARTICLE","entryTags":{"TITLE":"A new fast technique for fingerprint identification with fractal and chaos game theory","AUTHOR":"Jampour, Mahdi and Yaghoobi, Mahdi and Ashourzadeh, Maryam and Soleimani, Adel","JOURNAL":"Fractals","VOLUME":"18","NUMBER":"03","PAGES":"293--300","YEAR":"2010","PUBLISHER":"World Scientific"}},{"citationKey":"FRACTAL-COMPRESSION","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Fractal Compression","URL":"https://en.wikipedia.org/wiki/Fractal_compression","YEAR":"2019"}},{"citationKey":"SAUPE1994REVIEW","entryType":"ARTICLE","entryTags":{"TITLE":"A review of the fractal image compression literature","AUTHOR":"Saupe, Dietmar and Hamzaoui, Raouf","JOURNAL":"ACM SIGGRAPH Computer Graphics","VOLUME":"28","NUMBER":"4","PAGES":"268--276","YEAR":"1994","PUBLISHER":"ACM"}},{"citationKey":"GNEITING2012ESTIMATORS","entryType":"ARTICLE","entryTags":{"TITLE":"Estimators of fractal dimension: Assessing the roughness of time series and spatial data","AUTHOR":"Gneiting, Tilmann and Å evÄÃ­kovÃ¡, Hana and Percival, Donald B","JOURNAL":"Statistical Science","PAGES":"247--277","YEAR":"2012","PUBLISHER":"JSTOR"}},{"citationKey":"HUTCHINSON1981FRACTALS","entryType":"ARTICLE","entryTags":{"TITLE":"Fractals and self similarity","AUTHOR":"Hutchinson, John E","JOURNAL":"Indiana University Mathematics Journal","VOLUME":"30","NUMBER":"5","PAGES":"713--747","YEAR":"1981","PUBLISHER":"JSTOR"}},{"citationKey":"HUTCHINSON-OPERATOR","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hutchinson Operator","URL":"https://en.wikipedia.org/wiki/Hutchinson_operator","YEAR":"2019"}},{"citationKey":"CHAOS-GAME","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Chaos Game","URL":"https://en.wikipedia.org/wiki/Chaos_game","YEAR":"2019"}},{"citationKey":"CHAOS-GAME-WOLF","entryType":"MISC","entryTags":{"TITLE":"Wolfram: Chaos Game","URL":"http://mathworld.wolfram.com/ChaosGame.html","YEAR":"2019"}},{"citationKey":"BARNSLEY2014FRACTALS","entryType":"BOOK","entryTags":{"TITLE":"Fractals everywhere","AUTHOR":"Barnsley, Michael F","YEAR":"2014","PUBLISHER":"Academic press"}},{"citationKey":"HSV","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: HSL and HSV","URL":"https://en.wikipedia.org/wiki/HSL_and_HSV","YEAR":"2020"}},{"citationKey":"SCHLOSS2019","entryType":"ARTICLE","entryTags":{"TITLE":"Massively parallel split-step Fourier techniques for simulating quantum systems on graphics processing units","AUTHOR":"Schloss, James","YEAR":"2019"}},{"citationKey":"PETHICK2008","entryType":"BOOK","entryTags":{"TITLE":"Bose--Einstein condensation in dilute gases","AUTHOR":"Pethick, Christopher J and Smith, Henrik","YEAR":"2008","PUBLISHER":"Cambridge university press"}},{"citationKey":"WEGERT2012","entryType":"BOOK","entryTags":{"TITLE":"Visual complex functions: an introduction with phase portraits","AUTHOR":"Wegert, Elias","YEAR":"2012","PUBLISHER":"Springer Science \\& Business Media"}},{"citationKey":"POELKEDOMAIN","entryType":"ARTICLE","entryTags":{"TITLE":"Domain Coloring of Complex Functions","AUTHOR":"Poelke, Konstantin and Polthier, Konrad"}},{"citationKey":"LUNDMARK2004","entryType":"ARTICLE","entryTags":{"TITLE":"Visualizing complex analytic functions using domain coloring","AUTHOR":"Lundmark, Hans","JOURNAL":"Recuperado el","VOLUME":"24","YEAR":"2004"}},{"citationKey":"GIMP_BUCKET","entryType":"MISC","entryTags":{"TITLE":"Bucket Fill in Gimp","URL":"https://docs.gimp.org/2.10/en/gimp-tool-bucket-fill.html","YEAR":"2020"}},{"citationKey":"TORBERT2016","entryType":"BOOK","entryTags":{"TITLE":"Applied computer science","AUTHOR":"Torbert, Shane","YEAR":"2016","PAGES":"158","PUBLISHER":"Springer"}},{"citationKey":"CANNY1986COMPUTATIONAL","entryType":"ARTICLE","entryTags":{"TITLE":"A computational approach to edge detection","AUTHOR":"Canny, John","JOURNAL":"IEEE Transactions on pattern analysis and machine intelligence","NUMBER":"6","PAGES":"679--698","YEAR":"1986","PUBLISHER":"Ieee"}},{"citationKey":"MORRIS1978COUNTING","entryType":"ARTICLE","entryTags":{"TITLE":"Counting large numbers of events in small registers","AUTHOR":"Morris, R","JOURNAL":"Communications of the ACM","VOLUME":"21","NUMBER":"10","PAGES":"840--842","YEAR":"1978","PUBLISHER":"ACM New York, NY, USA"}},{"citationKey":"FLAJOLET1985APPROXIMATE","entryType":"ARTICLE","entryTags":{"TITLE":"Approximate counting: a detailed analysis","AUTHOR":"Flajolet, P","JOURNAL":"BIT Numerical Mathematics","VOLUME":"25","NUMBER":"1","PAGES":"113--134","YEAR":"1985","PUBLISHER":"Springer"}},{"citationKey":"ARPIT_COUNTING","entryType":"MISC","entryTags":{"TITLE":"Morris's Algorithm for Approximate Counting","AUTHOR":"Bhayani, A","URL":"https://arpitbhayani.me/blogs/morris-counter","YEAR":"2020"}},{"citationKey":"GREGGUNDERSON_COUNTING","entryType":"MISC","entryTags":{"TITLE":"Approximate Counting with Morris's Algorithm","AUTHOR":"Gundersen, G","URL":"http://gregorygundersen.com/blog/2019/11/11/morris-algorithm/","YEAR":"2019"}},{"citationKey":"3B1B_FINGER_COUNT","entryType":"MISC","entryTags":{"TITLE":"How to count to 1000 on two hands","AUTHOR":"Sanderson, G","URL":"https://youtu.be/1SMmc9gQmHQ","YEAR":"2015"}}],"gitbook":"*"},"file":{"path":"contents/verlet_integration/verlet_integration.md","mtime":"2021-11-30T04:00:54.713Z","type":"markdown"},"gitbook":{"version":"3.6.23","time":"2021-11-30T04:01:21.844Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

