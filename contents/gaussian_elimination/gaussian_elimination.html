
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Gaussian Elimination Â· Arcane Algorithm Archive</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.5">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../thomas_algorithm/thomas_algorithm.html" />
    
    
    <link rel="prev" href="../matrix_methods/matrix_methods.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/introduction.html">
            
                <a href="../introduction/introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how_to_contribute/how_to_contribute.html">
            
                <a href="../how_to_contribute/how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../code_reviews/code_reviewers.html">
            
                <a href="../code_reviews/code_reviewers.html">
            
                    
                    Code Reviewers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../plotting/plotting.html">
            
                <a href="../plotting/plotting.html">
            
                    
                    Plotting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../domain_coloring/domain_coloring.html">
            
                <a href="../domain_coloring/domain_coloring.html">
            
                    
                    Domain Coloring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../IFS/IFS.html">
            
                <a href="../IFS/IFS.html">
            
                    
                    Iterated Function Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../barnsley/barnsley.html">
            
                <a href="../barnsley/barnsley.html">
            
                    
                    The Barnsley Fern
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../data_structures/data_structures.html">
            
                <a href="../data_structures/data_structures.html">
            
                    
                    Data Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../stacks_and_queues/stacks_and_queues.html">
            
                <a href="../stacks_and_queues/stacks_and_queues.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../mathematical_background/mathematical_background.html">
            
                <a href="../mathematical_background/mathematical_background.html">
            
                    
                    Mathematical Background
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../notation/notation.html">
            
                <a href="../notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../affine_transformations/affine_transformations.html">
            
                <a href="../affine_transformations/affine_transformations.html">
            
                    
                    Affine Transformations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../bitlogic/bitlogic.html">
            
                <a href="../bitlogic/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../taylor_series_expansion/taylor_series_expansion.html">
            
                <a href="../taylor_series_expansion/taylor_series_expansion.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../convolutions/convolutions.html">
            
                <a href="../convolutions/convolutions.html">
            
                    
                    Convolutions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.5.1" data-path="../convolutions/1d/1d.html">
            
                <a href="../convolutions/1d/1d.html">
            
                    
                    Convolutions in 1D
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.2" data-path="../convolutions/multiplication/multiplication.html">
            
                <a href="../convolutions/multiplication/multiplication.html">
            
                    
                    Multiplication as a Convolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.3" data-path="../convolutions/2d/2d.html">
            
                <a href="../convolutions/2d/2d.html">
            
                    
                    Convolutions of Images (2D)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.4" data-path="../convolutions/convolutional_theorem/convolutional_theorem.html">
            
                <a href="../convolutions/convolutional_theorem/convolutional_theorem.html">
            
                    
                    Convolutional Theorem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../box_muller/box_muller.html">
            
                <a href="../box_muller/box_muller.html">
            
                    
                    Box Muller Transform
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.6.1" data-path="../box_muller/box_muller_rejection.html">
            
                <a href="../box_muller/box_muller_rejection.html">
            
                    
                    How costly is rejection sampling?
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../probability_distributions/distributions.html">
            
                <a href="../probability_distributions/distributions.html">
            
                    
                    Probability Distributions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../tree_traversal/tree_traversal.html">
            
                <a href="../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../euclidean_algorithm/euclidean_algorithm.html">
            
                <a href="../euclidean_algorithm/euclidean_algorithm.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../monte_carlo_integration/monte_carlo_integration.html">
            
                <a href="../monte_carlo_integration/monte_carlo_integration.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../metropolis/metropolis.html">
            
                <a href="../metropolis/metropolis.html">
            
                    
                    Metropolis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../matrix_methods/matrix_methods.html">
            
                <a href="../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.10.1" data-path="gaussian_elimination.html">
            
                <a href="gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../thomas_algorithm/thomas_algorithm.html">
            
                <a href="../thomas_algorithm/thomas_algorithm.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../computational_geometry/computational_geometry.html">
            
                <a href="../computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../gift_wrapping/gift_wrapping.html">
            
                <a href="../gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="../jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="../graham_scan/graham_scan.html">
            
                <a href="../graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../cooley_tukey/cooley_tukey.html">
            
                <a href="../cooley_tukey/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../decision_problems/decision_problems.html">
            
                <a href="../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../stable_marriage_problem/stable_marriage_problem.html">
            
                <a href="../stable_marriage_problem/stable_marriage_problem.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../physics_solvers/physics_solvers.html">
            
                <a href="../physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../verlet_integration/verlet_integration.html">
            
                <a href="../verlet_integration/verlet_integration.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../quantum_systems/quantum_systems.html">
            
                <a href="../quantum_systems/quantum_systems.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.2.1" data-path="../split-operator_method/split-operator_method.html">
            
                <a href="../split-operator_method/split-operator_method.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../data_compression/data_compression.html">
            
                <a href="../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../huffman_encoding/huffman_encoding.html">
            
                <a href="../huffman_encoding/huffman_encoding.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../computer_graphics/computer_graphics.html">
            
                <a href="../computer_graphics/computer_graphics.html">
            
                    
                    Computer Graphics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../flood_fill/flood_fill.html">
            
                <a href="../flood_fill/flood_fill.html">
            
                    
                    Flood Fill
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../quantum_information/quantum_information.html">
            
                <a href="../quantum_information/quantum_information.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../cryptography/cryptography.html">
            
                <a href="../cryptography/cryptography.html">
            
                    
                    Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../computus/computus.html">
            
                <a href="../computus/computus.html">
            
                    
                    Computus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../approximate_counting/approximate_counting.html">
            
                <a href="../approximate_counting/approximate_counting.html">
            
                    
                    Approximate Counting Algorithm
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Gaussian Elimination</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="gaussian-elimination">Gaussian Elimination</h1>
<p>Let&apos;s say we have a system of equations,</p>
<p><script type="math/tex; mode=display">
\begin{align}
2x + 3y + 4z &= 6 \\
x + 2y + 3z &= 4 \\
3x - 4y &= 10
\end{align}
</script></p>
<p>and we want to solve for <script type="math/tex; ">x</script>, <script type="math/tex; ">y</script>, and <script type="math/tex; ">z</script>.
Well, one way to do this is with <em>Gaussian Elimination</em>, which you may have encountered before in a math class or two.</p>
<p>The first step is to transform the system of equations into a matrix by using the coefficients in front of each variable, where each row corresponds to another equation and each column corresponds to an independent variable like <script type="math/tex; ">x</script>, <script type="math/tex; ">y</script>, or <script type="math/tex; ">z</script>.
For the previous system of equations, this might look like this:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc}
2 & 3  & 4\\
1 & 2 & 3\\
3 & -4 & 0
\end{array}
\right]
\left[
\begin{array}{c}
x \\
y \\
z
\end{array}
\right]
=
\left[
\begin{array}{c}
6 \\
4 \\
10
\end{array}
\right]
</script></p>
<p>Or more simply:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
2 & 3  & 4 & 6 \\
1 & 2 & 3 & 4 \\
3 & -4 & 0 & 10
\end{array}
\right]
</script></p>
<p>At first, translating the set of equations into a matrix like this doesn&apos;t seem to help with anything, so let&apos;s think of this in another way.</p>
<h4 id="row-echelon-form">Row Echelon Form</h4>
<p>Instead of the complicated mess of equations shown above, imagine if the system looked like this:</p>
<p><script type="math/tex; mode=display">
\begin{align}
2x + 3y + 4z &= 6 \\
y + 2z &= 2 \\
11z &= 18
\end{align}
</script></p>
<p>Then we could just solve for <script type="math/tex; ">z</script> and plug that value in to the top two equations to solve for <script type="math/tex; ">x</script> and <script type="math/tex; ">y</script> through a process known as back-substitution.
In matrix form, this set of equations would look like this:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
2 & 3  & 4 & 6 \\
0 & 1 & 2 & 2 \\
0 & 0 & 11 & 18
\end{array}
\right]
</script></p>
<p>This matrix form has a particular name: <em>Row Echelon Form</em>.
Basically, any matrix can be considered in row echelon form if the leading coefficient or <em>pivot</em> (the first non-zero element in every row when reading from left to right) is right of the pivot of the row above it.</p>
<p>This creates a matrix that sometimes resembles an upper-triangular matrix; however, that doesn&apos;t mean that all row-echelon matrices are upper-triangular.
For example, all of the following matrices are in row echelon form:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
2 & 3  & 4 & 6 \\
0 & 1 & 2 & 2 \\
0 & 0 & 11 & 18
\end{array}
\right]
\;,\;
\left[
\begin{array}{ccc|c}
5 & 4  & 0 & 10 \\
0 & 0 & 5 & 7 \\
0 & 0 & 0 & 1
\end{array}
\right]
\;,\;
\left[
\begin{array}{ccccc}
1 & -3 & 4 & 1 & 6 \\
0 & 3 & 3 & 5 & 0 \\
0 & 0 & 0 & 2 & 0
\end{array}
\right]
\;,\;
\left[
\begin{array}{cc}
1 &  2 \\
2 &  0 \\
0 &  0
\end{array}
\right]
</script></p>
<p>The first two of these have the right dimensions to find a solution to a system of equations; however, the last two matrices are respectively under- and over-constrained, meaning they do not provide an appropriate solution to a system of equations.
That said, this doesn&apos;t mean that every matrix in the correct form can be solved either.
For example, if you translate the second matrix into a system of equations again, the last row translates into <script type="math/tex; ">0x+0y+0z=1</script>, which is a contradiction.
This is due to the fact that the matrix is singular, and there are no solutions to this particular system.
Nevertheless, all of these matrices are in row echelon form.</p>
<h4 id="reduced-row-echelon-form"><em>Reduced</em> Row Echelon Form</h4>
<p>Row echelon form is nice, but wouldn&apos;t it be even better if our system of equations looked simply like this:</p>
<p><script type="math/tex; mode=display">
\begin{align}
x &= \frac{18}{11} \\
y &= \frac{-14}{11} \\
z &= \frac{18}{11}
\end{align}
</script></p>
<p>Then we would know exactly what <script type="math/tex; ">x</script>, <script type="math/tex; ">y</script>, and <script type="math/tex; ">z</script> are without any fuss! In matrix form, it looks like this:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
1 & 0 & 0 & \frac{18}{11} \\
0 & 1 & 0 & \frac{-14}{11} \\
0 & 0 & 1 & \frac{18}{11}
\end{array}
\right]
</script></p>
<p>This introduces yet another matrix configuration: <em> <strong>Reduced</strong> Row Echelon Form</em>.
A matrix is in reduced row echelon form if it satisfies the following conditions:</p>
<ol>
<li>It is in row echelon form.</li>
<li>Every pivot is 1 and is the only nonzero entry in its column.</li>
</ol>
<p>All the following examples are in the reduced row echelon form:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
1 & 0 & 0 & 8 \\
0 & 1 & 0 & -3 \\
0 & 0 & 1 & 9
\end{array}
\right]
\;,\;
\left[
\begin{array}{ccc|c}
1 & 4  & 0 & 9 \\
0 & 0 & 1 & 7 \\
0 & 0 & 0 & 1
\end{array}
\right]
\;,\;
\left[
\begin{array}{cc}
0 & 0 \\
0 & 0 \\
0 & 0
\end{array}
\right]
</script></p>
<p>Again, only the first of these (the one that looks like an identity matrix) is desirable in the context of solving a system of equations, but transforming any matrix in this form gives us an immediate and definitive answer at the question: can I solve my system of equations?</p>
<p>Beyond solving a system of equations, reshaping a matrix in this form makes it very easy to deduce other properties of the matrix, such as its rank â the maximum number of linearly independent columns.
In reduced row echelon form, the rank is simply the number of pivots.</p>
<p>For now, I hope the motivation is clear: we want to convert a matrix into row echelon and then reduced row echelon form to make large systems of equations trivial to solve, so we need some method to do that.
In general, the term <em>Gaussian Elimination</em> refers to the process of transforming a matrix into row echelon form, and the process of transforming a row echelon matrix into reduced row echelon form is called <em>Gauss-Jordan Elimination</em>.
That said, the notation here is sometimes inconsistent.
Several authors use the term <em>Gaussian Elimination</em> to include Gauss-Jordan elimination as well.
In addition, the process of Gauss-Jordan elimination is sometimes called <em>Back-substitution</em>, which is also confusing because the term can also be used to mean solving a system of equations from row echelon form, without simplifying to reduced row echelon form.
For this reason, we will be using the following definitions in this chapter:</p>
<ul>
<li><strong>Gaussian Elimination:</strong> The process of transforming a matrix into row echelon form</li>
<li><strong>Gauss-Jordan Elimination:</strong> The process of transforming a row echelon matrix into <em>reduced</em> row echelon form</li>
<li><strong>Back-substitution:</strong> The process of directly solving a row echelon matrix, <em>without transforming into reduced row echelon form</em></li>
</ul>
<h2 id="the-analytical-method">The Analytical Method</h2>
<p>Gaussian elimination is inherently analytical and can be done by hand for small systems of equations; however, for large systems, this (of course) become tedious and we will need to find an appropriate numerical solution.
For this reason, I have split this section into two parts. One will cover the analytical framework, and the other will cover an algorithm you can write in your favorite programming language.</p>
<p>In the end, reducing large systems of equations boils down to a game you play on a seemingly random matrix with 3 possible moves. You can:</p>
<ol>
<li>Swap any two rows.</li>
<li>Multiply any row by a non-zero scale value.</li>
<li>Add any row to a multiple of any other row.</li>
</ol>
<p>That&apos;s it.
Before continuing, I suggest you try to recreate the row echelon matrix we made above.
That is, do the following:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
2 & 3  & 4 & 6 \\
1 & 2 & 3 & 4 \\
3 & -4 & 0 & 10
\end{array}
\right]
\quad \rightarrow \quad
\left[
\begin{array}{ccc|c}
2 & 3  & 4 & 6 \\
0 & 1 & 2 & 2 \\
0 & 0 & 11 & 18
\end{array}
\right]
</script></p>
<p>There are plenty of different strategies you could use to do this, and no one strategy is better than the rest.
One method is to subtract a multiple of the top row from subsequent rows below it such that all values beneath the pivot value are zero.
This process might be easier if you swap some rows around first and can be performed for each pivot.</p>
<p>After you get a row echelon matrix, the next step is to find the reduced row echelon form. In other words, we do the following:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
2 & 3  & 4 & 6 \\
0 & 1 & 2 & 2 \\
0 & 0 & 11 & 18
\end{array}
\right]
\quad \rightarrow \quad
\left[
\begin{array}{ccc|c}
1 & 0 & 0 & \frac{18}{11} \\
0 & 1 & 0 & \frac{-14}{11} \\
0 & 0 & 1 & \frac{18}{11}
\end{array}
\right]
</script></p>
<p>Here, the idea is similar to above and the same rules apply.
In this case, we might start from the right-most column and subtracts upwards instead of downwards.</p>
<h2 id="the-computational-method">The Computational Method</h2>
<p>The analytical method for Gaussian Elimination may seem straightforward, but the computational method does not obviously follow from the &quot;game&quot; we were playing before.
Ultimately, the computational method boils down to two separate steps and has a complexity of <script type="math/tex; ">\mathcal{O}(n^3)</script>.</p>
<p>As a note, this process iterates through all the rows in the provided matrix.
When we say &quot;current row&quot; (<code>curr_row</code>), we mean the specific row iteration number we are on at that time, and as before, the &quot;pivot&quot; corresponds to the first non-zero element in that row.</p>
<h4 id="step-1">Step 1</h4>
<p>For each element in the pivot column under the current row, find the highest value and switch the row with the highest value with the current row.
The <em>pivot</em> is then considered to be the first element in the highest swapped row.</p>
<p>For example, in this case the highest value is <script type="math/tex; ">3</script>:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
2 & 3  & 4 & 6 \\
1 & 2 & 3 & 4 \\
\mathbf{3} & -4 & 0 & 10
\end{array}
\right]
</script></p>
<p>After finding this value, we simply switch the row with the <script type="math/tex; ">3</script> to the current row:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
\mathbf{2} & \mathbf{3}  & \mathbf{4} & \mathbf{6} \\
1 & 2 & 3 & 4 \\
\mathbf{3} & \mathbf{-4} & \mathbf{0} & \mathbf{10}
\end{array}
\right]
\rightarrow
\left[
\begin{array}{ccc|c}
\mathbf{3} & \mathbf{-4} & \mathbf{0} & \mathbf{10} \\
1 & 2 & 3 & 4 \\
\mathbf{2} & \mathbf{3}  & \mathbf{4} & \mathbf{6}
\end{array}
\right]
</script></p>
<p>In this case, the new pivot is <script type="math/tex; ">3</script>.</p>
<p>In code, this process might look like this:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token comment"># finding the maximum element for each column</span>
max_index <span class="token operator">=</span> argmax<span class="token punctuation">(</span>abs<span class="token punctuation">.</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>row<span class="token punctuation">:</span><span class="token keyword">end</span><span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> row<span class="token operator">-</span><span class="token number">1</span>

<span class="token comment"># Check to make sure matrix is good!</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;matrix is singular!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">continue</span>
<span class="token keyword">end</span>

<span class="token comment"># swap row with highest value for that column to the top</span>
temp_vector <span class="token operator">=</span> A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp_vector
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token comment">// finding the maximum element</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">!=</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Swap the row with the highest valued element</span>
    <span class="token comment">// with the current row</span>
    <span class="token function">swapRow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> col<span class="token punctuation">,</span> pivot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">swap_rows</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> i<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> pivot<span class="token punctuation">,</span>
               <span class="token keyword">const</span> <span class="token class-name">size_t</span> cols<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> tmp <span class="token operator">=</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-c"><span class="token class-name">size_t</span> pivot <span class="token operator">=</span> row<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">fabs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>col <span class="token operator">!=</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">swap_rows</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> col<span class="token punctuation">,</span> pivot<span class="token punctuation">,</span> cols<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp">  std<span class="token double-colon punctuation">::</span>size_t pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">fabs</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> pivot <span class="token operator">=</span> j<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
  <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// But continuing to simplify the matrix as much as possible</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> pivot<span class="token punctuation">)</span>  <span class="token comment">// Swapping the rows if new row with higher maxVals is found</span>
  std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">,</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// C++ swap function</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">swapRows</span> <span class="token operator">::</span> <span class="token constant">Int</span> <span class="token operator">-&gt;</span> <span class="token constant">Int</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">swapRows</span> <span class="token hvariable">r1</span> <span class="token hvariable">r2</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token hvariable">r1</span> <span class="token operator">==</span> <span class="token hvariable">r2</span> <span class="token operator">=</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span>
    <span class="token hvariable">m</span> <span class="token operator">//</span>
    <span class="token builtin">concat</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r2</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r2</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token hvariable">c</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">c1</span> <span class="token operator">..</span> <span class="token hvariable">cn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">m</span>
</code></pre>
<pre class="language-"><code class="lang-haskell"><span class="token punctuation">(</span><span class="token hvariable">target</span><span class="token punctuation">,</span> <span class="token hvariable">pivot</span><span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token hvariable">maximumBy</span> <span class="token punctuation">(</span><span class="token builtin">compare</span> <span class="token operator">`on`</span> <span class="token builtin">abs</span> <span class="token operator">.</span> <span class="token builtin">snd</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token hvariable">k</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">k</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token hvariable">m&apos;</span> <span class="token operator">=</span> <span class="token hvariable">swapRows</span> <span class="token hvariable">r</span> <span class="token hvariable">target</span> <span class="token hvariable">m</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">let</span> pivot <span class="token operator">=</span> row<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>col <span class="token operator">!==</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> t <span class="token operator">=</span> a<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
  a<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">;</span>
  a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token comment">// 1. find highest value in column below row to be pivot</span>
p<span class="token punctuation">,</span> highest <span class="token operator">:=</span> r<span class="token punctuation">,</span> <span class="token number">0.</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> abs <span class="token operator">:=</span> math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> abs <span class="token operator">&gt;</span> highest <span class="token punctuation">{</span>
        p <span class="token operator">=</span> r <span class="token operator">+</span> i
        highest <span class="token operator">=</span> abs
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
highest <span class="token operator">=</span> a<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token comment">// correct sign</span>

<span class="token keyword">if</span> highest <span class="token operator">==</span> <span class="token number">0.</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>singular <span class="token punctuation">{</span>
        singular <span class="token operator">=</span> <span class="token boolean">true</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;This matrix is singular.&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">continue</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python">temp <span class="token operator">=</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>max_i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
A<span class="token punctuation">[</span>max_i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp

<span class="token comment"># Skip on singular matrix,  not actually a pivot</span>
<span class="token keyword">if</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">continue</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust">    <span class="token comment">// find the maximum element for this column</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> max_row <span class="token operator">=</span> k<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> max_value <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token punctuation">{</span>
        <span class="token keyword">if</span> max_value <span class="token operator">&lt;</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            max_value <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            max_row <span class="token operator">=</span> row<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Check to make sure the matrix is good</span>
    <span class="token keyword">if</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>max_row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Matrix is singular, aborting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// swap the row with the highest value for this kumn to the top</span>
    a<span class="token punctuation">.</span><span class="token function">swap_rows</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> max_row<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Loop over all remaining rows</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token punctuation">{</span>
        <span class="token comment">// find the fraction</span>
        <span class="token keyword">let</span> fraction <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Loop through all columns for that row</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>cols <span class="token punctuation">{</span>
            <span class="token comment">// re-evaluate each element</span>
            a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> fraction<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// set lower elements to 0</span>
        a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div></div></div>

<p>As a note, if the highest value is <script type="math/tex; ">0</script>, the matrix is singular and the system has no single solution.
This makes sense because if the highest value in a column is 0, the entire column must be 0, thus there can be no unique solution when we read the matrix as a set of equations.
That said, Gaussian elimination is more general and allows us to continue, even if the matrix is not necessarily solvable as a set of equations.
Feel free to exit after finding a <script type="math/tex; ">0</script> if your end-goal is to solve a system of equations.</p>
<h4 id="step-2">Step 2</h4>
<p>For the row beneath the current pivot row and within the pivot column, find a fraction that corresponds to the ratio of the value in that column to the pivot, itself.
After this, subtract the current pivot row multiplied by the fraction from each corresponding row element.
This process essentially subtracts an optimal multiple of the current row from each row underneath (similar to Step 3 from the above game).
Ideally, this should always create a 0 under the current row&apos;s pivot value.</p>
<p>For example, in this matrix, the next row is <script type="math/tex; ">1</script> and the pivot value is <script type="math/tex; ">3</script>, so the fraction is <script type="math/tex; ">\frac{1}{3}</script>.
<script type="math/tex; mode=display">
\rightarrow
\left[
\begin{array}{ccc|c}
3 & -4 & 0 & 10 \\
\mathbf{1} & 2 & 3 & 4 \\
2 & 3  & 4 & 6
\end{array}
\right] \\
\begin{align}
    f &= A(\text{curr_row}, \text{pivot}_{\text{col}}) /  A(\text{pivot}_{\text{row}}, \text{pivot}_{\text{col}}) \\
      &= \frac{1}{3}
\end{align}
</script></p>
<p>After finding the fraction, we simply subtract <script type="math/tex; ">\text{current_row} - \frac{1}{3}\times \text{pivot_row}</script>, like so:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
3 & -4 & 0 & 10 \\
\mathbf{1} & \mathbf{2} & \mathbf{3} & \mathbf{4} \\
2 & 3  & 4 & 6
\end{array}
\right]
\rightarrow
\left[
\begin{array}{ccc|c}
3 & -4 & 0 & 10 \\
0 & \mathbf{\frac{10}{3}} & \mathbf{3} & \mathbf{\frac{2}{3}}
\\
2 & 3  & 4 & 6
\end{array}
\right]
</script></p>
<p>After this, repeat the process for all other rows.</p>
<p>Here is what it might look like in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token comment"># Loop for all remaining rows</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>rows

    <span class="token comment"># finding fraction</span>
    fraction <span class="token operator">=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token operator">/</span>A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>col<span class="token punctuation">]</span>

    <span class="token comment"># loop through all columns for that row</span>
    <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token punctuation">(</span>col<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>cols

         <span class="token comment"># re-evaluate each element</span>
         A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>j<span class="token punctuation">]</span><span class="token operator">*</span>fraction

    <span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// finding the inverse</span>
    <span class="token keyword">double</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// loop through all columns in current row</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// Subtract rows</span>
        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> scale <span class="token operator">=</span> eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t k <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>   <span class="token comment">// k doesn&apos;t start at 0, since</span>
    eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-=</span> scale <span class="token operator">*</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// values before from 0 to i</span>
                                       <span class="token comment">// are already 0</span>
  eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">subRows</span> <span class="token operator">::</span>
     <span class="token constant">Fractional</span> <span class="token hvariable">a</span>
  <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- pivot location</span>
  <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- rows to cover</span>
  <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- columns to cover</span>
  <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
  <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">subRows</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">rn</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">c1</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span> <span class="token hvariable">m</span> <span class="token operator">=</span>
  <span class="token hvariable">accum</span>
    <span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">)</span>
    <span class="token hvariable">m</span>
    <span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">i</span><span class="token punctuation">,</span> <span class="token hvariable">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">i</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">j</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">|</span> <span class="token hvariable">i</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r1</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span>
    <span class="token punctuation">,</span> <span class="token hvariable">j</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">c1</span> <span class="token operator">..</span> <span class="token hvariable">cn</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
</code></pre>
<pre class="language-"><code class="lang-haskell"><span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token hvariable">subRows</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">r</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token hvariable">rn</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">c</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span> <span class="token hvariable">m&apos;</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token comment">// 3. find fraction from pivot value</span>
    frac <span class="token operator">:=</span> row<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">/</span> highest

    <span class="token comment">// 4. subtract row to set rest of column to zero</span>
    <span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">{</span>
        row<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> frac <span class="token operator">*</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 5. ensure col goes to zero (no float rounding)</span>
    row<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token comment"># Zero out elements below pivot</span>
<span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>pivot_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>  A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Get fraction</span>
    frac <span class="token operator">=</span> <span class="token operator">-</span>A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span> <span class="token operator">/</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span>
    <span class="token comment"># Add rows</span>
    A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+=</span> frac <span class="token operator">*</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token comment">// Loop over all remaining rows</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token punctuation">{</span>
    <span class="token comment">// find the fraction</span>
    <span class="token keyword">let</span> fraction <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// Loop through all columns for that row</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>cols <span class="token punctuation">{</span>
        <span class="token comment">// re-evaluate each element</span>
        a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> fraction<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// set lower elements to 0</span>
    a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div></div></div>

<h4 id="all-together">All together</h4>
<p>When we put everything together, it looks like this:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> gaussian_elimination<span class="token operator">!</span><span class="token punctuation">(</span>A<span class="token punctuation">::</span>Array<span class="token punctuation">{</span>Float64<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    rows <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    cols <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment"># Row index</span>
    row <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token comment"># Main loop going through all columns</span>
    <span class="token keyword">for</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">(</span>cols<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token comment"># finding the maximum element for each column</span>
        max_index <span class="token operator">=</span> argmax<span class="token punctuation">(</span>abs<span class="token punctuation">.</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>row<span class="token punctuation">:</span><span class="token keyword">end</span><span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> row<span class="token operator">-</span><span class="token number">1</span>

        <span class="token comment"># Check to make sure matrix is good!</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;matrix is singular!&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">end</span>

        <span class="token comment"># swap row with highest value for that column to the top</span>
        temp_vector <span class="token operator">=</span> A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp_vector

        <span class="token comment"># Loop for all remaining rows</span>
        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>rows

            <span class="token comment"># finding fraction</span>
            fraction <span class="token operator">=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token operator">/</span>A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>col<span class="token punctuation">]</span>

            <span class="token comment"># loop through all columns for that row</span>
            <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token punctuation">(</span>col<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>cols

                 <span class="token comment"># re-evaluate each element</span>
                 A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>j<span class="token punctuation">]</span><span class="token operator">*</span>fraction

            <span class="token keyword">end</span>

            <span class="token comment"># Set lower elements to 0</span>
            A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">end</span>
        row <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">gaussian_elimination</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> rows<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> cols<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">size_t</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">size_t</span> pivot <span class="token operator">=</span> row<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">fabs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>col <span class="token operator">!=</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">swap_rows</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> col<span class="token punctuation">,</span> pivot<span class="token punctuation">,</span> cols<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">double</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        row<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token keyword">void</span> <span class="token function">gaussianElimination</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token operator">&amp;</span>eqns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &apos;eqns&apos; is the matrix, &apos;rows&apos; is no. of vars</span>
  std<span class="token double-colon punctuation">::</span>size_t rows <span class="token operator">=</span> eqns<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cols <span class="token operator">=</span> eqns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      std<span class="token double-colon punctuation">::</span>size_t pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">fabs</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> pivot <span class="token operator">=</span> j<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// But continuing to simplify the matrix as much as possible</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> pivot<span class="token punctuation">)</span>  <span class="token comment">// Swapping the rows if new row with higher maxVals is found</span>
      std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">,</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// C++ swap function</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">double</span> scale <span class="token operator">=</span> eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t k <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>   <span class="token comment">// k doesn&apos;t start at 0, since</span>
        eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-=</span> scale <span class="token operator">*</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// values before from 0 to i</span>
                                           <span class="token comment">// are already 0</span>
      eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">swapRows</span> <span class="token operator">::</span> <span class="token constant">Int</span> <span class="token operator">-&gt;</span> <span class="token constant">Int</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">swapRows</span> <span class="token hvariable">r1</span> <span class="token hvariable">r2</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token hvariable">r1</span> <span class="token operator">==</span> <span class="token hvariable">r2</span> <span class="token operator">=</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span>
    <span class="token hvariable">m</span> <span class="token operator">//</span>
    <span class="token builtin">concat</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r2</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r2</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token hvariable">c</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">c1</span> <span class="token operator">..</span> <span class="token hvariable">cn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">m</span>

<span class="token hvariable">subRows</span> <span class="token operator">::</span>
     <span class="token constant">Fractional</span> <span class="token hvariable">a</span>
  <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- pivot location</span>
  <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- rows to cover</span>
  <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- columns to cover</span>
  <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
  <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">subRows</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">rn</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">c1</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span> <span class="token hvariable">m</span> <span class="token operator">=</span>
  <span class="token hvariable">accum</span>
    <span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">)</span>
    <span class="token hvariable">m</span>
    <span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">i</span><span class="token punctuation">,</span> <span class="token hvariable">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">i</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">j</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">|</span> <span class="token hvariable">i</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r1</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span>
    <span class="token punctuation">,</span> <span class="token hvariable">j</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">c1</span> <span class="token operator">..</span> <span class="token hvariable">cn</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>

<span class="token hvariable">gaussianElimination</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Fractional</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Ord</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">gaussianElimination</span> <span class="token hvariable">mat</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span> <span class="token hvariable">mat</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">gaussian_elimination</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>

    pivot_row <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># Go by column</span>
    <span class="token keyword">for</span> pivot_col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># Swap row with highest element in col</span>
        max_i <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">:</span><span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> pivot_row

        temp <span class="token operator">=</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>max_i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        A<span class="token punctuation">[</span>max_i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp

        <span class="token comment"># Skip on singular matrix,  not actually a pivot</span>
        <span class="token keyword">if</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        <span class="token comment"># Zero out elements below pivot</span>
        <span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>pivot_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>  A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># Get fraction</span>
            frac <span class="token operator">=</span> <span class="token operator">-</span>A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span> <span class="token operator">/</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span>
            <span class="token comment"># Add rows</span>
            A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+=</span> frac <span class="token operator">*</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>

        pivot_row <span class="token operator">+=</span> <span class="token number">1</span>
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">gaussianElimination</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> rows <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> pivot <span class="token operator">=</span> row<span class="token punctuation">;</span>

        <span class="token comment">// finding the maximum element</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">!=</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Swap the row with the highest valued element</span>
            <span class="token comment">// with the current row</span>
            <span class="token function">swapRow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> col<span class="token punctuation">,</span> pivot<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// finding the inverse</span>
            <span class="token keyword">double</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// loop through all columns in current row</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token comment">// Subtract rows</span>
                a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Set lower elements to 0</span>
            a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        row<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">gaussianElimination</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rows <span class="token operator">=</span> a<span class="token punctuation">.</span>length
  <span class="token keyword">const</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length
  <span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> pivot <span class="token operator">=</span> row<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>col <span class="token operator">!==</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> t <span class="token operator">=</span> a<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
      a<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">;</span>
      a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token operator">++</span>row<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">gaussianElimination</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    singular <span class="token operator">:=</span> <span class="token boolean">false</span>
    rows <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    cols <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> c<span class="token punctuation">,</span> r <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> cols <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> c<span class="token operator">++</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1. find highest value in column below row to be pivot</span>
        p<span class="token punctuation">,</span> highest <span class="token operator">:=</span> r<span class="token punctuation">,</span> <span class="token number">0.</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> abs <span class="token operator">:=</span> math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> abs <span class="token operator">&gt;</span> highest <span class="token punctuation">{</span>
                p <span class="token operator">=</span> r <span class="token operator">+</span> i
                highest <span class="token operator">=</span> abs
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        highest <span class="token operator">=</span> a<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token comment">// correct sign</span>

        <span class="token keyword">if</span> highest <span class="token operator">==</span> <span class="token number">0.</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token operator">!</span>singular <span class="token punctuation">{</span>
                singular <span class="token operator">=</span> <span class="token boolean">true</span>
                fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;This matrix is singular.&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">continue</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 2. swap pivot with current row</span>
        <span class="token keyword">if</span> p <span class="token operator">!=</span> r <span class="token punctuation">{</span>
            a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
            <span class="token comment">// 3. find fraction from pivot value</span>
            frac <span class="token operator">:=</span> row<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">/</span> highest

            <span class="token comment">// 4. subtract row to set rest of column to zero</span>
            <span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">{</span>
                row<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> frac <span class="token operator">*</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 5. ensure col goes to zero (no float rounding)</span>
            row<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.</span>
        <span class="token punctuation">}</span>

        r<span class="token operator">++</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function-definition function">gaussian_elimination</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Matrix</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token function">min</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> a<span class="token punctuation">.</span>rows<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// find the maximum element for this column</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> max_row <span class="token operator">=</span> k<span class="token punctuation">;</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> max_value <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token punctuation">{</span>
            <span class="token keyword">if</span> max_value <span class="token operator">&lt;</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                max_value <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                max_row <span class="token operator">=</span> row<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Check to make sure the matrix is good</span>
        <span class="token keyword">if</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>max_row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Matrix is singular, aborting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// swap the row with the highest value for this kumn to the top</span>
        a<span class="token punctuation">.</span><span class="token function">swap_rows</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> max_row<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Loop over all remaining rows</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token punctuation">{</span>
            <span class="token comment">// find the fraction</span>
            <span class="token keyword">let</span> fraction <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token comment">// Loop through all columns for that row</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>cols <span class="token punctuation">{</span>
                <span class="token comment">// re-evaluate each element</span>
                a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> fraction<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// set lower elements to 0</span>
            a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div></div></div>

<p>To be clear: if the matrix is found to be singular during this process, the system of equations is either over- or under-determined and no general solution exists.
For this reason, many implementations of this method will stop the moment the matrix is found to have no unique solutions.
In this implementation, we allowed for the more general case and opted to simply output when the matrix is singular instead.
If you intend to solve a system of equations, then it makes sense to stop the method the moment you know there is no unique solution, so some small modification of this code might be necessary!</p>
<p>So what do we do from here?
Well, we continue reducing the matrix; however, there are two ways to do this:</p>
<ol>
<li>Reduce the matrix further into <em>reduced</em> row echelon form with Gauss-Jordan elimination</li>
<li>Solve the system directly with <em>back-substitution</em> if the matrix allows for such solutions</li>
</ol>
<p>Let&apos;s start with Gauss-Jordan Elimination and then back-substitution</p>
<h2 id="gauss-jordan-elimination">Gauss-Jordan Elimination</h2>
<p>Gauss-Jordan Elimination is precisely what we said above; however, in this case, we often work from the bottom-up instead of the top-down.
We basically need to find the pivot of every row and set that value to 1 by dividing the entire row by the pivot value.
Afterwards, we subtract upwards until all values above the pivot are 0 before moving on to the next column from right to left (instead of left to right, like before).
Here it is in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> gauss_jordan_elimination<span class="token operator">!</span><span class="token punctuation">(</span>A<span class="token punctuation">::</span>Array<span class="token punctuation">{</span>Float64<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    rows <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    cols <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>


    <span class="token comment"># After this, we know what row to start on (r-1)</span>
    <span class="token comment"># to go back through the matrix</span>
    row <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>cols<span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>

            <span class="token comment"># divide row by pivot and leaving pivot as 1</span>
            <span class="token keyword">for</span> i <span class="token operator">=</span> cols<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>col
                A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>col<span class="token punctuation">]</span>
            <span class="token keyword">end</span>

            <span class="token comment"># subtract value from above row and set values above pivot to 0</span>
            <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>row<span class="token operator">-</span><span class="token number">1</span>
                <span class="token keyword">for</span> j <span class="token operator">=</span> cols<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>col
                    A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token operator">*</span>A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>j<span class="token punctuation">]</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
            row <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">gauss_jordan</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> cols<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">size_t</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">/=</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            row<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token keyword">void</span> <span class="token function">gaussJordan</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token operator">&amp;</span>eqns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &apos;eqns&apos; is the (Row-echelon) matrix, &apos;rows&apos; is no. of vars</span>
  std<span class="token double-colon punctuation">::</span>size_t rows <span class="token operator">=</span> eqns<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

      eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span> <span class="token operator">/=</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// We know that the only entry in this row is 1</span>

      <span class="token comment">// subtracting rows from below</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span> <span class="token operator">-=</span> eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span><span class="token punctuation">;</span>
        eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">// We also set all the other values in row to 0 directly</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">rn</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">mat</span>
<span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token hvariable">c</span> <span class="token operator">==</span> <span class="token hvariable">cn</span> <span class="token operator">=</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token hvariable">pivot</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token hvariable">subRows</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">r</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token hvariable">rn</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">c</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span> <span class="token hvariable">m&apos;</span>
  <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token hvariable">target</span><span class="token punctuation">,</span> <span class="token hvariable">pivot</span><span class="token punctuation">)</span> <span class="token operator">=</span>
      <span class="token hvariable">maximumBy</span> <span class="token punctuation">(</span><span class="token builtin">compare</span> <span class="token operator">`on`</span> <span class="token builtin">abs</span> <span class="token operator">.</span> <span class="token builtin">snd</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token hvariable">k</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">k</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token hvariable">m&apos;</span> <span class="token operator">=</span> <span class="token hvariable">swapRows</span> <span class="token hvariable">r</span> <span class="token hvariable">target</span> <span class="token hvariable">m</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token comment"># Assumes A is already row echelon form</span>
<span class="token keyword">def</span> <span class="token function">gauss_jordan_elimination</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>

    col <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># Scan for pivots</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> col <span class="token operator">&lt;</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            col <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token keyword">if</span> col <span class="token operator">&gt;=</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        <span class="token comment"># Set each pivot to one via row scaling</span>
        A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">/=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span>

        <span class="token comment"># Zero out elements above pivot</span>
        <span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
            A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">-=</span> A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">*</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">gaussJordan</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// divide row by pivot so the pivot is set to 1</span>
                a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// subtract the value form above row and set values above pivot to 0</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            row<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">gaussJordan</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token operator">++</span>row<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">gaussJordan</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> r <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> r <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> r<span class="token operator">--</span> <span class="token punctuation">{</span>
        <span class="token comment">// Find pivot col</span>
        p <span class="token operator">:=</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">for</span> c<span class="token punctuation">,</span> cell <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> cell <span class="token operator">!=</span> <span class="token number">0.</span> <span class="token punctuation">{</span>
                p <span class="token operator">=</span> c
                <span class="token keyword">break</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> p <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            <span class="token keyword">continue</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Scale pivot r to 1.</span>
        scale <span class="token operator">:=</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span>
        <span class="token keyword">for</span> c <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
            a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token operator">+</span>c<span class="token punctuation">]</span> <span class="token operator">/=</span> scale
        <span class="token punctuation">}</span>
        <span class="token comment">// Subtract pivot row from each row above</span>
        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span><span class="token punctuation">:</span>r<span class="token punctuation">]</span> <span class="token punctuation">{</span>
            scale <span class="token operator">=</span> row<span class="token punctuation">[</span>p<span class="token punctuation">]</span>
            <span class="token keyword">for</span> c<span class="token punctuation">,</span> cell <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
                row<span class="token punctuation">[</span>p<span class="token operator">+</span>c<span class="token punctuation">]</span> <span class="token operator">-=</span> cell <span class="token operator">*</span> scale
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function-definition function">gauss_jordan</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Matrix</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span>k<span class="token punctuation">..</span>a<span class="token punctuation">.</span>cols<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span>row <span class="token punctuation">{</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span>k<span class="token punctuation">..</span>a<span class="token punctuation">.</span>cols<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            row <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div></div></div>

<p>As a note: Gauss-Jordan elimination can also be used to find the inverse of a matrix by following the same procedure to generate a reduced row echelon matrix, but with an identity matrix on the other side instead of the right-hand side of each equation.
This process is straightforward but will not be covered here, simply because there are much faster numerical methods to find an inverse matrix; however, if you would like to see this, let me know and I can add it in for completeness.</p>
<h2 id="back-substitution">Back-substitution</h2>
<p>The idea of back-substitution is straightforward: we create a matrix of solutions and iteratively solve for each variable by plugging in all variables before it.
For example, if our matrix looks like this:</p>
<p><script type="math/tex; mode=display">
\left[
\begin{array}{ccc|c}
2 & 3  & 4 & 6 \\
0 & 1 & 2 & 2 \\
0 & 0 & 11 & 18
\end{array}
\right]
</script></p>
<p>We can quickly solve <script type="math/tex; ">11z = 18</script> for <script type="math/tex; ">z</script>, and then use that to solve <script type="math/tex; ">y + 2z = 2</script> for <script type="math/tex; ">y</script> by plugging in for <script type="math/tex; ">z</script>.
After that, we simply need to solve <script type="math/tex; ">2x + 3y + 4z = 6</script> for <script type="math/tex; ">x</script> in a similar fashion.
In code, this involves keeping a rolling sum of all the values we substitute, subtracting that sum from the solution column and then dividing by the coefficient variable.
In code, it looks like this:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> back_substitution<span class="token punctuation">(</span>A<span class="token punctuation">::</span>Array<span class="token punctuation">{</span>Float64<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    rows <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    cols <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment"># Creating the solution Vector</span>
    soln <span class="token operator">=</span> zeros<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token operator">=</span> rows<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span>
        sum <span class="token operator">=</span> <span class="token number">0.0</span>
        <span class="token keyword">for</span> j <span class="token operator">=</span> rows<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>i
            sum <span class="token operator">+=</span> soln<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">*</span>A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span>
        <span class="token keyword">end</span>
        soln<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> cols<span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> i<span class="token punctuation">]</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> soln
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">back_substitution</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> rows<span class="token punctuation">,</span>
                       <span class="token keyword">const</span> <span class="token keyword">int</span> cols<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> i<span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> x<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp">std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">backSubs</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token operator">&amp;</span>eqns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &apos;eqns&apos; is matrix, &apos;rows&apos; is no. of variables</span>
  std<span class="token double-colon punctuation">::</span>size_t rows <span class="token operator">=</span> eqns<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">ans</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> sum <span class="token operator">+=</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
      ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
      <span class="token keyword">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function-definition function">back_substitution</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Matrix</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">f64</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> soln <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">;</span> a<span class="token punctuation">.</span>rows<span class="token punctuation">]</span><span class="token punctuation">;</span>

    soln<span class="token punctuation">[</span>a<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> sum <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span>i<span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> soln<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        soln<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> a<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    soln
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">gaussJordan</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Fractional</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Eq</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">gaussJordan</span> <span class="token hvariable">mat</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span> <span class="token hvariable">mat</span>
  <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">rn</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">mat</span>
    <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
      <span class="token operator">|</span> <span class="token hvariable">c</span> <span class="token operator">==</span> <span class="token hvariable">cn</span> <span class="token operator">=</span> <span class="token hvariable">m</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token comment"># Assumes A has a unique solution and A in row echelon form</span>
<span class="token keyword">def</span> <span class="token function">back_substitution</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>

    sol <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T

    <span class="token comment"># Go by pivots along diagonal</span>
    <span class="token keyword">for</span> pivot_i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>pivot_i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>  A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            s <span class="token operator">+=</span> A<span class="token punctuation">[</span>pivot_i<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">*</span> sol<span class="token punctuation">[</span>col<span class="token punctuation">]</span>
        sol<span class="token punctuation">[</span>pivot_i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>pivot_i<span class="token punctuation">,</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">)</span> <span class="token operator">/</span> A<span class="token punctuation">[</span>pivot_i<span class="token punctuation">,</span> pivot_i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> sol
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">backSubstitution</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rows <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> solution <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> i<span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> solution<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        solution<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> solution<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">backSubstitution</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rows <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> sol <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> i<span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sum <span class="token operator">+=</span> sol<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    sol<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> sol<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">backSubstitution</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token punctuation">{</span>
    rows <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    cols <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    x <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span>
    <span class="token keyword">for</span> r <span class="token operator">:=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> r <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> r<span class="token operator">--</span> <span class="token punctuation">{</span>
        sum <span class="token operator">:=</span> <span class="token number">0.</span>

        <span class="token keyword">for</span> c <span class="token operator">:=</span> cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> c <span class="token operator">&gt;</span> r<span class="token punctuation">;</span> c<span class="token operator">--</span> <span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> x<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>

        x<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>cols<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>r<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> x
<span class="token punctuation">}</span>
</code></pre>
</div></div></div>

<h2 id="visual-representation">Visual Representation</h2>
<p>We have thus far used Gaussian elimination as a method to solve a system of equations; however, there is often a much easier way to find a similar solution simply by plotting each row in our matrix.
For the case of 2 equations and 2 unknowns, we would plot the two lines corresponding to each equation and the <script type="math/tex; ">(x, y)</script> location of their point of intersection would be the solution for <script type="math/tex; ">x</script> and <script type="math/tex; ">y</script>.
Similarly, for the case of 3 equations and 3 unknowns, we would plot 3 planes and the <script type="math/tex; ">(x, y, z)</script> location of their point of intersection would be the solution for <script type="math/tex; ">x</script>, <script type="math/tex; ">y</script>, and <script type="math/tex; ">z</script>.</p>
<p>What, then, is the point of Gaussian elimination if we can simply plot our set of equations to find a solution?
Well, this analogy breaks down quickly when we start moving beyond 3D, so it is obvious we need some method to deal with higher-dimensional systems.
That said, it is particularly interesting to see what happens as we plot our matrix during Gaussian elimination for the 3D case.</p>
<div style="text-align:center">
<video style="width:70%" controls loop>
  <source src="res/GE_vis.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>
</div>

<p>As we can see in the above visualization, the planes wobble about in 3D until they reach row echelon form, where one plane is parallel to the <script type="math/tex; ">x</script> and <script type="math/tex; ">y</script> axes.
At this point, it&apos;s trivial to find the <script type="math/tex; ">z</script>-coordinate for the solution because it&apos;s simply the <script type="math/tex; ">z</script> intercept of the parallel plane.
From there, the matrices become even easier to interpret as they move to the reduced row echelon form.
In this form, the solution is simply the <script type="math/tex; ">x</script>, <script type="math/tex; ">y</script>, and <script type="math/tex; ">z</script> intercepts of the appropriate planes.</p>
<p>This visualization might have been obvious for some readers, but I found it particularly enlightening at first.
By performing Gaussian elimination, we are manipulating our planes such that they can be interpreted at a glance -- which is precisely the same thing we are doing with the matrix interpretation!</p>
<h2 id="conclusions">Conclusions</h2>
<p>And with that, we have two possible ways to reduce our system of equations and find a solution.
If we are sure our matrix is not singular and that a solution exists, it&apos;s fastest to use back-substitution to find our solution.
If no solution exists or we are trying to find a reduced row echelon matrix, then Gauss-Jordan elimination is best.
As we said at the start, the notation for Gaussian Elimination is rather ambiguous in the literature, so we are hoping that the definitions provided here are clear and consistent enough to cover all the bases.</p>
<p>As for what&apos;s next... Well, we are in for a treat!
The above algorithm clearly has 3 <code>for</code> loops and has a complexity of <script type="math/tex; ">\sim O(n^3)</script>, which is abysmal!
If we can reduce the matrix to a specifically <strong>tridiagonal</strong> matrix, we can actually solve the system in <script type="math/tex; ">\sim O(n)</script>!
How? Well, we can use an algorithm known as the <em>Tri-Diagonal Matrix Algorithm</em> (TDMA) also known as the <a href="../thomas_algorithm/thomas_algorithm.html"><em>Thomas Algorithm</em></a>.</p>
<p>There are also plenty of other solvers that do similar things that we will get to in due time.</p>
<h2 id="video-explanation">Video Explanation</h2>
<p>Here&apos;s a video describing Gaussian elimination:</p>
<div style="text-align:center">
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/2tlwSqblrvU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

<h2 id="example-code">Example Code</h2>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> gaussian_elimination<span class="token operator">!</span><span class="token punctuation">(</span>A<span class="token punctuation">::</span>Array<span class="token punctuation">{</span>Float64<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    rows <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    cols <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment"># Row index</span>
    row <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token comment"># Main loop going through all columns</span>
    <span class="token keyword">for</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">(</span>cols<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token comment"># finding the maximum element for each column</span>
        max_index <span class="token operator">=</span> argmax<span class="token punctuation">(</span>abs<span class="token punctuation">.</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>row<span class="token punctuation">:</span><span class="token keyword">end</span><span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> row<span class="token operator">-</span><span class="token number">1</span>

        <span class="token comment"># Check to make sure matrix is good!</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;matrix is singular!&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">end</span>

        <span class="token comment"># swap row with highest value for that column to the top</span>
        temp_vector <span class="token operator">=</span> A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        A<span class="token punctuation">[</span>max_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp_vector

        <span class="token comment"># Loop for all remaining rows</span>
        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>rows

            <span class="token comment"># finding fraction</span>
            fraction <span class="token operator">=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token operator">/</span>A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>col<span class="token punctuation">]</span>

            <span class="token comment"># loop through all columns for that row</span>
            <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token punctuation">(</span>col<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>cols

                 <span class="token comment"># re-evaluate each element</span>
                 A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>j<span class="token punctuation">]</span><span class="token operator">*</span>fraction

            <span class="token keyword">end</span>

            <span class="token comment"># Set lower elements to 0</span>
            A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">end</span>
        row <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> back_substitution<span class="token punctuation">(</span>A<span class="token punctuation">::</span>Array<span class="token punctuation">{</span>Float64<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    rows <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    cols <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment"># Creating the solution Vector</span>
    soln <span class="token operator">=</span> zeros<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token operator">=</span> rows<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span>
        sum <span class="token operator">=</span> <span class="token number">0.0</span>
        <span class="token keyword">for</span> j <span class="token operator">=</span> rows<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>i
            sum <span class="token operator">+=</span> soln<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">*</span>A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span>
        <span class="token keyword">end</span>
        soln<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> cols<span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> i<span class="token punctuation">]</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> soln
<span class="token keyword">end</span>


<span class="token keyword">function</span> gauss_jordan_elimination<span class="token operator">!</span><span class="token punctuation">(</span>A<span class="token punctuation">::</span>Array<span class="token punctuation">{</span>Float64<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    rows <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    cols <span class="token operator">=</span> size<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>


    <span class="token comment"># After this, we know what row to start on (r-1)</span>
    <span class="token comment"># to go back through the matrix</span>
    row <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>cols<span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>

            <span class="token comment"># divide row by pivot and leaving pivot as 1</span>
            <span class="token keyword">for</span> i <span class="token operator">=</span> cols<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>col
                A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>col<span class="token punctuation">]</span>
            <span class="token keyword">end</span>

            <span class="token comment"># subtract value from above row and set values above pivot to 0</span>
            <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>row<span class="token operator">-</span><span class="token number">1</span>
                <span class="token keyword">for</span> j <span class="token operator">=</span> cols<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>col
                    A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>col<span class="token punctuation">]</span><span class="token operator">*</span>A<span class="token punctuation">[</span>row<span class="token punctuation">,</span>j<span class="token punctuation">]</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
            row <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span>
    A <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2.</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">6</span><span class="token punctuation">;</span>
         <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span><span class="token punctuation">;</span>
         <span class="token number">3</span> <span class="token operator">-</span><span class="token number">4</span> <span class="token number">0</span> <span class="token number">10</span><span class="token punctuation">]</span>

    gaussian_elimination<span class="token operator">!</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>

    gauss_jordan_elimination<span class="token operator">!</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>

    soln <span class="token operator">=</span> back_substitution<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span>soln<span class="token punctuation">)</span>

<span class="token keyword">end</span>

main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">swap_rows</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> i<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> pivot<span class="token punctuation">,</span>
               <span class="token keyword">const</span> <span class="token class-name">size_t</span> cols<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> tmp <span class="token operator">=</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">gaussian_elimination</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> rows<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> cols<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">size_t</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">size_t</span> pivot <span class="token operator">=</span> row<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">fabs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>col <span class="token operator">!=</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">swap_rows</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> col<span class="token punctuation">,</span> pivot<span class="token punctuation">,</span> cols<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">double</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        row<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">back_substitution</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> rows<span class="token punctuation">,</span>
                       <span class="token keyword">const</span> <span class="token keyword">int</span> cols<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> i<span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> x<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">gauss_jordan</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> cols<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">size_t</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">/=</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>i <span class="token operator">*</span> cols <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            row<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                      <span class="token punctuation">{</span><span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">15.0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                      <span class="token punctuation">{</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">14.0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">gaussian_elimination</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Gaussian elimination:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;[&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%f &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;]\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\nGauss-Jordan:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">gauss_jordan</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;[&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%f &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;]\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\nSolutions are:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">double</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">back_substitution</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;(%f,%f,%f)\n&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cmath&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iomanip&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>


<span class="token keyword">void</span> <span class="token function">gaussianElimination</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token operator">&amp;</span>eqns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &apos;eqns&apos; is the matrix, &apos;rows&apos; is no. of vars</span>
  std<span class="token double-colon punctuation">::</span>size_t rows <span class="token operator">=</span> eqns<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cols <span class="token operator">=</span> eqns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      std<span class="token double-colon punctuation">::</span>size_t pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">fabs</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> pivot <span class="token operator">=</span> j<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// But continuing to simplify the matrix as much as possible</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> pivot<span class="token punctuation">)</span>  <span class="token comment">// Swapping the rows if new row with higher maxVals is found</span>
      std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">,</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// C++ swap function</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">double</span> scale <span class="token operator">=</span> eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t k <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>   <span class="token comment">// k doesn&apos;t start at 0, since</span>
        eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-=</span> scale <span class="token operator">*</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// values before from 0 to i</span>
                                           <span class="token comment">// are already 0</span>
      eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">gaussJordan</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token operator">&amp;</span>eqns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &apos;eqns&apos; is the (Row-echelon) matrix, &apos;rows&apos; is no. of vars</span>
  std<span class="token double-colon punctuation">::</span>size_t rows <span class="token operator">=</span> eqns<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

      eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span> <span class="token operator">/=</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// We know that the only entry in this row is 1</span>

      <span class="token comment">// subtracting rows from below</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span> <span class="token operator">-=</span> eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span><span class="token punctuation">;</span>
        eqns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">// We also set all the other values in row to 0 directly</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">backSubs</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token operator">&amp;</span>eqns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &apos;eqns&apos; is matrix, &apos;rows&apos; is no. of variables</span>
  std<span class="token double-colon punctuation">::</span>size_t rows <span class="token operator">=</span> eqns<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">ans</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> sum <span class="token operator">+=</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
      ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> eqns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
      <span class="token keyword">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">printMatrix</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token operator">&amp;</span>matrix<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> matrix<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;[&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> matrix<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span>
      std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>fixed <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setprecision</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
                <span class="token operator">&lt;&lt;</span> matrix<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; |&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>fixed <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setprecision</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
              <span class="token operator">&lt;&lt;</span> matrix<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; ]&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> equations<span class="token punctuation">{</span>
      <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Initial matrix:&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  <span class="token function">printMatrix</span><span class="token punctuation">(</span>equations<span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

  <span class="token function">gaussianElimination</span><span class="token punctuation">(</span>equations<span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Matrix after gaussian elimination:&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  <span class="token function">printMatrix</span><span class="token punctuation">(</span>equations<span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> ans <span class="token operator">=</span> <span class="token function">backSubs</span><span class="token punctuation">(</span>equations<span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Solution from backsubstitution&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;x = &quot;</span> <span class="token operator">&lt;&lt;</span> ans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;, y = &quot;</span> <span class="token operator">&lt;&lt;</span> ans<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;, z = &quot;</span> <span class="token operator">&lt;&lt;</span> ans<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
            <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl
            <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

  <span class="token function">gaussJordan</span><span class="token punctuation">(</span>equations<span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Matrix after Gauss Jordan:&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  <span class="token function">printMatrix</span><span class="token punctuation">(</span>equations<span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token comment">// submitted by jess 3jane</span>

<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cmp<span class="token punctuation">::</span></span>min<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Index</span><span class="token punctuation">,</span> <span class="token class-name">IndexMut</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Matrix</span> <span class="token punctuation">{</span>
    rows<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
    cols<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">f64</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Matrix</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>rows<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span> cols<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Matrix</span> <span class="token punctuation">{</span>
        <span class="token class-name">Matrix</span> <span class="token punctuation">{</span>
            rows<span class="token punctuation">,</span>
            cols<span class="token punctuation">,</span>
            data<span class="token punctuation">:</span> data<span class="token punctuation">.</span><span class="token function">to_vec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">swap_rows</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> a<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token keyword">self</span><span class="token punctuation">.</span>cols <span class="token punctuation">{</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>a <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>cols <span class="token operator">+</span> col<span class="token punctuation">,</span> b <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>cols <span class="token operator">+</span> col<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Index</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">usize</span><span class="token punctuation">,</span> <span class="token keyword">usize</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">Matrix</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token type-definition class-name">Output</span> <span class="token operator">=</span> <span class="token keyword">f64</span><span class="token punctuation">;</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">usize</span><span class="token punctuation">,</span> <span class="token keyword">usize</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">f64</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>row <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>cols <span class="token operator">+</span> col<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">IndexMut</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">usize</span><span class="token punctuation">,</span> <span class="token keyword">usize</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">Matrix</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">index_mut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">usize</span><span class="token punctuation">,</span> <span class="token keyword">usize</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">f64</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>row <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>cols <span class="token operator">+</span> col<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">gaussian_elimination</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Matrix</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token function">min</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> a<span class="token punctuation">.</span>rows<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// find the maximum element for this column</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> max_row <span class="token operator">=</span> k<span class="token punctuation">;</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> max_value <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token punctuation">{</span>
            <span class="token keyword">if</span> max_value <span class="token operator">&lt;</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                max_value <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                max_row <span class="token operator">=</span> row<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Check to make sure the matrix is good</span>
        <span class="token keyword">if</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>max_row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Matrix is singular, aborting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// swap the row with the highest value for this kumn to the top</span>
        a<span class="token punctuation">.</span><span class="token function">swap_rows</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> max_row<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Loop over all remaining rows</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token punctuation">{</span>
            <span class="token comment">// find the fraction</span>
            <span class="token keyword">let</span> fraction <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token comment">// Loop through all columns for that row</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>cols <span class="token punctuation">{</span>
                <span class="token comment">// re-evaluate each element</span>
                a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> fraction<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// set lower elements to 0</span>
            a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">gauss_jordan</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Matrix</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span>k<span class="token punctuation">..</span>a<span class="token punctuation">.</span>cols<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span>row <span class="token punctuation">{</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span>k<span class="token punctuation">..</span>a<span class="token punctuation">.</span>cols<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            row <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">back_substitution</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Matrix</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">f64</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> soln <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">;</span> a<span class="token punctuation">.</span>rows<span class="token punctuation">]</span><span class="token punctuation">;</span>

    soln<span class="token punctuation">[</span>a<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> sum <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span>i<span class="token punctuation">..</span>a<span class="token punctuation">.</span>rows<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> soln<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        soln<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> a<span class="token punctuation">.</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    soln
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The example matrix from the text</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> a <span class="token operator">=</span> <span class="token class-name">Matrix</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>
        <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token operator">&amp;</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">6.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">10.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">gaussian_elimination</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">gauss_jordan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> soln <span class="token operator">=</span> <span class="token function">back_substitution</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Solution: {:?}&quot;</span><span class="token punctuation">,</span> soln<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Array</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Function</span> <span class="token punctuation">(</span><span class="token hvariable">on</span><span class="token punctuation">)</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>List</span> <span class="token punctuation">(</span><span class="token hvariable">intercalate</span><span class="token punctuation">,</span> <span class="token hvariable">maximumBy</span><span class="token punctuation">)</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Ratio</span>

<span class="token keyword">type</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">=</span> <span class="token constant">Array</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token hvariable">a</span>

<span class="token keyword">type</span> <span class="token constant">Vector</span> <span class="token hvariable">a</span> <span class="token operator">=</span> <span class="token constant">Array</span> <span class="token constant">Int</span> <span class="token hvariable">a</span>

<span class="token hvariable">swapRows</span> <span class="token operator">::</span> <span class="token constant">Int</span> <span class="token operator">-&gt;</span> <span class="token constant">Int</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">swapRows</span> <span class="token hvariable">r1</span> <span class="token hvariable">r2</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token hvariable">r1</span> <span class="token operator">==</span> <span class="token hvariable">r2</span> <span class="token operator">=</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span>
    <span class="token hvariable">m</span> <span class="token operator">//</span>
    <span class="token builtin">concat</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r2</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r2</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token hvariable">c</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">c1</span> <span class="token operator">..</span> <span class="token hvariable">cn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">m</span>

<span class="token hvariable">subRows</span> <span class="token operator">::</span>
     <span class="token constant">Fractional</span> <span class="token hvariable">a</span>
  <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- pivot location</span>
  <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- rows to cover</span>
  <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token comment">-- columns to cover</span>
  <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
  <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">subRows</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">rn</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">c1</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span> <span class="token hvariable">m</span> <span class="token operator">=</span>
  <span class="token hvariable">accum</span>
    <span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">)</span>
    <span class="token hvariable">m</span>
    <span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">i</span><span class="token punctuation">,</span> <span class="token hvariable">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">i</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">j</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">|</span> <span class="token hvariable">i</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r1</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span>
    <span class="token punctuation">,</span> <span class="token hvariable">j</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">c1</span> <span class="token operator">..</span> <span class="token hvariable">cn</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>

<span class="token hvariable">gaussianElimination</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Fractional</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Ord</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">gaussianElimination</span> <span class="token hvariable">mat</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span> <span class="token hvariable">mat</span>
  <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">rn</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">mat</span>
    <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
      <span class="token operator">|</span> <span class="token hvariable">c</span> <span class="token operator">==</span> <span class="token hvariable">cn</span> <span class="token operator">=</span> <span class="token hvariable">m</span>
      <span class="token operator">|</span> <span class="token hvariable">pivot</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
      <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token hvariable">subRows</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">r</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token hvariable">rn</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">c</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span> <span class="token hvariable">m&apos;</span>
      <span class="token keyword">where</span>
        <span class="token punctuation">(</span><span class="token hvariable">target</span><span class="token punctuation">,</span> <span class="token hvariable">pivot</span><span class="token punctuation">)</span> <span class="token operator">=</span>
          <span class="token hvariable">maximumBy</span> <span class="token punctuation">(</span><span class="token builtin">compare</span> <span class="token operator">`on`</span> <span class="token builtin">abs</span> <span class="token operator">.</span> <span class="token builtin">snd</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token hvariable">k</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">k</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token hvariable">m&apos;</span> <span class="token operator">=</span> <span class="token hvariable">swapRows</span> <span class="token hvariable">r</span> <span class="token hvariable">target</span> <span class="token hvariable">m</span>

<span class="token hvariable">gaussJordan</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Fractional</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Eq</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span>
<span class="token hvariable">gaussJordan</span> <span class="token hvariable">mat</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span> <span class="token hvariable">mat</span>
  <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">rn</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">mat</span>
    <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
      <span class="token operator">|</span> <span class="token hvariable">c</span> <span class="token operator">==</span> <span class="token hvariable">cn</span> <span class="token operator">=</span> <span class="token hvariable">m</span>
      <span class="token operator">|</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
      <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">go</span> <span class="token punctuation">(</span><span class="token hvariable">r</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token hvariable">c</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token hvariable">subRows</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">r</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">c</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span> <span class="token hvariable">m&apos;</span>
      <span class="token keyword">where</span>
        <span class="token hvariable">m&apos;</span> <span class="token operator">=</span> <span class="token hvariable">accum</span> <span class="token punctuation">(</span><span class="token operator">/</span><span class="token punctuation">)</span> <span class="token hvariable">m</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">j</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">c</span> <span class="token operator">..</span> <span class="token hvariable">cn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token hvariable">backSubstitution</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Fractional</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Vector</span> <span class="token hvariable">a</span>
<span class="token hvariable">backSubstitution</span> <span class="token hvariable">m</span> <span class="token operator">=</span> <span class="token hvariable">sol</span>
  <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">rn</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">m</span>
    <span class="token hvariable">sol</span> <span class="token operator">=</span>
      <span class="token hvariable">listArray</span> <span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">rn</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">sum</span>&apos; <span class="token hvariable">r</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">r</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">r</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r1</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token builtin">sum</span>&apos; <span class="token hvariable">r</span> <span class="token operator">=</span> <span class="token builtin">sum</span> <span class="token punctuation">[</span><span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">k</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">sol</span> <span class="token operator">!</span> <span class="token hvariable">k</span> <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token hvariable">printM</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Show</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">Matrix</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">String</span>
<span class="token hvariable">printM</span> <span class="token hvariable">m</span> <span class="token operator">=</span>
  <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">r1</span><span class="token punctuation">,</span> <span class="token hvariable">c1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">rn</span><span class="token punctuation">,</span> <span class="token hvariable">cn</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bounds</span> <span class="token hvariable">m</span>
   <span class="token keyword">in</span> <span class="token builtin">unlines</span>
        <span class="token punctuation">[</span> <span class="token hvariable">intercalate</span> <span class="token string">&quot;\t&quot;</span> <span class="token punctuation">[</span><span class="token builtin">show</span> <span class="token operator">$</span> <span class="token hvariable">m</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">r</span><span class="token punctuation">,</span> <span class="token hvariable">c</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">c</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">c1</span> <span class="token operator">..</span> <span class="token hvariable">cn</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token operator">|</span> <span class="token hvariable">r</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token hvariable">r1</span> <span class="token operator">..</span> <span class="token hvariable">rn</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>

<span class="token hvariable">printV</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Show</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">Vector</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">String</span>
<span class="token hvariable">printV</span> <span class="token operator">=</span> <span class="token builtin">unlines</span> <span class="token operator">.</span> <span class="token builtin">map</span> <span class="token builtin">show</span> <span class="token operator">.</span> <span class="token hvariable">elems</span>

<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token keyword">let</span> <span class="token hvariable">mat</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">Ratio</span> <span class="token constant">Int</span><span class="token punctuation">]</span>
      <span class="token hvariable">m</span> <span class="token operator">=</span> <span class="token hvariable">listArray</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">mat</span>
  <span class="token builtin">putStrLn</span> <span class="token string">&quot;Original Matrix:&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token hvariable">printM</span> <span class="token hvariable">m</span>
  <span class="token builtin">putStrLn</span> <span class="token string">&quot;Echelon form&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token hvariable">printM</span> <span class="token operator">$</span> <span class="token hvariable">gaussianElimination</span> <span class="token hvariable">m</span>
  <span class="token builtin">putStrLn</span> <span class="token string">&quot;Reduced echelon form&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token hvariable">printM</span> <span class="token operator">$</span> <span class="token hvariable">gaussJordan</span> <span class="token operator">$</span> <span class="token hvariable">gaussianElimination</span> <span class="token hvariable">m</span>
  <span class="token builtin">putStrLn</span> <span class="token string">&quot;Solution from back substitution&quot;</span>
  <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token hvariable">printV</span> <span class="token operator">$</span> <span class="token hvariable">backSubstitution</span> <span class="token operator">$</span> <span class="token hvariable">gaussianElimination</span> <span class="token hvariable">m</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">def</span> <span class="token function">gaussian_elimination</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>

    pivot_row <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># Go by column</span>
    <span class="token keyword">for</span> pivot_col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># Swap row with highest element in col</span>
        max_i <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">:</span><span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> pivot_row

        temp <span class="token operator">=</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>max_i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        A<span class="token punctuation">[</span>max_i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp

        <span class="token comment"># Skip on singular matrix,  not actually a pivot</span>
        <span class="token keyword">if</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        <span class="token comment"># Zero out elements below pivot</span>
        <span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>pivot_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>  A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># Get fraction</span>
            frac <span class="token operator">=</span> <span class="token operator">-</span>A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span> <span class="token operator">/</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> pivot_col<span class="token punctuation">]</span>
            <span class="token comment"># Add rows</span>
            A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+=</span> frac <span class="token operator">*</span> A<span class="token punctuation">[</span>pivot_row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>

        pivot_row <span class="token operator">+=</span> <span class="token number">1</span>


<span class="token comment"># Assumes A is already row echelon form</span>
<span class="token keyword">def</span> <span class="token function">gauss_jordan_elimination</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>

    col <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># Scan for pivots</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> col <span class="token operator">&lt;</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            col <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token keyword">if</span> col <span class="token operator">&gt;=</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        <span class="token comment"># Set each pivot to one via row scaling</span>
        A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">/=</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span>

        <span class="token comment"># Zero out elements above pivot</span>
        <span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
            A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">-=</span> A<span class="token punctuation">[</span>r<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">*</span> A<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>


<span class="token comment"># Assumes A has a unique solution and A in row echelon form</span>
<span class="token keyword">def</span> <span class="token function">back_substitution</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>

    sol <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T

    <span class="token comment"># Go by pivots along diagonal</span>
    <span class="token keyword">for</span> pivot_i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>pivot_i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>  A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            s <span class="token operator">+=</span> A<span class="token punctuation">[</span>pivot_i<span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">*</span> sol<span class="token punctuation">[</span>col<span class="token punctuation">]</span>
        sol<span class="token punctuation">[</span>pivot_i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>pivot_i<span class="token punctuation">,</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">)</span> <span class="token operator">/</span> A<span class="token punctuation">[</span>pivot_i<span class="token punctuation">,</span> pivot_i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> sol


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    A <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Original&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>

    gaussian_elimination<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Gaussian elimination&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Back subsitution&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>back_substitution<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>

    gauss_jordan_elimination<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Gauss-Jordan&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GaussianElimination</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">gaussianElimination</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> rows <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">int</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> pivot <span class="token operator">=</span> row<span class="token punctuation">;</span>

            <span class="token comment">// finding the maximum element</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">!=</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Swap the row with the highest valued element</span>
                <span class="token comment">// with the current row</span>
                <span class="token function">swapRow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> col<span class="token punctuation">,</span> pivot<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// finding the inverse</span>
                <span class="token keyword">double</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token comment">// loop through all columns in current row</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token comment">// Subtract rows</span>
                    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Set lower elements to 0</span>
                a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            row<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">gaussJordan</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// divide row by pivot so the pivot is set to 1</span>
                    a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// subtract the value form above row and set values above pivot to 0</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                row<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">backSubstitution</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> rows <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">int</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> solution <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">[</span>rows<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> i<span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                sum <span class="token operator">+=</span> solution<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            solution<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> solution<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">swapRow</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> rowA<span class="token punctuation">,</span> <span class="token keyword">int</span> rowB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> temp <span class="token operator">=</span> a<span class="token punctuation">[</span>rowA<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span>rowA<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>rowB<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span>rowB<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token function">gaussianElimination</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Gaussian elimination:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">gaussJordan</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\nGauss-Jordan:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\nSolutions:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token function">backSubstitution</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">gaussianElimination</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rows <span class="token operator">=</span> a<span class="token punctuation">.</span>length
  <span class="token keyword">const</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length
  <span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> pivot <span class="token operator">=</span> row<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pivot <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;The matrix is singular.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>col <span class="token operator">!==</span> pivot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> t <span class="token operator">=</span> a<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
      a<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span><span class="token punctuation">;</span>
      a<span class="token punctuation">[</span>pivot<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> scale <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token operator">++</span>row<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">backSubstitution</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rows <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> sol <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> i<span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sum <span class="token operator">+=</span> sol<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    sol<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> sol<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">gaussJordan</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cols <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token operator">++</span>row<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">printMatrixRow</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> text <span class="token operator">=</span> row
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>v <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">&quot; &quot;</span> <span class="token operator">:</span> <span class="token string">&quot;  &quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> v<span class="token punctuation">.</span><span class="token function">toPrecision</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">printMatrix</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> row <span class="token keyword">of</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">printMatrixRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token function">gaussianElimination</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Gaussian elimination:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printMatrix</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">gaussJordan</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;\nGauss-Jordan:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printMatrix</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> sol <span class="token operator">=</span> <span class="token function">backSubstitution</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;\nSolutions are:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printMatrixRow</span><span class="token punctuation">(</span>sol<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div><div class="code-method-sample" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token comment">// Package demonstrates Gaussian Elimination</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;math&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">gaussianElimination</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    singular <span class="token operator">:=</span> <span class="token boolean">false</span>
    rows <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    cols <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> c<span class="token punctuation">,</span> r <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> cols <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> c<span class="token operator">++</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1. find highest value in column below row to be pivot</span>
        p<span class="token punctuation">,</span> highest <span class="token operator">:=</span> r<span class="token punctuation">,</span> <span class="token number">0.</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> abs <span class="token operator">:=</span> math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> abs <span class="token operator">&gt;</span> highest <span class="token punctuation">{</span>
                p <span class="token operator">=</span> r <span class="token operator">+</span> i
                highest <span class="token operator">=</span> abs
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        highest <span class="token operator">=</span> a<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token comment">// correct sign</span>

        <span class="token keyword">if</span> highest <span class="token operator">==</span> <span class="token number">0.</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token operator">!</span>singular <span class="token punctuation">{</span>
                singular <span class="token operator">=</span> <span class="token boolean">true</span>
                fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;This matrix is singular.&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">continue</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 2. swap pivot with current row</span>
        <span class="token keyword">if</span> p <span class="token operator">!=</span> r <span class="token punctuation">{</span>
            a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
            <span class="token comment">// 3. find fraction from pivot value</span>
            frac <span class="token operator">:=</span> row<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">/</span> highest

            <span class="token comment">// 4. subtract row to set rest of column to zero</span>
            <span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">{</span>
                row<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> frac <span class="token operator">*</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 5. ensure col goes to zero (no float rounding)</span>
            row<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.</span>
        <span class="token punctuation">}</span>

        r<span class="token operator">++</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">gaussJordan</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> r <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> r <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> r<span class="token operator">--</span> <span class="token punctuation">{</span>
        <span class="token comment">// Find pivot col</span>
        p <span class="token operator">:=</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">for</span> c<span class="token punctuation">,</span> cell <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> cell <span class="token operator">!=</span> <span class="token number">0.</span> <span class="token punctuation">{</span>
                p <span class="token operator">=</span> c
                <span class="token keyword">break</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> p <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            <span class="token keyword">continue</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Scale pivot r to 1.</span>
        scale <span class="token operator">:=</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span>
        <span class="token keyword">for</span> c <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
            a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token operator">+</span>c<span class="token punctuation">]</span> <span class="token operator">/=</span> scale
        <span class="token punctuation">}</span>
        <span class="token comment">// Subtract pivot row from each row above</span>
        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span><span class="token punctuation">:</span>r<span class="token punctuation">]</span> <span class="token punctuation">{</span>
            scale <span class="token operator">=</span> row<span class="token punctuation">[</span>p<span class="token punctuation">]</span>
            <span class="token keyword">for</span> c<span class="token punctuation">,</span> cell <span class="token operator">:=</span> <span class="token keyword">range</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
                row<span class="token punctuation">[</span>p<span class="token operator">+</span>c<span class="token punctuation">]</span> <span class="token operator">-=</span> cell <span class="token operator">*</span> scale
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">backSubstitution</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span> <span class="token punctuation">{</span>
    rows <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    cols <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    x <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span>
    <span class="token keyword">for</span> r <span class="token operator">:=</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> r <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> r<span class="token operator">--</span> <span class="token punctuation">{</span>
        sum <span class="token operator">:=</span> <span class="token number">0.</span>

        <span class="token keyword">for</span> c <span class="token operator">:=</span> cols <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> c <span class="token operator">&gt;</span> r<span class="token punctuation">;</span> c<span class="token operator">--</span> <span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> x<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>

        x<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>cols<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">)</span> <span class="token operator">/</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>r<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> x
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">printMatrixRow</span><span class="token punctuation">(</span>row <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;[&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> cell <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%9.4f &quot;</span><span class="token punctuation">,</span> cell<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">printMatrix</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> a <span class="token punctuation">{</span>
        <span class="token function">printMatrixRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">{</span>
        <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Original Matrix:&quot;</span><span class="token punctuation">)</span>
    <span class="token function">printMatrix</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Gaussian elimination:&quot;</span><span class="token punctuation">)</span>
    <span class="token function">gaussianElimination</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token function">printMatrix</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

    <span class="token function">gaussJordan</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Gauss-Jordan:&quot;</span><span class="token punctuation">)</span>
    <span class="token function">printMatrix</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Solutions are:&quot;</span><span class="token punctuation">)</span>
    x <span class="token operator">:=</span> <span class="token function">backSubstitution</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token function">printMatrixRow</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div></div></div>


<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

<h2 id="license">License</h2>
<h5 id="code-examples">Code Examples</h5>
<p>The code examples are licensed under the MIT license (found in <a href="https://github.com/algorithm-archivists/algorithm-archive/blob/main/LICENSE.md" target="_blank">LICENSE.md</a>).</p>
<h5 id="text">Text</h5>
<p>The text of this chapter was written by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><p><img class="center" src="../cc/CC-BY-SA_icon.svg"></p></a></p>
<h5 id="imagesgraphics">Images/Graphics</h5>
<ul>
<li>The animation &quot;<a href="res/GE_vis.mp4">GEvis</a>&quot; was created by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</li>
</ul>
<h5 id="pull-requests">Pull Requests</h5>
<p>After initial licensing (<a href="https://github.com/algorithm-archivists/algorithm-archive/pull/560" target="_blank">#560</a>), the following pull requests have modified the text or graphics of this chapter:</p>
<ul>
<li>none</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../matrix_methods/matrix_methods.html" class="navigation navigation-prev " aria-label="Previous page: Matrix Methods">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../thomas_algorithm/thomas_algorithm.html" class="navigation navigation-next " aria-label="Next page: Thomas Algorithm">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Gaussian Elimination","level":"1.10.1","depth":2,"next":{"title":"Thomas Algorithm","level":"1.10.2","depth":2,"path":"contents/thomas_algorithm/thomas_algorithm.md","ref":"contents/thomas_algorithm/thomas_algorithm.md","articles":[]},"previous":{"title":"Matrix Methods","level":"1.10","depth":1,"path":"contents/matrix_methods/matrix_methods.md","ref":"contents/matrix_methods/matrix_methods.md","articles":[{"title":"Gaussian Elimination","level":"1.10.1","depth":2,"path":"contents/gaussian_elimination/gaussian_elimination.md","ref":"contents/gaussian_elimination/gaussian_elimination.md","articles":[]},{"title":"Thomas Algorithm","level":"1.10.2","depth":2,"path":"contents/thomas_algorithm/thomas_algorithm.md","ref":"contents/thomas_algorithm/thomas_algorithm.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["mathjax@https://github.com/algorithm-archivists/plugin-mathjax","bibtex-cite","wordcount","api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git","include-codeblock","bulk-redirect","prism","-highlight"],"root":"./","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"bash","name":"Bash"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"c8","name":"chip-8"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"},{"lang":"ti83b","name":"TI-83 Basic"},{"lang":"lua","name":"Lua"},{"lang":"crystal","name":"Crystal"},{"lang":"php","name":"PHP"},{"lang":"lisp","name":"Common Lisp"},{"lang":"nim","name":"Nim"},{"lang":"asm-x64","name":"X86-64 Assembly"},{"lang":"f90","name":"Fortran90"},{"lang":"factor","name":"Factor"},{"lang":"ws","name":"Whitespace"},{"lang":"scala","name":"Scala"},{"lang":"emojic","name":"Emojicode"},{"lang":"lolcode","name":"LOLCODE"},{"lang":"piet","name":"Piet"},{"lang":"ss","name":"Scheme"},{"lang":"ps1","name":"PowerShell"},{"lang":"v","name":"Vlang"},{"lang":"coffee","name":"CoffeeScript"},{"lang":"kotlin","name":"Kotlin"},{"lang":"ts","name":"TypeScript"},{"lang":"vim","name":"VimL"},{"lang":"coco","name":"Coconut"},{"lang":"dart","name":"Dart"}]},"prism":{"lang":{"asm-x64":"nasm"},"ignore":["emojicode","text"],"css":["prismjs/themes/prism-tomorrow.css"]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"bibtex-cite":{},"mathjax":{"forceSVG":false,"version":"2.6.1"},"include-codeblock":{"check":false,"edit":false,"lang":"","fixlang":true,"template":"default","theme":"chrome","unindent":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"honkit":">= 3.0.0","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"title":"Arcane Algorithm Archive","bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}},{"citationKey":"GNUPLOT","entryType":"MISC","entryTags":{"TITLE":"Gnuplot 5.0: An Interactive Plotting Program, Official Gnuplot Documentation","AUTHOR":"Williams, T and Kelley, C","YEAR":"2015"}},{"citationKey":"BEDE725","entryType":"BOOK","entryTags":{"TITLE":"Bede, the Reckoning of Time","AUTHOR":"Venerabilis, Beda and others","VOLUME":"29","YEAR":"1999","PUBLISHER":"Liverpool University Press"}},{"citationKey":"DICTCOMPUTUS","entryType":"MISC","entryTags":{"TITLE":"Dictionary.com definition of computus","URL":"https://www.merriam-webster.com/dictionary/computus","YEAR":"2020"}},{"citationKey":"COMPUTUS1876","entryType":"ARTICLE","entryTags":{"TITLE":"To find Easter: a new York correspondent sends us the following","AUTHOR":"unknown","JOURNAL":"Nature","YEAR":"1876"}},{"citationKey":"BIEN2004","entryType":"ARTICLE","entryTags":{"TITLE":"Gauss and beyond: The making of Easter algorithms","AUTHOR":"Bien, Reinhold","JOURNAL":"Archive for history of exact sciences","VOLUME":"58","NUMBER":"5","PAGES":"439--452","YEAR":"2004","PUBLISHER":"Springer"}},{"citationKey":"SERVOIS","entryType":"INPROCEEDINGS","entryTags":{"TITLE":"84 Calendrier","AUTHOR":"Servois, M","BOOKTITLE":"Annales de MathÃ©matiques pures et appliquÃ©es","VOLUME":"4","NUMBER":"1813-1814","PAGES":"84--90"}},{"citationKey":"STANDISH2004","entryType":"ARTICLE","entryTags":{"TITLE":"The astronomical unit now","AUTHOR":"Standish, EM","JOURNAL":"Proceedings of the International Astronomical Union","VOLUME":"2004","NUMBER":"IAUC196","PAGES":"163--179","YEAR":"2004","PUBLISHER":"Cambridge University Press"}},{"citationKey":"LUNAR_MONTH_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Lunar Month","URL":"https://en.wikipedia.org/wiki/Lunar_month","YEAR":"2020"}},{"citationKey":"SELF-SIMILAR","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Self-similarity","URL":"https://en.wikipedia.org/wiki/Self-similarity","YEAR":"2019"}},{"citationKey":"HAUSDORFF","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hausdorff dimension","URL":"https://en.wikipedia.org/wiki/Hausdorff_dimension","YEAR":"2019"}},{"citationKey":"3B1BFRACTAL","entryType":"MISC","entryTags":{"AUTHOR":"Sanderson, G","TITLE":"3blue1brown: Fractals are typically not self-similar","URL":"https://www.youtube.com/watch?v=gB9n2gHsHN4","YEAR":"2017"}},{"citationKey":"MANDELBROT1983FRACTAL","entryType":"BOOK","entryTags":{"TITLE":"The fractal geometry of nature","AUTHOR":"Mandelbrot, Benoit B","VOLUME":"173","YEAR":"1983","PUBLISHER":"WH freeman New York"}},{"citationKey":"MANDELBROT1967LONG","entryType":"ARTICLE","entryTags":{"TITLE":"How long is the coast of Britain? Statistical self-similarity and fractional dimension","AUTHOR":"Mandelbrot, Benoit","JOURNAL":"science","VOLUME":"156","NUMBER":"3775","PAGES":"636--638","YEAR":"1967","PUBLISHER":"American Association for the Advancement of Science"}},{"citationKey":"JAMPOUR2010NEW","entryType":"ARTICLE","entryTags":{"TITLE":"A new fast technique for fingerprint identification with fractal and chaos game theory","AUTHOR":"Jampour, Mahdi and Yaghoobi, Mahdi and Ashourzadeh, Maryam and Soleimani, Adel","JOURNAL":"Fractals","VOLUME":"18","NUMBER":"03","PAGES":"293--300","YEAR":"2010","PUBLISHER":"World Scientific"}},{"citationKey":"FRACTAL-COMPRESSION","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Fractal Compression","URL":"https://en.wikipedia.org/wiki/Fractal_compression","YEAR":"2019"}},{"citationKey":"SAUPE1994REVIEW","entryType":"ARTICLE","entryTags":{"TITLE":"A review of the fractal image compression literature","AUTHOR":"Saupe, Dietmar and Hamzaoui, Raouf","JOURNAL":"ACM SIGGRAPH Computer Graphics","VOLUME":"28","NUMBER":"4","PAGES":"268--276","YEAR":"1994","PUBLISHER":"ACM"}},{"citationKey":"GNEITING2012ESTIMATORS","entryType":"ARTICLE","entryTags":{"TITLE":"Estimators of fractal dimension: Assessing the roughness of time series and spatial data","AUTHOR":"Gneiting, Tilmann and Å evÄÃ­kovÃ¡, Hana and Percival, Donald B","JOURNAL":"Statistical Science","PAGES":"247--277","YEAR":"2012","PUBLISHER":"JSTOR"}},{"citationKey":"HUTCHINSON1981FRACTALS","entryType":"ARTICLE","entryTags":{"TITLE":"Fractals and self similarity","AUTHOR":"Hutchinson, John E","JOURNAL":"Indiana University Mathematics Journal","VOLUME":"30","NUMBER":"5","PAGES":"713--747","YEAR":"1981","PUBLISHER":"JSTOR"}},{"citationKey":"HUTCHINSON-OPERATOR","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hutchinson Operator","URL":"https://en.wikipedia.org/wiki/Hutchinson_operator","YEAR":"2019"}},{"citationKey":"CHAOS-GAME","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Chaos Game","URL":"https://en.wikipedia.org/wiki/Chaos_game","YEAR":"2019"}},{"citationKey":"CHAOS-GAME-WOLF","entryType":"MISC","entryTags":{"TITLE":"Wolfram: Chaos Game","URL":"http://mathworld.wolfram.com/ChaosGame.html","YEAR":"2019"}},{"citationKey":"BARNSLEY2014FRACTALS","entryType":"BOOK","entryTags":{"TITLE":"Fractals everywhere","AUTHOR":"Barnsley, Michael F","YEAR":"2014","PUBLISHER":"Academic press"}},{"citationKey":"HSV","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: HSL and HSV","URL":"https://en.wikipedia.org/wiki/HSL_and_HSV","YEAR":"2020"}},{"citationKey":"SCHLOSS2019","entryType":"ARTICLE","entryTags":{"TITLE":"Massively parallel split-step Fourier techniques for simulating quantum systems on graphics processing units","AUTHOR":"Schloss, James","YEAR":"2019"}},{"citationKey":"PETHICK2008","entryType":"BOOK","entryTags":{"TITLE":"Bose--Einstein condensation in dilute gases","AUTHOR":"Pethick, Christopher J and Smith, Henrik","YEAR":"2008","PUBLISHER":"Cambridge university press"}},{"citationKey":"WEGERT2012","entryType":"BOOK","entryTags":{"TITLE":"Visual complex functions: an introduction with phase portraits","AUTHOR":"Wegert, Elias","YEAR":"2012","PUBLISHER":"Springer Science \\& Business Media"}},{"citationKey":"POELKEDOMAIN","entryType":"ARTICLE","entryTags":{"TITLE":"Domain Coloring of Complex Functions","AUTHOR":"Poelke, Konstantin and Polthier, Konrad"}},{"citationKey":"LUNDMARK2004","entryType":"ARTICLE","entryTags":{"TITLE":"Visualizing complex analytic functions using domain coloring","AUTHOR":"Lundmark, Hans","JOURNAL":"Recuperado el","VOLUME":"24","YEAR":"2004"}},{"citationKey":"GIMP_BUCKET","entryType":"MISC","entryTags":{"TITLE":"Bucket Fill in Gimp","URL":"https://docs.gimp.org/2.10/en/gimp-tool-bucket-fill.html","YEAR":"2020"}},{"citationKey":"TORBERT2016","entryType":"BOOK","entryTags":{"TITLE":"Applied computer science","AUTHOR":"Torbert, Shane","YEAR":"2016","PAGES":"158","PUBLISHER":"Springer"}},{"citationKey":"CANNY1986COMPUTATIONAL","entryType":"ARTICLE","entryTags":{"TITLE":"A computational approach to edge detection","AUTHOR":"Canny, John","JOURNAL":"IEEE Transactions on pattern analysis and machine intelligence","NUMBER":"6","PAGES":"679--698","YEAR":"1986","PUBLISHER":"Ieee"}},{"citationKey":"MORRIS1978COUNTING","entryType":"ARTICLE","entryTags":{"TITLE":"Counting large numbers of events in small registers","AUTHOR":"Morris, R","JOURNAL":"Communications of the ACM","VOLUME":"21","NUMBER":"10","PAGES":"840--842","YEAR":"1978","PUBLISHER":"ACM New York, NY, USA"}},{"citationKey":"FLAJOLET1985APPROXIMATE","entryType":"ARTICLE","entryTags":{"TITLE":"Approximate counting: a detailed analysis","AUTHOR":"Flajolet, P","JOURNAL":"BIT Numerical Mathematics","VOLUME":"25","NUMBER":"1","PAGES":"113--134","YEAR":"1985","PUBLISHER":"Springer"}},{"citationKey":"ARPIT_COUNTING","entryType":"MISC","entryTags":{"TITLE":"Morris's Algorithm for Approximate Counting","AUTHOR":"Bhayani, A","URL":"https://arpitbhayani.me/blogs/morris-counter","YEAR":"2020"}},{"citationKey":"GREGGUNDERSON_COUNTING","entryType":"MISC","entryTags":{"TITLE":"Approximate Counting with Morris's Algorithm","AUTHOR":"Gundersen, G","URL":"http://gregorygundersen.com/blog/2019/11/11/morris-algorithm/","YEAR":"2019"}},{"citationKey":"3B1B_FINGER_COUNT","entryType":"MISC","entryTags":{"TITLE":"How to count to 1000 on two hands","AUTHOR":"Sanderson, G","URL":"https://youtu.be/1SMmc9gQmHQ","YEAR":"2015"}},{"citationKey":"METROPOLIS1953EQUATION","entryType":"ARTICLE","entryTags":{"PAGES":"1087-1092","EPRINT":"https://doi.org/10.1063/1.1699114\n    \n","NUMBER":"6","AUTHOR":"Metropolis,Nicholas  and Rosenbluth,Arianna W.  and Rosenbluth,Marshall N.  and Teller,Augusta H.  and Teller,Edward ","URL":"https://doi.org/10.1063/1.1699114\n    \n","JOURNAL":"The Journal of Chemical Physics","TITLE":"Equation of State Calculations by Fast Computing Machines","VOLUME":"21","YEAR":"1953","DOI":"10.1063/1.1699114"}},{"citationKey":"ROSENTHAL2011OPTIMAL","entryType":"ARTICLE","entryTags":{"TITLE":"Optimal proposal distributions and adaptive MCMC","AUTHOR":"Rosenthal, Jeffrey S and others","JOURNAL":"Handbook of Markov Chain Monte Carlo","VOLUME":"4","NUMBER":"10.1201","YEAR":"2011","PUBLISHER":"Chapman & Hall/CRC Boca Raton, FL"}},{"citationKey":"GARETH2001OPTIMAL","entryType":"ARTICLE","entryTags":{"PAGES":"351 -- 367","NUMBER":"4","AUTHOR":"Gareth O. Roberts and Jeffrey S. Rosenthal","URL":"https://doi.org/10.1214/ss/1015346320","JOURNAL":"Statistical Science","TITLE":"Optimal scaling for various Metropolis-Hastings algorithms","VOLUME":"16","PUBLISHER":"Institute of Mathematical Statistics","YEAR":"2001","DOI":"10.1214/ss/1015346320"}},{"citationKey":"POTENTIAL_ENERGY_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Potential Energy","URL":"https://en.wikipedia.org/wiki/Potential_energy","YEAR":"2021"}},{"citationKey":"LUDWIG_BOLTZMANN_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Ludwig Boltzmann","URL":"https://en.wikipedia.org/wiki/Ludwig_Boltzmann","YEAR":"2021"}},{"citationKey":"BOLTZMANN_DISTRIBUTION_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Boltzmann distribution","URL":"https://en.wikipedia.org/wiki/Boltzmann_distribution","YEAR":"2021"}},{"citationKey":"HASTINGS1970MONTE","entryType":"ARTICLE","entryTags":{"MONTH":"04","ABSTRACT":"{A generalization of the sampling method introduced by Metropolis et al. (1953) is presented along with an exposition of the relevant theory, techniques of application and methods and difficulties of assessing the error in Monte Carlo estimates. Examples of the methods, including the generation of random orthogonal matrices and potential applications of the methods to numerical problems arising in statistics, are discussed.}","PAGES":"97-109","ISSN":"0006-3444","EPRINT":"https://academic.oup.com/biomet/article-pdf/57/1/97/23940249/57-1-97.pdf","NUMBER":"1","AUTHOR":"Hastings, W. K.","URL":"https://doi.org/10.1093/biomet/57.1.97","JOURNAL":"Biometrika","TITLE":"Monte Carlo sampling methods using Markov chains and their applications","VOLUME":"57","YEAR":"1970","DOI":"10.1093/biomet/57.1.97"}},{"citationKey":"MALA_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Metropolis-adjusted Langevin Algorithm","URL":"https://en.wikipedia.org/wiki/Metropolis-adjusted_Langevin_algorithm","YEAR":"2021"}},{"citationKey":"HMC_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Hamiltonian Monte Carlo","URL":"https://en.wikipedia.org/wiki/Hamiltonian_Monte_Carlo","YEAR":"2021"}},{"citationKey":"RMSD_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Root Mean Square Deviation","URL":"https://en.wikipedia.org/wiki/Root-mean-square_deviation","YEAR":"2021"}},{"citationKey":"CEASAR_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Ceasar Cipher","URL":"https://en.wikipedia.org/wiki/Caesar_cipher","YEAR":"2022"}},{"citationKey":"POST-QUANTUM_CRYPTO_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Post-quantum Cryptography","URL":"https://en.wikipedia.org/wiki/Post-quantum_cryptography","YEAR":"2022"}},{"citationKey":"KERCKHOFFS_PRINCIPLE_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Kerckhoffs's principle","URL":"https://en.wikipedia.org/wiki/Kerckhoffs%27s_principle","YEAR":"2022"}},{"citationKey":"ROT13_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: ROT13","URL":"https://en.wikipedia.org/wiki/ROT13","YEAR":"2022"}},{"citationKey":"CC_PERMUTATION","entryType":"MISC","entryTags":{"TITLE":"Crypto Corner: Permutation Cipher","URL":"https://crypto.interactive-maths.com/permutation-cipher.html","YEAR":"2022"}},{"citationKey":"XOR_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: XOR cipher","URL":"https://en.wikipedia.org/wiki/XOR_cipher","YEAR":"2022"}},{"citationKey":"DES_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Data Encryption Standard","URL":"https://en.wikipedia.org/wiki/Data_Encryption_Standard","YEAR":"2022"}},{"citationKey":"AES_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Advanced Encryption Standard","URL":"https://en.wikipedia.org/wiki/Advanced_Encryption_Standard","YEAR":"2022"}},{"citationKey":"BLOWFISH_CIPHER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Blowfish (cipher)","URL":"https://en.wikipedia.org/wiki/Blowfish_(cipher)","YEAR":"2022"}},{"citationKey":"RSA_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: RSA (cryptosystem)","URL":"https://en.wikipedia.org/wiki/RSA_(cryptosystem)","YEAR":"2022"}},{"citationKey":"ECC_CRYPTO_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Elliptic-curve cryptography","URL":"https://en.wikipedia.org/wiki/Elliptic-curve_cryptography","YEAR":"2022"}},{"citationKey":"BOX1958","entryType":"ARTICLE","entryTags":{"TITLE":"A note on the generation of random normal deviates","AUTHOR":"Box, George EP","JOURNAL":"Ann. Math. Statist.","VOLUME":"29","PAGES":"610--611","YEAR":"1958"}},{"citationKey":"MARSAGLIA_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Marsaglia Transform","URL":"https://en.wikipedia.org/wiki/Marsaglia_polar_method","YEAR":"2022"}},{"citationKey":"BOX_MULLER_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Box-Muller Transform","URL":"https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform","YEAR":"2022"}}],"gitbook":"*"},"file":{"path":"contents/gaussian_elimination/gaussian_elimination.md","mtime":"2023-03-30T13:44:48.152Z","type":"markdown"},"gitbook":{"version":"3.7.5","time":"2023-03-30T13:45:12.971Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

